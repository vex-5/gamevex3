var GlobalVars,LogMng,TextUtils,PhaserNineSlice,Config,GameData,GuiParams,MyMath,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}(),userID=null;!function(t){t.questExitMenu=""}(GlobalVars||(GlobalVars={})),function(t){!function(t){var e=function(e){function i(i,n,a,s,o,h,r){var l=e.call(this,i,n,a)||this;return l.btn=new t.SimpleButton(i,0,0,"game",h,r,o,o),l.btn.anchor.set(.5),l.addChild(l.btn),l.btnText=LangMng.getBmpText(l.game,LangMng.MENU_GAME,"btn_replay",0,-5),l.btnText.text="",l.btnText.anchor.set(.5),l.addChild(l.btnText),l}return __extends(i,e),i.prototype.setBtnText=function(t){null!=this.btnText&&this.removeChild(this.btnText),this.btnText=t,this.btnText.anchor.set(.5),this.btnText.x=0,this.btnText.y=this.btn.y-this.btn.height/2-this.btnText.height/2-5,this.addChild(this.btnText)},i.prototype.setText=function(t){this.btnText.text=t},i}(Phaser.Sprite);t.BtnWithText=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this;a.stars=[],a.glows=[];for(var s=0;s<3;s++){var o=new Phaser.Sprite(e,-124,0,"game","star_slot");switch(s){case 0:o.x=-124;break;case 1:o.x=0;break;case 2:o.x=124}o.anchor.set(.5),a.addChild(o);var h=new Phaser.Sprite(e,o.x,o.y,"game","star");h.anchor.set(.5),h.visible=!1,a.stars.push(h),a.addChild(h);var r=new Phaser.Sprite(e,o.x,o.y,"game","button_glow");r.anchor.set(.5),r.visible=!1,a.glows.push(r),a.addChild(r)}return a}return __extends(e,t),e.prototype.setStarsCount=function(t){for(var e=0;e<this.stars.length;e++)this.stars[e].visible=this.glows[e].visible=t>e},e}(Phaser.Sprite);t.BtnsPanel=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this,s=new PhaserNineSlice.NineSlice(a.game,0,0,"game","info_bg",160,125,{top:40,bottom:40,left:40,right:40});s.anchor.set(.5,0),a.addChild(s);var o=LangMng.getBmpText(a.game,LangMng.MENU_GAME,"level",0,25);return o.anchor.set(.5),TextUtils.sizingBitmapTextByH(o,50,!0,!0),TextUtils.sizingBitmapTextByH(o,30,!1,!0),a.addChild(o),a.tfMovesCnt=LangMng.getBmpText(a.game,LangMng.MENU_GAME,"level",0,85),a.tfMovesCnt.anchor.set(.5),TextUtils.sizingBitmapTextByH(a.tfMovesCnt,70,!0,!0),a.tfMovesCnt.text="",a.addChild(a.tfMovesCnt),a}return __extends(e,t),e.prototype.setLevelNum=function(t){this.tfMovesCnt.text=String(t)},e}(Phaser.Sprite);t.LevelFrame=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this,s=new PhaserNineSlice.NineSlice(a.game,0,0,"game","info_bg",160,220,{top:40,bottom:40,left:40,right:40});s.anchor.set(.5,0),a.addChild(s);var o=LangMng.getBmpText(a.game,LangMng.MENU_GAME,"move",0,35);return o.anchor.set(.5),a.addChild(o),a.tfMovesCnt=LangMng.getBmpText(a.game,LangMng.MENU_GAME,"move",0,100),a.tfMovesCnt.anchor.set(.5),TextUtils.sizingBitmapTextByH(a.tfMovesCnt,90,!0,!0),a.tfMovesCnt.text="",a.addChild(a.tfMovesCnt),a.textBest=LangMng.getText(LangMng.MENU_GAME,"target"),a.tfBest=LangMng.getBmpText(a.game,LangMng.MENU_GAME,"target",0,180),a.tfBest.anchor.set(.5),TextUtils.sizingBitmapTextByW(a.tfBest,140,!1,!0),a.addChild(a.tfBest),a}return __extends(e,t),e.prototype.setMovesCnt=function(t){this.tfMovesCnt.text=String(t)},e.prototype.setBestCnt=function(t){this.tfBest.text=this.textBest+": "+String(t),TextUtils.sizingBitmapTextByW(this.tfBest,140,!1,!0)},e.prototype.showBest=function(){this.tfBest.visible=!0},e.prototype.hideBest=function(){this.tfBest.visible=!1},e}(Phaser.Sprite);t.MoveFrame=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this,s=new Phaser.Sprite(a.game,0,0,"preloader","progressbar");s.anchor.set(.5),a.addChild(s),a.tfTitle=LangMng.getBmpText(a.game,LangMng.MENU_GAME,"dif_title",0,-4),a.tfTitle.anchor.set(.5),a.addChild(a.tfTitle);var o=new Phaser.Sprite(a.game,s.width/2,0,"game","side_holder");o.anchor.set(1,.5),a.addChild(o);var h=new Phaser.Sprite(a.game,-s.width/2,0,"game","side_holder");h.scale.x=-1,h.anchor.set(1,.5),a.addChild(h);var r=new Phaser.Sprite(a.game,0,s.height/2,"game","green_glow");return r.anchor.set(.5),a.addChild(r),a}return __extends(e,t),e.prototype.setTitleText=function(t){this.tfTitle.text=t,TextUtils.sizingBitmapTextByW(this.tfTitle,250,!0,!0),TextUtils.sizingBitmapTextByH(this.tfTitle,80,!1,!0)},e}(Phaser.Sprite);t.LevelDifTitle=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this;a.stars=[],a.glows=[];for(var s=0;s<3;s++){var o=new Phaser.Sprite(e,-124,0,"game","star_slot");switch(s){case 0:o.x=-124;break;case 1:o.x=0;break;case 2:o.x=124}o.anchor.set(.5),a.addChild(o);var h=new Phaser.Sprite(e,o.x,o.y,"game","star");h.anchor.set(.5),h.visible=!1,a.stars.push(h),a.addChild(h);var r=new Phaser.Sprite(e,o.x,o.y,"game","button_glow");r.anchor.set(.5),r.visible=!1,a.glows.push(r),a.addChild(r)}return a}return __extends(e,t),e.prototype.setStarsCount=function(t){for(var e=0;e<this.stars.length;e++)this.stars[e].visible=this.glows[e].visible=t>e},e}(Phaser.Sprite);t.StarsPanel=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n,a,s,o,h,r){var l=t.call(this,e,i,n,a,s,o,h,r)||this;return l.trueScale=1,l.enabled=!0,l.onDownSignal=new Phaser.Signal,l.events.onInputDown.add(l.onDown,l),l.events.onInputUp.add(l.onUp,l),l.events.onInputOver.add(l.onOver,l),l.events.onInputOut.add(l.onOut,l),l}return __extends(e,t),e.prototype.onDown=function(){this.getEnabled()&&this.scale.set(.94*this.trueScale)},e.prototype.onUp=function(){this.scale.set(this.trueScale)},e.prototype.onOver=function(){},e.prototype.onOut=function(){},e.prototype.setScale=function(t){this.trueScale=t,this.scale.set(this.trueScale)},e.prototype.getEnabled=function(){return this.enabled},e.prototype.setEnabled=function(t){this.enabled=t,this.enabled?(this.alpha=1,this.inputByEnabled&&(this.inputEnabled=!0)):(this.onOut(),this.alpha=.5,this.inputByEnabled&&(this.inputEnabled=!1))},e}(Phaser.Button);t.SimpleButton=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this;return a.showTime=5,a.showTimer=5,a.btnText=new Phaser.BitmapText(e,0,0,LangMng.FONT_ORANGE,"",50),a.addChild(a.btnText),a}return __extends(e,t),e.prototype.showText=function(t){this.showTimer=this.showTime,this.btnText.text=t,this.btnText.alpha=1},e.prototype.update=function(){var t=this.game.time.elapsed/1e3;this.showTimer-=t,this.showTimer<=0&&this.btnText.alpha>0&&(this.btnText.alpha=Math.max(0,this.btnText.alpha-t))},e}(Phaser.Sprite);t.DebugTextBlock=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){t.MODE_DEBUG="MODE_DEBUG",t.MODE_RELEASE="MODE_RELEASE";var e="DEBUG",i="INFO",n="NETWORK",a="WARNING",s="ERROR",o=t.MODE_DEBUG,h=[e,i,n,a,s];function r(t,o){if(void 0===o&&(o=e),!(h.indexOf(o)<0)){switch(o){case i:"background: #308AE4; color: #fff; padding: 1px 4px";break;case a:"background: #f7a148; color: #fff; padding: 1px 4px";break;case s:"background: #DB5252; color: #fff; padding: 1px 4px";break;case n:"background: #7D2998; color: #fff; padding: 1px 4px";break;default:"background: #ADADAD; color: #fff; padding: 1px 4px"}}}t.setMode=function(o){switch(o){case t.MODE_DEBUG:h=[e,i,n,a,s];break;case t.MODE_RELEASE:h=[a,s]}},t.getMode=function(){return o},t.system=function(t,e){void 0===e&&(e="")},t.debug=function(t){r(0,e)},t.info=function(t){r(0,i)},t.net=function(t){r(0,n)},t.warn=function(t){r(0,a)},t.error=function(t){r(0,s)}}(LogMng||(LogMng={})),function(t){t.sizingBitmapTextByW=function(t,e,i,n){if(i&&t.width<e)for(;t.width<e;)t.fontSize++;if(n&&t.width>e)for(;t.width>e;)t.fontSize--},t.sizingBitmapTextByH=function(t,e,i,n){if(i&&t.height<e)for(;t.height<e;)t.fontSize++;if(n&&t.height>e)for(;t.height>e;)t.fontSize--}}(TextUtils||(TextUtils={})),function(t){var e=function(t){function e(e,i,n,a,s,o,h,r){var l=t.call(this,e,i,n,a,s)||this;return l.baseTexture=l.texture.baseTexture,l.baseFrame=l.texture.frame,null===s||r?r||(r=e.cache.getNineSlice(a)):r=e.cache.getNineSlice(s),void 0===r||(l.topSize=r.top,r.left?l.leftSize=r.left:l.leftSize=l.topSize,r.right?l.rightSize=r.right:l.rightSize=l.leftSize,r.bottom?l.bottomSize=r.bottom:l.bottomSize=l.topSize,l.loadTexture(new Phaser.RenderTexture(l.game,l.localWidth,l.localHeight)),l.resize(o,h)),l}return __extends(e,t),e.prototype.renderTexture=function(){this.texture.resize(this.localWidth,this.localHeight,!0);for(var t=[0,this.leftSize,this.baseFrame.width-this.rightSize,this.baseFrame.width],e=[0,this.topSize,this.baseFrame.height-this.bottomSize,this.baseFrame.height],i=[0,this.leftSize,this.localWidth-this.rightSize,this.localWidth],n=[0,this.topSize,this.localHeight-this.bottomSize,this.localHeight],a=0;a<3;a++)for(var s=0;s<3;s++){var o=this.createTexturePart(t[s],e[a],t[s+1]-t[s],e[a+1]-e[a]);o.width=i[s+1]-i[s],o.height=n[a+1]-n[a],this.texture.renderXY(o,i[s],n[a])}},e.prototype.resize=function(t,e){this.localWidth=t,this.localHeight=e,this.renderTexture()},e.prototype.createTexturePart=function(t,e,i,n){var a=new PIXI.Rectangle(this.baseFrame.x+this.texture.frame.x+t,this.baseFrame.y+this.texture.frame.y+e,Math.max(i,1),Math.max(n,1));return new Phaser.Sprite(this.game,0,0,new PIXI.Texture(this.baseTexture,a))},e}(Phaser.Sprite);t.NineSlice=e}(PhaserNineSlice||(PhaserNineSlice={})),function(t){var e=function(e){function i(t,i){var n=e.call(this,t,i)||this;return n.addNineSliceCache(),n.addNineSliceFactory(),n.addNineSliceLoader(),n}return __extends(i,e),i.prototype.addNineSliceLoader=function(){Phaser.Loader.prototype.nineSlice=function(t,e,i,n,a,s){var o={top:i};n&&(o.left=n),a&&(o.right=a),s&&(o.bottom=s),this.addToFileList("image",t,e),this.game.cache.addNineSlice(t,o)}},i.prototype.addNineSliceFactory=function(){Phaser.GameObjectFactory.prototype.nineSlice=function(e,i,n,a,s,o,h){void 0===h&&(h=this.world);var r=new t.NineSlice(this.game,e,i,n,a,s,o);return h.add(r)},Phaser.GameObjectCreator.prototype.nineSlice=function(e,i,n,a,s,o){return new t.NineSlice(this.game,e,i,n,a,s,o)}},i.prototype.addNineSliceCache=function(){Phaser.Cache.prototype.nineSlice={},Phaser.Cache.prototype.addNineSlice=function(t,e){this.nineSlice[t]=e},Phaser.Cache.prototype.getNineSlice=function(t){var e=this.nineSlice[t];return e}},i}(Phaser.Plugin);t.Plugin=e}(PhaserNineSlice||(PhaserNineSlice={})),function(t){t.GW=800,t.GH=1280,t.GWS=800,t.GHS=1280}(Config||(Config={})),function(t){var e={snd_enabled:!0,present_cnt:0,keys_cnt:2,hints_cnt:2,money_cnt:1500,KEY_FREE_PRESENT_DATA:"",prevData:{d:0,m:0},difLocked:{}},i="az_sg_ftb";t.Q_MASTER=0,t.Q_FIND_ANS=1,t.Q_ROCK_STAR=2,t.Q_SUPER_ROLLER=3,t.Q_SHOPAHOLIC=4,t.Q_CLEAR_N_IN_T=5,t.Q_CLEAR_DAILY=6,t.Q_PARAMS=[{name:"Master",desc:"Complete MIS1 level package",addtype:0,addvalue:2,max:1,max2:1,reward:-1}],t.QUESTS=[{mission:1,current:0},{mission:1,current:0},{mission:3,current:0},{mission:1e3,current:0},{mission:1,current:0},{mission:5,mission2:3,current:0},{mission:1,current:0}],t.currentDif=0,t.currentLevel=0,t.starsCount=0;var n=[];function a(){var t=!0;try{SGHooksMng.setStorageItem(i,JSON.stringify(e))}catch(e){t=!1,LogMng.error("SGHooksMng.setStorageItem(): "+e)}if(!t)try{localStorage.setItem(i,JSON.stringify(e))}catch(t){LogMng.error("localStorage.setItem(): "+t)}}function s(){e.levelsData=n,a()}function o(){t.starsCount=0;for(var e=0;e<Setting.TOTAL_LEVELS_CNT;e++)t.starsCount+=n[e].stars}function h(t){e.present_cnt+=t,e.present_cnt<0&&(e.present_cnt=0),a()}function r(){e.quests=t.QUESTS,a()}function l(e,i){t.QUESTS[e].current+=i,r()}t.isGamePaused=!1,t.setGamePaused=function(){t.isGamePaused=!0},t.setGameUnpaused=function(){t.isGamePaused=!1},t.orientationChanged=function(){ScaleManager.sizeCalculation()},t.resized=function(){ScaleManager.sizeCalculation()},t.init=function(){var r,l;!function(){var t=!0,n=null;try{null!=(n=SGHooksMng.getStorageItem(i))&&(e=JSON.parse(String(n)))}catch(e){t=!1,LogMng.error("SGHooksMng.getStorageItem(): "+e)}if(!t)try{null!=(n=localStorage.getItem(i))&&(e=JSON.parse(String(n)))}catch(t){LogMng.error("localStorage.getItem(): "+t)}}(),function(){if(null==(n=e.levelsData)||n==[]){n=[];for(var t=0;t<Setting.TOTAL_LEVELS_CNT;t++)n.push({stars:0,bt:0});s()}}(),o(),function(){var i=null;try{i=e.quests}catch(t){LogMng.error("loadQuests: "+t)}Setting.QUESTS_TEST&&(i=null);null!=i&&(t.QUESTS=i)}(),r=new Date,l={d:r.getUTCDate(),m:r.getUTCMonth()},e.prevData.d==l.d&&e.prevData.m==l.m||(h(1),e.prevData.d=l.d,e.prevData.m=l.m,a())},t.getSoundEnabled=function(){return e.snd_enabled},t.setSoundEnabled=function(t){e.snd_enabled=t,a()},t.getLevelStarsCount=function(t,e){return n[50*t+e].stars},t.setLevelStarsCount=function(t,e,i){n[50*t+e].stars=i,s(),o()},t.getDifStarsCount=function(t){for(var e=0,i=50*t;i<50*t+50;i++)e+=n[i].stars;return e},t.getBestTurnsCount=function(t,e){return n[50*t+e].bt},t.setLevelBestTurnsCount=function(t,e,i){n[50*t+e].bt=i,s()},t.getPresentCnt=function(){return e.present_cnt},t.changePresentCnt=h,t.getKeysCnt=function(){return e.keys_cnt},t.changeKeysCnt=function(t){e.keys_cnt+=t,e.keys_cnt<0&&(e.keys_cnt=0),a()},t.getMoney=function(){return e.money_cnt},t.changeMoney=function(i){e.money_cnt+=i,e.money_cnt>5e7&&(e.money_cnt=5e7),e.money_cnt<0&&(e.money_cnt=0),a(),i>0&&l(t.Q_SUPER_ROLLER,i)},t.getHints=function(){return e.hints_cnt},t.changeHintsCnt=function(t){e.hints_cnt+=t,e.hints_cnt<0&&(e.hints_cnt=0),a()},t.getCompleteLevelCntInDif=function(t){for(var e=0,i=0;i<Setting.LEVELS_IN_DIF_CNT;i++)n[50*t+i].stars>0&&e++;return e},t.getStarsCntInDif=function(t){for(var e=0,i=0;i<Setting.LEVELS_IN_DIF_CNT;i++)n[50*t+i].stars>0&&(e+=n[50*t+i].stars);return e},t.isDifLocked=function(t){var i="isDifLocked"+String(t),n=e.difLocked[i];return null!=n?Boolean(n):t>0},t.setDifLocked=function(t,i){var n="isDifLocked"+String(t);e.difLocked[n]=i,a()},t.getLastLevelId=function(){for(var t=-1,e=0;e<Setting.TOTAL_LEVELS_CNT;e++)if(n[e].stars<=0){t=e;break}return t},t.saveQuests=r,t.addQuestValue=l,t.setQuestValue=function(e,i){t.QUESTS[e].current=i,r()},t.getQuest=function(e){if(t.QUESTS[e].current<t.QUESTS[e].mission)return!1;switch(t.QUESTS[e].current-=t.QUESTS[e].mission,t.QUESTS[e].current<0&&(t.QUESTS[e].current=0),t.Q_PARAMS[e].addtype){case 0:t.QUESTS[e].mission+=t.Q_PARAMS[e].addval;break;case 1:t.QUESTS[e].mission*=t.Q_PARAMS[e].addval}if(t.QUESTS[e].mission>t.Q_PARAMS[e].max&&(t.QUESTS[e].mission=t.Q_PARAMS[e].max),null!=t.QUESTS[e].mission2&&null!=t.Q_PARAMS[e].addtype2&&null!=t.Q_PARAMS[e].addval2){switch(t.Q_PARAMS[e].addtype2){case 0:t.QUESTS[e].mission2+=t.Q_PARAMS[e].addval2;break;case 1:t.QUESTS[e].mission2*=t.Q_PARAMS[e].addval2}t.QUESTS[e].mission2>t.Q_PARAMS[e].max2&&(t.QUESTS[e].mission2=t.Q_PARAMS[e].max2)}return r(),!0},t.getCompleteQuestsCount=function(){for(var e=0,i=0;i<t.QUESTS.length;i++)t.QUESTS[i].current>=t.QUESTS[i].mission&&e++;return e},t.getDailyInfo=function(){var t,i=null;try{i=e.d_info}catch(t){LogMng.error("local storage: "+t)}return null!=i&&(t=i),t},t.setDailyInfo=function(t){try{e.d_info=t}catch(t){LogMng.error("local storage: "+t)}a()},t.getLevelTargetTurns=function(t,e){return Setting.LEVELS[Setting.getLevelAbsId(t,e)].moves.length}}(GameData||(GameData={})),function(t){t.PRELOADER=0,t.MAINMENU=1,t.E_LOGO="E_LOGO",t.E_BTN_PLAY="E_BTN_PLAY",t.E_BTN_QUESTS="E_BTN_QUESTS",t.E_BTN_PRESENT="E_BTN_PRESENT",t.E_BTN_SND="E_BTN_SND";var e=[[],[{name:t.E_LOGO,x:370,y:280},{name:t.E_BTN_PLAY,x:360,y:550},{name:t.E_BTN_QUESTS,x:360,y:750},{name:t.E_BTN_PRESENT,x:360,y:860},{name:t.E_BTN_SND,x:650,y:160}]],i=[[],[{name:t.E_LOGO,x:490,y:194},{name:t.E_BTN_PLAY,x:480,y:424},{name:t.E_BTN_QUESTS,x:480,y:556},{name:t.E_BTN_PRESENT,x:480,y:660},{name:t.E_BTN_SND,x:820,y:70}]];t.getGuiParams=function(t,n,a){for(var s,o=t?e[n]:i[n],h=0;h<o.length;h++)if(o[h].name==a){s=o[h];break}return s}}(GuiParams||(GuiParams={})),function(t){!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.btns=[],t.targetYPos=0,t.scrollStartYPos=0,t.down_x=0,t.down_y=0,t}return __extends(i,e),i.prototype.create=function(){this.dummyMain=new Phaser.Sprite(this.game,0,0),this.add.existing(this.dummyMain),this.dummyBtns=new Phaser.Sprite(this.game,0,0),this.dummyBtns.inputEnabled=!0,this.dummyBtns.input.draggable=!0,this.dummyBtns.input.allowHorizontalDrag=!1,this.dummyBtns.input.allowVerticalDrag=!0,this.dummyMain.addChild(this.dummyBtns),this.btnsMask=new Phaser.Graphics(this.game,-Config.GW/2,0),this.dummyMain.addChild(this.btnsMask),this.dummyBtns.mask=this.btnsMask;for(var e=0,i=0;i<50;i++){var n=new t.LevelBtn(this.game,i%4*148,150*Math.floor(i/4),i,!1);this.dummyBtns.addChild(n),GameData.getLevelStarsCount(GameData.currentDif,i)>0&&e++,this.btns.push(n)}this.scrollOwner=new Phaser.Graphics(this.game,-Config.GW/2,0),this.scrollOwner.inputEnabled=!0,this.scrollOwner.input.allowHorizontalDrag=!1,this.scrollOwner.input.allowVerticalDrag=!0,this.scrollOwner.input.enableDrag(!1),this.scrollOwner.events.onDragStart.add(this.onListDragStart,this),this.scrollOwner.events.onDragUpdate.add(this.onListDragUpd,this),this.scrollOwner.events.onDragStop.add(this.onListDragStop,this),this.scrollOwner.events.onInputDown.add(this.onListInputDown,this),this.scrollOwner.events.onInputUp.add(this.onListInputUp,this),this.updateScrollOwner(),this.dummyMain.addChild(this.scrollOwner),this.topPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","top_bar",800,300,{top:0,bottom:15,left:0,right:0}),this.dummyMain.addChild(this.topPanel),this.topPanel.anchor.set(.5,0);var a=new Phaser.Sprite(this.game,0,this.topPanel.height/2+40,"game","banner");a.anchor.set(.5),this.topPanel.addChild(a);var s=new Phaser.BitmapText(this.game,0,-20,LangMng.getFont(LangMng.MENU_LEVELS,"title"),LangMng.getText(LangMng.MENU_SECTIONS,"sec_title_"+String(GameData.currentDif+1)),LangMng.getTextSize(LangMng.MENU_LEVELS,"title"));s.anchor.set(.5),TextUtils.sizingBitmapTextByW(s,500,!1,!0),a.addChild(s),this.botPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","down_bar",800,180,{top:5,bottom:2,left:0,right:0}),this.dummyMain.addChild(this.botPanel),this.botPanel.anchor.set(.5,0),this.btnBack=new Phaser.Button(this.game,-this.botPanel.width/2+90,this.botPanel.height/2+4,"game",this.onBackClick,this,"back_btn","back_btn"),this.btnBack.anchor.set(.5),this.botPanel.addChild(this.btnBack),this.targetYPos=-180*Math.floor(e/4)+540,this.scrollOwner.y=this.targetYPos,ScaleManager.onOrientationChangeSignal.add(this.onOrientationChange,this),this.onOrientationChange()},i.prototype.onListDragStart=function(t,e){this.down_x=e.x,this.down_y=e.y,this.isScrolling=!1,this.scrollStartYPos=this.dummyBtns.y},i.prototype.onListDragUpd=function(){Math.abs(this.scrollStartYPos-this.dummyBtns.y)>10&&(this.isScrolling=!0)},i.prototype.onListDragStop=function(){this.checkScrollBorder()},i.prototype.onListInputDown=function(t,e){this.scrollDownPointer=e},i.prototype.onListInputUp=function(t,e){if(!this.isScrolling){var i=this.getLevelBtnByPos(this.down_x,this.down_y);null!=i&&this.onLevelClick(i)}this.isScrolling=!1},i.prototype.getLevelBtnByPos=function(t,e){for(var i=0;i<this.dummyBtns.children.length;i++){var n=this.dummyBtns.getChildAt(i);if(null!=n){var a=n.toGlobal(new PIXI.Point(0,0)),s=new PIXI.Point(t,e),o=a.x+n.btn_w*this.dummyMain.scale.x,h=a.y+n.btn_h*this.dummyMain.scale.y;if(s.x>a.x&&s.x<o&&s.y>a.y&&s.y<h)return n}}return null},i.prototype.updateScrollOwner=function(){for(var e=0,i=0;i<this.dummyBtns.children.length;i++)if(this.dummyBtns.getChildAt(i)instanceof t.LevelBtn){var n=this.dummyBtns.getChildAt(i);n.y+n.btn_h>e&&(e=n.y+n.btn_h)}this.scrollOwner.clear(),this.scrollOwner.beginFill(0,0),this.scrollOwner.drawRect(0,0,1300,e),this.scrollOwner.endFill()},i.prototype.checkScrollBorder=function(){LogMng.debug("this.scrollOwner.y = "+this.scrollOwner.y),this.scrollOwner.y>0&&(this.scrollOwner.y=0);var t=-this.scrollOwner.height+Config.GH-this.botPanel.height-10;LogMng.debug("min_y = "+t),this.scrollOwner.y<t&&(this.scrollOwner.y=t)},i.prototype.onOrientationChange=function(){try{this.dummyMain.position.set(this.game.world.width/2,0),ScaleManager.isPortrait?this.dummyMain.scale.set(1):this.dummyMain.scale.set(Config.GW/Config.GH),this.topPanel.position.set(0,0),this.botPanel.position.set(0,Config.GH-this.botPanel.height);ScaleManager.isPortrait;-350;ScaleManager.isPortrait;180;var t=this.topPanel.height+5;ScaleManager.isPortrait;if(180,null!=this.dummyBtns)for(var e=0;e<50&&!(e>=this.dummyBtns.children.length);e++){var i=this.dummyBtns.getChildAt(e);null!=i&&(i.x=e%4*180-350,i.y=t+180*Math.floor(e/4))}this.drawBtnsMask(),this.updateScrollOwner(),this.checkScrollBorder()}catch(t){}},i.prototype.drawBtnsMask=function(){this.btnsMask.clear(),this.btnsMask.beginFill(0,0),this.btnsMask.drawRect(0,this.topPanel.height,Math.max(Config.GW,Config.GH),this.botPanel.y),this.btnsMask.endFill()},i.prototype.onBackClick=function(){SG_Hooks.triggerMidrollAd((()=>{this.game.state.start("DifSelect",!0,!1)}))},i.prototype.onLevelClick=function(t){!this.isScrolling&&t.isAvailable&&(GameData.currentLevel=t.id,this.game.state.start("GameProc",!0,!1))},i.prototype.update=function(){this.game.time.elapsed;this.dummyBtns.y+=(this.scrollOwner.y-this.dummyBtns.y)/10},i}(Phaser.State);t.LevelSelect=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.list_w=0,t}return __extends(i,e),i.prototype.create=function(){this.dummyMain=new Phaser.Sprite(this.game,0,0),this.add.existing(this.dummyMain),this.listBtn=new t.DifList(this.game,0,0),this.listBtn.onDifClickSignal.add(this.onListClick,this),this.dummyMain.addChild(this.listBtn);var e=0;this.difBtns=[];for(var i=0;i<Setting.TOTAL_LEVELS_CNT/Setting.LEVELS_IN_DIF_CNT;i++){var n=new t.DifBtn(this.game,0,120*i,i);this.listBtn.addItem(n),this.difBtns.push(n),e=n.y+n.height}this.list_w=n.btn_w+6,this.listBtn.setContentSize(this.list_w,e),this.topPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","top_bar",800,300,{top:0,bottom:15,left:0,right:0}),this.topPanel.inputEnabled=!0,this.dummyMain.addChild(this.topPanel),this.topPanel.anchor.set(.5,0),this.stars=new t.StarsCounter(this.game,-this.topPanel.width/2+150,80),this.stars.anchor.set(.5,0),this.topPanel.addChild(this.stars),this.btnQuests=new t.SimpleButton(this.game,this.topPanel.width/2-this.topPanel.height/2,this.topPanel.height/2,"game",this.onQuestsClick,this,"icon_achieve","icon_achieve"),this.btnQuests.anchor.set(.5),this.topPanel.addChild(this.btnQuests),this.qInfoFon=new Phaser.Sprite(this.game,60,-60,"game","icon_new"),this.qInfoFon.anchor.set(.5),this.qInfoFon.visible=GameData.getCompleteQuestsCount()>0,this.btnQuests.addChild(this.qInfoFon),this.tfDebug=new t.DebugTextBlock(this.game,0,0),this.botPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","down_bar",800,180,{top:5,bottom:2,left:0,right:0}),this.botPanel.inputEnabled=!0,this.dummyMain.addChild(this.botPanel),this.botPanel.anchor.set(.5,0),this.btnBack=new t.SimpleButton(this.game,-this.botPanel.width/2+90,this.botPanel.height/2+4,"game",this.onBackClick,this,"back_btn","back_btn"),this.btnBack.anchor.set(.5),this.botPanel.addChild(this.btnBack),this.tfKeysCount=new Phaser.BitmapText(this.game,this.botPanel.width/2-50,this.botPanel.height/2,LangMng.FONT_WHITE,"0",90),this.tfKeysCount.anchor.set(1,.5),this.botPanel.addChild(this.tfKeysCount),this.sprKeyIcon=new Phaser.Sprite(this.game,this.tfKeysCount.x-this.tfKeysCount.width-20,this.tfKeysCount.y,"game","icon_key"),this.sprKeyIcon.anchor.set(1,.5),this.sprKeyIcon.scale.set(.8),this.botPanel.addChild(this.sprKeyIcon),ScaleManager.onOrientationChangeSignal.add(this.onOrientationChange,this),this.onOrientationChange()},i.prototype.doImgDebug=function(t){},i.prototype.drawBtnsMask=function(){this.listBtn.setListSize(this.list_w,this.botPanel.y-this.topPanel.height-this.topPanel.y)},i.prototype.getDifBtnByPos=function(t,e){for(var i=0;i<this.difBtns.length;i++){var n=this.difBtns[i];if(null!=n){var a=n.toGlobal(new PIXI.Point(0,0)),s=new PIXI.Point(t,e),o=a.x+n.btn_w*this.dummyMain.scale.x,h=a.y+n.btn_h*this.dummyMain.scale.y;if(s.x>a.x&&s.x<o&&s.y>a.y&&s.y<h)return n}}return null},i.prototype.onListDragStart=function(){LogMng.debug("onListDragStart")},i.prototype.onListDragUpd=function(){},i.prototype.onListInputUp=function(t,e){LogMng.debug("onListInputUp")},i.prototype.onOrientationChange=function(){try{this.dummyMain.position.set(this.game.world.width/2,0),ScaleManager.isPortrait?this.dummyMain.scale.set(1):this.dummyMain.scale.set(Config.GW/Config.GH),this.topPanel.position.set(0,0),this.botPanel.position.set(0,Config.GH-this.botPanel.height);for(var t=0,e=0;e<this.difBtns.length;e++)this.difBtns[e].y=130*e,t=this.difBtns[e].y+this.difBtns[e].btn_h;this.listBtn.setContentSize(this.list_w,t),this.listBtn.position.set(-this.list_w/2,this.topPanel.y+this.topPanel.height),this.drawBtnsMask()}catch(t){LogMng.error("ERROR in DifSelect.onOrientationChange(): "+t)}},i.prototype.onQuestsClick=function(){GlobalVars.questExitMenu="DifSelect",this.game.state.start("Quests",!0,!1)},i.prototype.onBackClick=function(){SG_Hooks.triggerMidrollAd((()=>{this.game.state.start("MainMenu",!0,!1)}))},i.prototype.onDifClick=function(t){if(this.listBtn.isScrolled)this.listBtn.isScrolled=!1;else{if(GameData.isDifLocked(t.id))return GameData.getKeysCnt()<=0||t.id>0&&GameData.isDifLocked(t.id-1)?void t.lockTurn():(t.unlock(),GameData.changeKeysCnt(-1),void GameData.setDifLocked(t.id,!1));GameData.currentDif=t.id,this.game.state.start("LevelSelect",!0,!1)}},i.prototype.onListClick=function(){var t=this.getDifBtnByPos(this.listBtn.down_x,this.listBtn.down_y);null!=t&&this.onDifClick(t)},i.prototype.update=function(){null!=this.stars&&this.stars.update(),this.tfKeysCount.text!=String(GameData.getKeysCnt())&&(this.tfKeysCount.text=String(GameData.getKeysCnt())),this.listBtn.update(),this.tfDebug.update()},i}(Phaser.State);t.DifSelect=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.dailyCheckTimer=10,t.scrollStartYPos=0,t.down_x=0,t.down_y=0,t}return __extends(i,e),i.prototype.create=function(){this.dummyMain=new Phaser.Sprite(this.game,0,0),this.add.existing(this.dummyMain),GameData.getLevelStarsCount(GameData.QUESTS[GameData.Q_MASTER].mission-1,49)&&GameData.addQuestValue(GameData.Q_MASTER,GameData.QUESTS[GameData.Q_MASTER].mission),this.dummyItems=new Phaser.Sprite(this.game,0,0),this.dummyMain.addChild(this.dummyItems),this.items=[];for(var e=0;e<GameData.QUESTS.length;e++)if(!(e>=7)){var i=new t.QuestItem(this.game,50,170+130*e,e);i.onGetClickSignal.add(this.onGetClick,this),this.dummyItems.addChild(i),this.items.push(i)}this.btnsMask=new Phaser.Graphics(this.game,0,0),this.dummyMain.addChild(this.btnsMask),this.dummyItems.mask=this.btnsMask,this.scrollOwner=new Phaser.Graphics(this.game,0,0),this.scrollOwner.beginFill(0,0),this.scrollOwner.endFill(),this.scrollOwner.inputEnabled=!0,this.scrollOwner.input.allowHorizontalDrag=!1,this.scrollOwner.input.allowVerticalDrag=!0,this.scrollOwner.input.enableDrag(!1),this.scrollOwner.events.onDragStart.add(this.onListDragStart,this),this.scrollOwner.events.onDragUpdate.add(this.onListDragUpd,this),this.scrollOwner.events.onDragStop.add(this.onListDragStop,this),this.scrollOwner.events.onInputDown.add(this.onListInputDown,this),this.scrollOwner.events.onInputUp.add(this.onListInputUp,this),this.dummyMain.addChild(this.scrollOwner),this.topPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","top_bar",800,300,{top:0,bottom:15,left:0,right:0}),this.topPanel.inputEnabled=!0,this.topPanel.anchor.set(.5,0),this.dummyMain.addChild(this.topPanel);var n=new Phaser.Sprite(this.game,-this.topPanel.width/2-6,this.topPanel.height/2,"game","tag");n.anchor.set(0,.5),this.topPanel.addChild(n);var a=LangMng.getBmpText(this.game,LangMng.MENU_QUESTS,"title",10,-10);a.anchor.set(0,.5),TextUtils.sizingBitmapTextByW(a,270,!1,!0),TextUtils.sizingBitmapTextByH(a,130,!1,!0),n.addChild(a);var s=new Phaser.Sprite(this.game,this.topPanel.width/2-this.topPanel.height/2,this.topPanel.height/2,"game","icon_achieve");s.anchor.set(.5),this.topPanel.addChild(s),this.botPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","down_bar",800,180,{top:5,bottom:2,left:0,right:0}),this.botPanel.inputEnabled=!0,this.botPanel.anchor.set(.5,0),this.dummyMain.addChild(this.botPanel),this.btnBack=new t.SimpleButton(this.game,-this.botPanel.width/2+90,this.botPanel.height/2+4,"game",this.onBackClick,this,"back_btn","back_btn"),this.btnBack.anchor.set(.5),this.botPanel.addChild(this.btnBack);var o=GameData.getDailyInfo();null!=o&&(o.qid<this.items.length?this.items[o.qid].setDaily(!0):this.restartDailyQuest()),this.checkDaily(),this.back=new Phaser.Graphics(this.game),this.back.beginFill(0,.2),this.back.drawRect(0,0,Config.GH,Config.GH),this.back.endFill(),this.back.inputEnabled=!0,this.back.visible=!1,this.add.existing(this.back),this.input.onDown.add(this.onInputDown,this),this.input.onUp.add(this.onInputUp,this),ScaleManager.onOrientationChangeSignal.add(this.onOrientationChange,this),this.onOrientationChange()},i.prototype.onListDragStart=function(t,e){this.down_x=e.x,this.down_y=e.y,this.isScrolling=!1,this.scrollStartYPos=this.scrollOwner.y},i.prototype.onListDragUpd=function(){Math.abs(this.scrollStartYPos-this.scrollOwner.y)>10&&(this.isScrolling=!0)},i.prototype.onListDragStop=function(){this.checkScrollBorder()},i.prototype.onListInputDown=function(t,e){LogMng.debug("onListInputDown"),this.scrollDownPointer=e},i.prototype.onListInputUp=function(t,e){if(!this.isScrolling){var i=this.getDifBtnByPos(this.down_x,this.down_y);null!=i&&i.onGetClick()}this.isScrolling=!1},i.prototype.getDifBtnByPos=function(t,e){for(var i=0;i<this.dummyItems.children.length;i++){var n=this.dummyItems.getChildAt(i);if(null!=n){var a=n.toGlobal(new PIXI.Point(0,0)),s=new PIXI.Point(t,e),o=a.x+n.btn_w*this.dummyMain.scale.x,h=a.y+n.btn_h*this.dummyMain.scale.y;if(s.x>a.x&&s.x<o&&s.y>a.y&&s.y<h)return n}}return null},i.prototype.checkScrollBorder=function(){this.scrollOwner.y>0&&(this.scrollOwner.y=0);var t=-this.scrollOwner.height+this.world.height-this.botPanel.height-10;this.scrollOwner.y<t&&(this.scrollOwner.y=t)},i.prototype.onRewWndClose=function(){this.rewWnd.visible=!1,this.rewWnd.kill(),this.rewWnd=null,this.back.visible=!1},i.prototype.onInputDown=function(t){this.prevPoint=t.position.clone(),this.isDowned=!0},i.prototype.onInputUp=function(){this.isDowned=!1},i.prototype.checkDaily=function(){var t=new Date,e=GameData.getDailyInfo();null!=e?Setting.DAILY_5MIN_TEST?(e.date!=t.getUTCDate()||e.h!=t.getUTCHours()||e.m<t.getUTCMinutes()-5)&&this.restartDailyQuest():e.date==t.getUTCDate()&&e.m==t.getUTCMonth()||this.restartDailyQuest():this.findNewDaily()},i.prototype.restartDailyQuest=function(){var t=GameData.getDailyInfo();GameData.QUESTS[t.qid].current=t.val,GameData.saveQuests(),this.items[t.qid].setDaily(!1),this.findNewDaily()},i.prototype.findNewDaily=function(){if(!(this.items.length<=0)){for(var t=MyMath.randomIntInRange(0,this.items.length-1);t==GameData.Q_CLEAR_DAILY;)t=MyMath.randomIntInRange(0,this.items.length-1);var e,i=new Date;e=Setting.DAILY_5MIN_TEST?{date:i.getUTCDate(),m:i.getUTCMinutes(),h:i.getUTCHours(),qid:t,val:GameData.QUESTS[t].current}:{date:i.getUTCDate(),m:i.getUTCMonth(),qid:t,val:GameData.QUESTS[t].current},GameData.setDailyInfo(e);try{this.items[t].setDaily(!0)}catch(e){LogMng.error("setDaily, quest id = "+t)}}},i.prototype.onOrientationChange=function(){try{this.dummyMain.position.set(this.game.world.width/2,0),ScaleManager.isPortrait?this.dummyMain.scale.set(1):this.dummyMain.scale.set(Config.GW/Config.GH),this.topPanel.position.set(0,0),this.botPanel.position.set(0,Config.GH-this.botPanel.height);for(var t=0,e=0;e<this.items.length;e++)this.items[e].x=0-this.items[e].btn_w/2,this.items[e].y=this.topPanel.height+10+130*e,t=this.items[e].y+this.items[e].btn_h;t*=this.dummyMain.scale.x,this.scrollOwner.clear(),this.scrollOwner.beginFill(0,0),this.scrollOwner.drawRect(-Config.GW/2,this.topPanel.height,1300,t),this.scrollOwner.endFill(),this.drawBtnsMask(),this.checkScrollBorder(),null!=this.rewWnd&&this.rewWnd.position.set(this.world.centerX,this.world.centerY)}catch(t){LogMng.error("in Quests.onOrientationChange(): "+t)}},i.prototype.drawBtnsMask=function(){LogMng.debug("drawBtnsMask()..."),this.btnsMask.clear(),this.btnsMask.beginFill(0,0),this.btnsMask.drawRect(-Config.GW/2,this.topPanel.height,Config.GW,this.botPanel.y-this.topPanel.height),this.btnsMask.endFill(),this.dummyItems.mask=this.btnsMask},i.prototype.onGetClick=function(e){e.isDaily&&(GameData.addQuestValue(GameData.Q_CLEAR_DAILY,1),e.setDaily(!1));var i=GameData.Q_PARAMS[e.id].rewt,n=GameData.Q_PARAMS[e.id].rewval,a=t.Rulet.getRandomReward();0==a.type&&(a.val=Math.random()<.5?30:50),i>=0&&(a.type=i,a.val=n),null==this.rewWnd&&(this.rewWnd=new t.OutstandWindow(this.game,this.world.centerX,this.world.centerY),this.rewWnd.onCloseClick.add(this.onRewWndClose,this),this.rewWnd.visible=!1,this.add.existing(this.rewWnd),this.rewWnd.setReward(a.type,a.val),GuiUtils.showPopupWindow(this.game,this.rewWnd,new Phaser.Point(this.world.centerX,-500),new Phaser.Point(this.world.centerX,this.world.centerY))),this.refreshItems()},i.prototype.onBackClick=function(){SG_Hooks.triggerMidrollAd((()=>{this.game.state.start(GlobalVars.questExitMenu,!0,!1)}))},i.prototype.refreshItems=function(){for(var t=0;t<this.items.length;t++)this.items[t].refreshGetBtn()},i.prototype.update=function(){var t=.001*this.game.time.elapsedMS;if(this.dailyCheckTimer-=t,this.dailyCheckTimer<=0){this.checkDaily();for(var e=0;e<this.items.length;e++){this.items[e].refreshGetBtn()}this.dailyCheckTimer=2}if(this.dummyItems.y+=(this.scrollOwner.y-this.dummyItems.y)/10,null!=this.rewWnd&&(this.back.visible=this.rewWnd.visible),this.isDowned){this.input.position.y,this.prevPoint.y;this.prevPoint=this.input.position.clone()}},i}(Phaser.State);t.Quests=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e="stopped",i="roll",n="stopping",a=[{type:1,val:2},{type:0,val:100},{type:1,val:1},{type:0,val:50},{type:0,val:25},{type:0,val:1e3},{type:1,val:1},{type:0,val:50},{type:0,val:50},{type:1,val:1},{type:0,val:50},{type:0,val:100}],s=function(s){function o(){var t=null!==s&&s.apply(this,arguments)||this;return t.state=e,t.curSpd=0,t.rollTimer=0,t.stopAcc=-500,t.point=new Phaser.Point(300,300),t}return __extends(o,s),o.prototype.create=function(){this.dummyMain=new Phaser.Sprite(this.game,0,0),this.add.existing(this.dummyMain),this.topPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","top_bar",800,300,{top:0,bottom:15,left:0,right:0}),this.topPanel.anchor.set(.5,0),this.dummyMain.addChild(this.topPanel);var e=new Phaser.Sprite(this.game,-this.topPanel.width/2-6,this.topPanel.height/2,"game","tag");e.anchor.set(0,.5),this.topPanel.addChild(e);var i=LangMng.getBmpText(this.game,LangMng.MENU_WHEEL,"title",10,-10);i.anchor.set(0,.5),TextUtils.sizingBitmapTextByW(i,270,!1,!0),TextUtils.sizingBitmapTextByH(i,130,!1,!0),e.addChild(i);var n=new Phaser.Sprite(this.game,240,150);this.topPanel.addChild(n);var a=new Phaser.Sprite(this.game,-10,2,"game","shit02");a.anchor.set(.5),n.addChild(a),this.tfMoney=new Phaser.BitmapText(this.game,0,0,LangMng.FONT_WHITE,String(GameData.getMoney()),70),this.tfMoney.anchor.set(.5),n.addChild(this.tfMoney);var s=new Phaser.Sprite(this.game,this.tfMoney.x-this.tfMoney.width/2,this.tfMoney.y,"game","icon_coin");s.anchor.set(1,.5),n.addChild(s),a.width=this.tfMoney.width+100,this.updateMoneyText(),this.midPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","popup_bg",766,774,{top:30,bottom:30,left:30,right:30}),this.midPanel.anchor.set(.5,0),this.dummyMain.addChild(this.midPanel),this.rulet=new Phaser.Sprite(this.game,0,this.midPanel.height/2,"game","fortunewheel_wheel"),this.rulet.anchor.set(.5),this.midPanel.addChild(this.rulet),this.conus=new Phaser.Sprite(this.game,this.rulet.x,-4,"game","fortunewheel_arrow"),this.conus.anchor.set(.5,0),this.midPanel.addChild(this.conus),this.botPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","down_bar",800,180,{top:5,bottom:2,left:0,right:0}),this.botPanel.anchor.set(.5,0),this.dummyMain.addChild(this.botPanel),this.btnClose=new t.SimpleButton(this.game,-this.botPanel.width/2+80,this.botPanel.height/2+4,"game",this.onCloseClick,this,"back_btn","back_btn"),this.btnClose.anchor.set(.5),this.botPanel.addChild(this.btnClose);var o="green_btn";this.btnSpin=new t.SimpleButton(this.game,0,this.botPanel.height/2,"game",this.onSpinClick,this,o,o),this.btnSpin.anchor.set(.5),this.btnSpin.alpha=GameData.getPresentCnt()>0?1:.8,GameData.getPresentCnt()<=0&&(this.btnSpin.inputEnabled=!1),this.btnSpinText=LangMng.getBmpText(this.game,LangMng.MENU_WHEEL,"btn_spin",0,0),this.btnSpinText.anchor.set(.5),this.btnSpinText.alpha=GameData.getPresentCnt()>0?1:.8,TextUtils.sizingBitmapTextByW(this.btnSpinText,400,!1,!0),this.btnSpin.addChild(this.btnSpinText),this.botPanel.addChild(this.btnSpin),this.back=new Phaser.Graphics(this.game),this.back.beginFill(0,.2),this.back.drawRect(0,0,Config.GH,Config.GH),this.back.endFill(),this.back.inputEnabled=!0,this.back.visible=!1,this.add.existing(this.back),this.rewWnd=new t.OutstandWindow(this.game,this.world.centerX,this.world.centerY),this.rewWnd.onCloseClick.add(this.onRewWndClose,this),this.rewWnd.visible=!1,this.add.existing(this.rewWnd),ScaleManager.onOrientationChangeSignal.add(this.onOrientationChange,this),this.onOrientationChange()},o.prototype.updateMoneyText=function(){this.tfMoney.text=String(GameData.getMoney())},o.getRandomReward=function(){return a[MyMath.randomIntInRange(0,a.length-1)]},o.prototype.onOrientationChange=function(){try{this.topPanel.position.set(0,0),this.midPanel.position.set(0,this.topPanel.y+this.topPanel.height+5),this.botPanel.position.set(0,Config.GH-this.botPanel.height),this.dummyMain.position.set(this.game.world.width/2,0),ScaleManager.isPortrait?this.dummyMain.scale.set(1):this.dummyMain.scale.set(Config.GW/Config.GH),this.rewWnd.position.set(this.world.centerX,this.world.centerY)}catch(t){}},o.prototype.onCloseClick=function(){this.game.state.start("MainMenu",!0,!1)},o.prototype.onSpinClick=function(){GameData.getPresentCnt()<=0||(this.btnSpin.inputEnabled=!1,this.startRoll())},o.prototype.startRoll=function(){this.curSpd=MyMath.randomInRange(700,1200),this.rollTimer=MyMath.randomInRange(.5,1.5),this.stopAcc=MyMath.randomInRange(-500,-400),this.state=i},o.prototype.givePrizeByCircle=function(){var t=this.rulet.angle-15;t<0&&(t+=360);var e=Math.floor(t/30);GameData.changePresentCnt(-1);var i=a[e].type,n=a[e].val;this.back.visible=!0,this.rewWnd.setReward(i,n),GuiUtils.showPopupWindow(this.game,this.rewWnd,new Phaser.Point(this.world.centerX,-500),new Phaser.Point(this.world.centerX,this.world.centerY)),this.updateMoneyText()},o.prototype.onRewWndClose=function(){this.rewWnd.visible=!1,this.back.visible=!1,this.updateMoneyText()},o.prototype.update=function(){var t=this.game.time.elapsedMS/1e3;switch(this.btnSpin.inputEnabled&&1!=this.btnSpin.alpha&&(this.btnSpin.alpha=1,this.btnSpinText.alpha=1,this.btnSpinText.y=-4),this.btnSpin.inputEnabled||.8==this.btnSpin.alpha||(this.btnSpin.alpha=.8,this.btnSpinText.alpha=.8,this.btnSpinText.y=4),this.state){case i:this.rulet.angle+=this.curSpd*t,this.rollTimer-=t,this.rollTimer<=0&&(this.state=n);break;case n:this.curSpd+=this.stopAcc*t,this.curSpd<0&&(this.curSpd=0),this.rulet.angle+=this.curSpd*t,this.curSpd<=0&&(this.state=e,this.givePrizeByCircle(),this.btnSpin.inputEnabled=GameData.getPresentCnt()>0,this.btnSpin.inputEnabled&&(this.btnSpin.input.useHandCursor=!0))}},o}(Phaser.State);t.Rulet=s}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(i,n,a){var s=e.call(this,i,n,a)||this;s.onHomeClickSignal=new Phaser.Signal,s.onLevelsClickSignal=new Phaser.Signal,s.fon=new PhaserNineSlice.NineSlice(s.game,0,0,"game","popup_bg",670,500,{top:30,bottom:30,left:30,right:30}),s.fon.anchor.set(.5),s.addChild(s.fon);var o=new Phaser.Sprite(s.game,0,-s.fon.height/2,"game","banner");o.anchor.set(.5),s.addChild(o),s.btnLevels=new t.SimpleButton(s.game,0,-100,"game",s.onLevelsClick,s,"orange_btn","orange_btn"),s.btnLevels.anchor.set(.5),s.addChild(s.btnLevels);var h=new Phaser.Sprite(s.game,s.btnLevels.x-s.btnLevels.width/2+60,s.btnLevels.y,"game","icon_menu");h.anchor.set(.5),s.addChild(h),s.btnHome=new t.SimpleButton(s.game,0,30,"game",s.onHomeClick,s,"orange_btn","orange_btn"),s.btnHome.anchor.set(.5),s.addChild(s.btnHome);var r=new Phaser.Sprite(s.game,s.btnHome.x-s.btnHome.width/2+60,s.btnHome.y,"game","icon_home");r.anchor.set(.5),s.addChild(r),s.btnSnd=new t.SimpleButton(s.game,0,160,"game",s.onSndClick,s,"violet_btn","violet_btn"),s.btnSnd.anchor.set(.5),s.addChild(s.btnSnd),s.iconSnd=new Phaser.Sprite(s.game,s.btnSnd.x-s.btnSnd.width/2+60,s.btnSnd.y,"game","icon_soundoff"),s.iconSnd.anchor.set(.5),s.addChild(s.iconSnd);var l=new Phaser.Button(s.game,340,-300,"game",null,null,"close_btn","close_btn");l.anchor.set(.5),l.scale.set(1),l.inputEnabled=!0,l.events.onInputDown.add(s.onCloseClick,s),s.addChild(l);var d=LangMng.getBmpText(s.game,LangMng.MENU_OPTIONS,"title",0,-10);return d.anchor.set(.5),o.addChild(d),s.tfLevels=LangMng.getBmpText(s.game,LangMng.MENU_OPTIONS,"btn_levels",s.btnLevels.x+h.width/2,s.btnLevels.y),s.tfLevels.anchor.set(.5),s.addChild(s.tfLevels),s.tfHome=LangMng.getBmpText(s.game,LangMng.MENU_OPTIONS,"btn_menu",s.btnHome.x+r.width/2,s.btnHome.y),s.tfHome.anchor.set(.5),TextUtils.sizingBitmapTextByW(s.tfHome,320,!1,!0),s.addChild(s.tfHome),s.tfSnd=LangMng.getBmpText(s.game,LangMng.MENU_OPTIONS,"btn_s_on",s.btnSnd.x+s.iconSnd.width/2,s.btnSnd.y),s.tfSnd.anchor.set(.5),s.addChild(s.tfSnd),s.updateSndBtn(),s}return __extends(i,e),i.prototype.updateSndBtn=function(){SndMng.isSndEnabled()?(this.btnSnd.setFrames("green_btn","green_btn"),this.tfSnd.text=LangMng.getText(LangMng.MENU_OPTIONS,"btn_s_on"),this.tfSnd.font=LangMng.getFont(LangMng.MENU_OPTIONS,"btn_s_on"),this.iconSnd.frameName="icon_soundon",this.tfSnd.fontSize=LangMng.getTextSize(LangMng.MENU_OPTIONS,"btn_s_on"),TextUtils.sizingBitmapTextByW(this.tfSnd,340,!1,!0)):(this.btnSnd.setFrames("violet_btn","violet_btn"),this.tfSnd.text=LangMng.getText(LangMng.MENU_OPTIONS,"btn_s_off"),this.tfSnd.font=LangMng.getFont(LangMng.MENU_OPTIONS,"btn_s_off"),this.iconSnd.frameName="icon_soundoff",this.tfSnd.fontSize=LangMng.getTextSize(LangMng.MENU_OPTIONS,"btn_s_on"),TextUtils.sizingBitmapTextByW(this.tfSnd,320,!1,!0))},i.prototype.onCloseClick=function(){SG_Hooks.triggerMidrollAd((()=>{this.visible=!1}))},i.prototype.onLevelsClick=function(){this.onLevelsClickSignal.dispatch()},i.prototype.onHomeClick=function(){this.onHomeClickSignal.dispatch()},i.prototype.onSndClick=function(){SndMng.switchSoundEnabled(this.game),this.updateSndBtn()},i}(Phaser.Sprite);t.EscMenu=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n,a,s){var o=t.call(this,e,i,n)||this;o.starsCnt=0,o.btn_w=170,o.btn_h=170,o.id=a;var h=new Phaser.Sprite(o.game,0,0,"game","lvl-btn-bg");o.addChild(h);var r=GameData.getLevelStarsCount(GameData.currentDif,a);r>3&&(r=3),o.starsCnt=null!=r?r:0,o.isAvailable=0==o.id||GameData.getLevelStarsCount(GameData.currentDif,a-1)>0,o.isAvailable||(o.alpha=.8);for(var l=0;l<3;l++){var d=new Phaser.Sprite(o.game,40+44*l,130,"game","star_slot");if(1==l&&(d.y-=15),d.scale.set(.46),0!=l&&2!=l||d.scale.set(.4),d.anchor.set(.5),o.addChild(d),l<o.starsCnt){var c=new Phaser.Sprite(o.game,d.x,d.y,"game","star");c.scale.set(.46),0!=l&&2!=l||c.scale.set(.4),c.anchor.set(.5),o.addChild(c)}}return s?(o.prizeIcon=new Phaser.Sprite(o.game,o.btn_w/2,o.btn_h/2-12,"game","icon_present"),o.prizeIcon.anchor.set(.5),o.addChild(o.prizeIcon)):(o.title=new Phaser.BitmapText(o.game,o.btn_w/2,o.btn_h/2-35,LangMng.FONT_WH_BR_OUT,String(a+1),80),1==o.title.text.length&&(o.title.text="0"+o.title.text),o.title.anchor.set(.5),o.isAvailable||(o.title.alpha=.4),o.addChild(o.title)),o}return __extends(e,t),e}(Phaser.Sprite);t.LevelBtn=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n,a){var s=t.call(this,e,i,n)||this;s.isLocked=!1,s.btn_w=766,s.btn_h=120,s.onClickSignal=new Phaser.Signal,s.id=a;var o=new Phaser.Sprite(s.game,0,0,"game","gradient_tile");s.addChild(o);var h=new Phaser.Sprite(s.game,0,0,"game","star_slot");return h.anchor.set(.5),h.scale.set(.7),h.position.set(s.btn_w-60,s.btn_h/2),s.addChild(h),s.star=new Phaser.Sprite(s.game,h.x,h.y,"game","star"),s.star.anchor.set(.5),s.star.scale.set(h.scale.x),s.star.visible=GameData.getStarsCntInDif(a)>0,s.addChild(s.star),s.lock=new Phaser.Sprite(s.game,450,s.btn_h/2,"game","icon_padlock"),s.lock.anchor.set(.5),s.lock.visible=GameData.isDifLocked(a),s.addChild(s.lock),s.title=LangMng.getBmpTextBtnSection(s.game,"sec_title_"+String(a+1),20,60),s.title.anchor.set(0,.5),TextUtils.sizingBitmapTextByW(s.title,400,!1,!0),s.addChild(s.title),s.starText=LangMng.getBmpTextBtnSection(s.game,"sec_title_"+String(a+1),h.x-70,s.btn_h/2),s.starText.anchor.set(1,.5),s.starText.text=String(GameData.getStarsCntInDif(a))+"/"+String(3*Setting.LEVELS_IN_DIF_CNT),s.addChild(s.starText),s}return __extends(e,t),e.prototype.onClick=function(){this.onClickSignal.dispatch(this)},e.prototype.lockTurn=function(){this.game.add.tween(this.lock).to({angle:45},200,Phaser.Easing.Linear.None,!0).onComplete.addOnce((function(){this.game.add.tween(this.lock).to({angle:-45},400,Phaser.Easing.Linear.None,!0).onComplete.addOnce((function(){this.game.add.tween(this.lock).to({angle:0},200,Phaser.Easing.Linear.None,!0)}),this)}),this)},e.prototype.unlock=function(){this.game.add.tween(this.lock).to({alpha:0},500,Phaser.Easing.Linear.None,!0);this.game.add.tween(this.lock.scale).to({x:2,y:2},500,Phaser.Easing.Linear.None,!0).onComplete.addOnce((function(){this.lock.visible=!1}),this)},e}(Phaser.Sprite);t.DifBtn=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e,i=function(i){function n(n,a,s){var o=i.call(this,n,a,s)||this;o.onTriggerIncentiviseRes=new Phaser.Signal,o.onAllVideosWatched=new Phaser.Signal,o.onMoneyChangedSignal=new Phaser.Signal,o.fon=new PhaserNineSlice.NineSlice(o.game,0,0,"game","popup_bg",670,480,{top:30,bottom:30,left:30,right:30}),o.fon.anchor.set(.5),o.addChild(o.fon);var h=new Phaser.Sprite(o.game,0,-o.fon.height/2,"game","banner");h.anchor.set(.5),o.addChild(h);var r=LangMng.getBmpText(o.game,LangMng.MENU_NEED_COINS,"title",0,-14);r.align="center",r.anchor.set(.5),TextUtils.sizingBitmapTextByH(r,120,!1,!0),h.addChild(r);var l=new t.SimpleButton(o.game,340,-300,"game",null,null,"close_btn","close_btn");l.anchor.set(.5),l.scale.set(1),l.inputEnabled=!0,l.events.onInputDown.add(o.onClose,o),o.addChild(l);var d=new Phaser.Sprite(o.game,0,-40,"game","icon_adv");d.anchor.set(.5),o.addChild(d),o.btnWatch=new t.SimpleButton(o.game,0,150,"game",o.onWatchClick,o,"green_btn","green_btn"),o.btnWatch.anchor.set(.5);var c=LangMng.getBmpText(o.game,LangMng.MENU_NEED_COINS,"btn_watch",0,0);return c.anchor.set(.5),o.btnWatch.addChild(c),o.rewVal=o.game.cache.getJSON("settings").adReward,SGHooksMng.isEnabledIncentiviseButton()&&o.addChild(o.btnWatch),(e=o.onTriggerIncentiviseRes).add(o.onIncentiviseFinished,o),o}return __extends(n,i),n.prototype.showBtn=function(){this.btnWatch.visible=!0},n.prototype.updateEvents=function(){(e=this.onTriggerIncentiviseRes).add(this.onIncentiviseFinished,this)},n.prototype.onWatchClick=function(){this.btnWatch.visible=!1,SG_Hooks.mainMusic.volume=0,SG_Hooks.triggerIncentivise((function(t){e.dispatch(t)}))},n.prototype.onIncentiviseFinished=function(t){1==t?(GameData.changeMoney(this.rewVal),this.onMoneyChangedSignal.dispatch(),this.doClose()):this.onAllVideosWatched.dispatch(),SG_Hooks.mainMusic.volume=1},n.prototype.onClose=function(t){this.doClose()},n.prototype.doClose=function(){this.game.add.tween(this).to({alpha:0},250).start().onComplete.add(this.onCloseComplete,this)},n.prototype.onCloseComplete=function(){this.visible=!1,this.alpha=1},n}(Phaser.Sprite);t.GetMoneyWindow=i}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this;a.fon=new PhaserNineSlice.NineSlice(a.game,0,0,"game","popup_bg",670,480,{top:30,bottom:30,left:30,right:30}),a.fon.anchor.set(.5),a.addChild(a.fon);var s=new Phaser.Sprite(a.game,0,-a.fon.height/2,"game","banner");s.anchor.set(.5),a.addChild(s);var o=LangMng.getBmpText(a.game,LangMng.MENU_ALL_WATCHED,"title",0,-10);o.anchor.set(.5),s.addChild(o);var h=new Phaser.Button(a.game,340,-300,"game",null,null,"close_btn","close_btn");h.anchor.set(.5),h.scale.set(1),h.inputEnabled=!0,h.events.onInputDown.add(a.onClose,a),a.addChild(h);var r=LangMng.getBmpText(a.game,LangMng.MENU_ALL_WATCHED,"text",0,20);return r.align="center",r.anchor.set(.5),a.addChild(r),a}return __extends(e,t),e.prototype.onClose=function(t){this.visible=!1},e}(Phaser.Sprite);t.AllWatched=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(i,n,a){var s=e.call(this,i,n,a)||this;s.onPresentClickSignal=new Phaser.Signal,s.fon=new Phaser.Sprite(s.game,0,0,"game","congrats-wnd"),s.fon.anchor.set(.5),s.addChild(s.fon);var o=new Phaser.Sprite(s.game,0,-140,"game","congrats-title");o.anchor.set(.5),s.addChild(o);var h=new Phaser.Button(s.game,242,-240,"game",null,null,"outstand-close-btn","outstand-close-btn");h.inputEnabled=!0,h.events.onInputDown.add(s.onClose,s);for(var r=0;r<3;r++){var l=new Phaser.Button(s.game,170*r-170,75,"game",s.onPresentClick,s,"big-gift","big-gift");l.anchor.set(.5),s.addChild(l)}var d=new Phaser.Sprite(s.game,0,230,"game","congrats-text");return d.anchor.set(.5),s.addChild(d),s.rewWnd=new t.OutstandWindow(s.game,0,0),s.rewWnd.onCloseClick.add(s.onRewWndClose,s),s.rewWnd.visible=!1,s.addChild(s.rewWnd),s}return __extends(i,e),i.prototype.givePrizeByCircle=function(t,e){this.rewWnd.setReward(t,e),GuiUtils.showPopupWindow(this.game,this.rewWnd,new Phaser.Point(0,-500),new Phaser.Point(0,0))},i.prototype.onRewWndClose=function(){this.rewWnd.visible=!1},i.prototype.onPresentClick=function(){t.Rulet.getRandomReward();this.onPresentClickSignal.dispatch()},i.prototype.onClose=function(t){},i}(Phaser.Sprite);t.PresentWindow=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n,a){var s=t.call(this,e,i,n)||this;s.descripFontSize=0,s.btn_w=766,s.btn_h=120,s.onGetClickSignal=new Phaser.Signal,s.id=a;var o=new Phaser.Sprite(s.game,0,0,"game","gradient_tile");s.addChild(o),s.prizeIcon=new Phaser.Sprite(s.game,500,60,"game","icon_present"),s.prizeIcon.anchor.set(.5),s.prizeIcon.visible=!1,s.addChild(s.prizeIcon),s.title=new Phaser.BitmapText(s.game,20,10,LangMng.getQuestNameFont(),GameData.Q_PARAMS[a].name,LangMng.getQuestNameSize()),s.addChild(s.title),s.descripFontSize=LangMng.getQuestDescSize(),s.discr=new Phaser.BitmapText(s.game,20,60,LangMng.getQuestDescFont(),"",s.descripFontSize),s.addChild(s.discr),s.dummyBar=new Phaser.Sprite(s.game,506,22),s.dummyBar.scale.set(.7,1),o.addChild(s.dummyBar);var h=new Phaser.Sprite(s.game,0,0,"preloader","progressbar_empty");s.dummyBar.addChild(h),s.bar=new Phaser.Sprite(s.game,h.x,h.y,"preloader","progressbar"),s.dummyBar.addChild(s.bar),s.barMask=new Phaser.Graphics(s.game,s.bar.x,s.bar.y),s.barMask.beginFill(43520);var r=GameData.getStarsCntInDif(GameData.currentDif)/(3*Setting.LEVELS_IN_DIF_CNT);s.barMask.drawRect(0,0,s.bar.width*r,s.bar.height),s.barMask.endFill(),s.dummyBar.addChild(s.barMask),s.bar.mask=s.barMask;var l=new Phaser.Graphics(s.game,0,0);l.beginFill(0,0),l.drawRect(0,0,276,112),l.endFill(),s.btnBuy=new Phaser.Sprite(s.game,490,0),s.btnBuy.addChild(l),s.btnBuy.inputEnabled=!0,s.btnBuy.events.onInputDown.add(s.onGetClick,s),o.addChild(s.btnBuy),s.btnBuyText=LangMng.getBmpText(s.game,LangMng.MENU_QUESTS,"btn_buy",0,0),s.btnBuyText.text="",s.btnBuyText.anchor.set(.5),s.btnBuyText.x=s.btnBuy.x+l.width/2,s.btnBuyText.y=s.btnBuy.y+l.height/2,o.addChild(s.btnBuyText),s.completeAlertIcon=new Phaser.Sprite(s.game,o.width,0,"game","icon_new"),s.completeAlertIcon.anchor.set(1,0),s.completeAlertIcon.visible=!1,o.addChild(s.completeAlertIcon),s.dailyIcon=new Phaser.Sprite(s.game,o.width,o.height,"game","tag_daily2"),s.dailyIcon.anchor.set(1,1);var d=LangMng.getBmpText(s.game,LangMng.MENU_QUESTS,"daily",-s.dailyIcon.width/2,-s.dailyIcon.height/2);return d.anchor.set(.5),TextUtils.sizingBitmapTextByW(d,s.dailyIcon.width-45,!1,!0),s.dailyIcon.addChild(d),s.dailyIcon.visible=!1,o.addChild(s.dailyIcon),s.refreshGetBtn(),s}return __extends(e,t),e.prototype.getNumStr=function(t){return String(t)},e.prototype.onGetClick=function(){GameData.QUESTS[this.id].current<GameData.QUESTS[this.id].mission||GameData.getQuest(this.id)&&(this.refreshGetBtn(),this.onGetClickSignal.dispatch(this))},e.prototype.refreshGetBtn=function(){if(GameData.QUESTS[this.id].current<GameData.QUESTS[this.id].mission){this.completeAlertIcon.visible=!1;var t=Math.floor(GameData.QUESTS[this.id].current/GameData.QUESTS[this.id].mission);t<=0&&(t=1),this.btnBuy.input.useHandCursor=!1,this.btnBuy.inputEnabled=!1,this.prizeIcon.frameName="icon_padlock",this.prizeIcon.scale.set(1),this.prizeIcon.visible=!0;var e=GameData.QUESTS[this.id].current,i=GameData.QUESTS[this.id].mission,n=this.getNumStr(e),a=this.getNumStr(i),s=Math.floor(100*e/i);this.btnBuyText.text=i>999?String(s)+"%":n+"/"+a,this.barMask.clear(),this.barMask.beginFill(43520),this.barMask.drawRect(0,0,this.bar.width*s/100,this.bar.height),this.barMask.endFill()}else this.btnBuy.inputEnabled=!0,this.btnBuy.input.useHandCursor=!0,this.barMask.clear(),this.barMask.beginFill(43520),this.barMask.drawRect(0,0,this.bar.width,this.bar.height),this.barMask.endFill(),this.prizeIcon.frameName="icon_present",this.prizeIcon.scale.set(.45),this.prizeIcon.visible=!0,this.btnBuyText.text=LangMng.getText(LangMng.MENU_QUESTS,"btn_buy"),this.completeAlertIcon.visible=!0;var o=GameData.Q_PARAMS[this.id].desc;GameData.QUESTS[this.id].mission,GameData.QUESTS[this.id].mission2;o=(o=o.replace("MIS1",String(GameData.QUESTS[this.id].mission))).replace("MIS2",String(GameData.QUESTS[this.id].mission2)),this.discr.text=o,this.discr.fontSize=this.descripFontSize,TextUtils.sizingBitmapTextByW(this.discr,440,!1,!0)},e.prototype.setDaily=function(t){this.dailyIcon.visible=t,this.isDaily=t},e}(Phaser.Sprite);t.QuestItem=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=new Phaser.Signal,i=function(i){function n(e,n,a,s){void 0===s&&(s=!0);var o=i.call(this,e,n,a)||this;o.onCloseClick=new Phaser.Signal,o.fon=new PhaserNineSlice.NineSlice(o.game,0,0,"game","popup_bg",670,480,{top:30,bottom:30,left:30,right:30}),o.fon.anchor.set(.5),o.addChild(o.fon);var h=new Phaser.Sprite(o.game,0,-o.fon.height/2,"game","banner");h.anchor.set(.5),o.addChild(h);var r=LangMng.getBmpText(o.game,LangMng.MENU_OUTSTAND,"title",0,-10);r.anchor.set(.5),h.addChild(r);var l=new t.SimpleButton(o.game,340,-300,"game",null,null,"close_btn","close_btn");l.anchor.set(.5),l.scale.set(1),l.inputEnabled=!0,l.events.onInputDown.add(o.onClose,o),o.addChild(l);var d=LangMng.getBmpText(o.game,LangMng.MENU_OUTSTAND,"ugot",0,-110);d.anchor.set(.5),o.addChild(d),o.dummyFon=new PhaserNineSlice.NineSlice(o.game,0,0,"game","shit02",300,100,{top:35,bottom:35,left:35,right:35}),o.dummyFon.anchor.set(.5),o.addChild(o.dummyFon);o.moneyText=new Phaser.BitmapText(o.game,20,0,LangMng.FONT_WH_BR_OUT,"",90),o.moneyText.anchor.set(.5),o.addChild(o.moneyText);o.icon=new Phaser.Sprite(o.game,o.moneyText.x-o.moneyText.width/2,o.moneyText.y+2,"game","icon_coin"),o.icon.anchor.set(1,.5),o.addChild(o.icon),o.btnWatch=new t.SimpleButton(o.game,0,150,"game",o.onWatchClick,o,"green_btn","green_btn"),o.btnWatch.anchor.set(.5);var c=new Phaser.Sprite(o.game,-o.btnWatch.width/2+16,0,"game","icon_coin");c.scale.set(.7),c.anchor.set(0,.5),o.btnWatch.addChild(c);var g=new Phaser.BitmapText(o.game,c.x+c.width+10,0,LangMng.FONT_WH_BR_SW,"2X",80);g.anchor.set(0,.5),o.btnWatch.addChild(g);var u=new Phaser.BitmapText(o.game,75,0,LangMng.FONT_GREEN,LangMng.getText(LangMng.MENU_OUTSTAND,"watch_to_double"),50,"center");return u.anchor.set(.5),TextUtils.sizingBitmapTextByW(u,270,!1,!0),o.btnWatch.addChild(u),o.btnWatch.visible=SGHooksMng.isEnabledIncentiviseButton(),s&&o.addChild(o.btnWatch),o.watchedWnd=new t.AllWatched(o.game,0,0),o.watchedWnd.anchor.set(.5),o.watchedWnd.visible=!1,o.addChild(o.watchedWnd),o}return __extends(n,i),n.prototype.onWatchClick=function(){this.btnWatch.visible=!1,SG_Hooks.mainMusic.volume=0,SG_Hooks.triggerIncentivise((function(t){e.dispatch(t)}))},n.prototype.onIncentiviseFinished=function(t){1==t?null!=this&&null!=this.rewType&&null!=this.rewVal&&(LogMng.debug("user has been incentivised, this.rewType = "+this.rewType+", this.rewVal = "+this.rewVal),this.drawReward(this.rewType,2*this.rewVal,!1),this.addReward(this.rewType,this.rewVal)):this.watchedWnd.visible=!0,SG_Hooks.mainMusic.volume=1},n.prototype.onClose=function(t){this.onCloseClick.dispatch()},n.prototype.drawReward=function(t,e,i){void 0===i&&(i=!0);var n="icon_coin",a=.8,s=String(e);switch(t){case 1:n="icon_hint",a=.7;break;case 2:n="icon_key",a=.7}try{this.moneyText.text=s,i&&(this.icon.frameName=n,this.icon.scale.set(a)),this.icon.x=this.moneyText.x-this.moneyText.width/2-15}catch(t){}},n.prototype.addReward=function(t,e){switch(LogMng.debug("OutstandWindow.addReward: t = "+t+", val = "+e),t){case 0:GameData.changeMoney(e);break;case 1:GameData.changeHintsCnt(e);break;case 2:GameData.changeKeysCnt(e)}},n.prototype.setReward=function(t,i,n){void 0===n&&(n=!0),this.rewType=t,this.rewVal=i,this.drawReward(t,i,!0),n&&this.addReward(t,i),this.btnWatch.visible=SGHooksMng.isEnabledIncentiviseButton(),null!=this.btnWatch.parent&&this.btnWatch.visible&&e.addOnce(this.onIncentiviseFinished,this)},n}(Phaser.Sprite);t.OutstandWindow=i}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(i,n,a){var s=e.call(this,i,n,a)||this;return s.list_w=200,s.list_h=200,s.cont_w=100,s.cont_h=100,s.items=[],s.vel=0,s.prev_y=0,s.timerCheckVel=0,s.down_x=0,s.down_y=0,s.onDifClickSignal=new Phaser.Signal,s.cont=new Phaser.Sprite(s.game,0,0),s.addChild(s.cont),s.scrollOwner=new Phaser.Graphics(s.game,0,0),s.scrollOwner.beginFill(0,0),s.scrollOwner.drawRect(0,0,s.list_w,s.list_h),s.scrollOwner.endFill(),s.cont.addChild(s.scrollOwner),s.cont.inputEnabled=!0,s.cont.input.allowHorizontalDrag=!1,s.cont.input.allowVerticalDrag=!0,s.cont.input.enableDrag(!1),s.cont.events.onDragStart.add(s.onListDragStart,s),s.cont.events.onDragUpdate.add(s.onListDragUpd,s),s.cont.events.onDragStop.add(s.onListDragStop,s),s.cont.events.onInputDown.add(s.onListInputDown,s),s.cont.events.onInputUp.add(s.onListInputUp,s),s.listMask=new Phaser.Graphics(s.game,0,0),s.listMask.beginFill(0,0),s.listMask.drawRect(0,0,s.list_w,s.list_h),s.listMask.endFill(),s.addChild(s.listMask),s.cont.mask=s.listMask,s.tfDebug=new t.DebugTextBlock(i,0,0),s}return __extends(i,e),i.prototype.setListSize=function(t,e){this.list_w=t,this.list_h=e,this.listMask.clear(),this.listMask.beginFill(0,0),this.listMask.drawRect(0,0,this.list_w,this.list_h),this.listMask.endFill()},i.prototype.setContentSize=function(t,e){this.cont_w=t,this.cont_h=e,this.scrollOwner.clear(),this.scrollOwner.beginFill(0,0),this.scrollOwner.drawRect(0,0,this.cont_w,this.cont_h),this.scrollOwner.endFill()},i.prototype.addItem=function(t){this.items.push(t),this.cont.addChild(t)},i.prototype.onListDragStart=function(t,e){this.down_x=e.x,this.down_y=e.y,this.isDrag=!0,this.scrollStartYPos=this.cont.y,this.prev_y=this.cont.y},i.prototype.onListDragUpd=function(){this.isScrolled=Math.abs(this.scrollStartYPos-this.cont.y)>10},i.prototype.onListDragStop=function(t,e){this.isDrag=!1},i.prototype.onListInputDown=function(t,e){},i.prototype.onListInputUp=function(t,e){this.updVel();this.cont.input.pointerX(0);e.x,this.down_x;this.cont.input.pointerY(0),this.y,this.cont.y;e.y,this.y,this.cont.y,this.down_y,this.y,this.cont.y,Math.abs(this.scrollStartYPos-this.cont.y)<=10&&this.onDifClickSignal.dispatch()},i.prototype.updVel=function(){this.vel=this.cont.y-this.prev_y,this.prev_y=(this.cont.y+this.prev_y)/2},i.prototype.update=function(){var t=this.game.time.elapsed/1e3;if(this.cont.input.isDragged)this.timerCheckVel-=t,this.timerCheckVel<=0&&(this.timerCheckVel=.4,this.updVel());else{var e=0;e=this.vel*t*12,this.vel/=1.1;var i=-this.cont_h+this.list_h;this.cont.y>0&&(e=-this.cont.y*t*10),this.cont.y<i&&(e=(i-this.cont.y)*t*10),this.cont.y+=e}this.tfDebug.update()},i}(Phaser.Sprite);t.DifList=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n,a,s,o,h){var r=t.call(this,e,i,n)||this;r.btn_w=770,r.btn_h=165,r.onBuyClickSignal=new Phaser.Signal,r.type=a,r.count=s,r.price=o;var l=new PhaserNineSlice.NineSlice(r.game,0,0,"game","popup_bg",r.btn_w,r.btn_h,{top:30,bottom:30,left:30,right:30});r.addChild(l);var d=new Phaser.Sprite(r.game,80,80,"game","shop_circle");switch(d.anchor.set(.5),r.addChild(d),r.icon=new Phaser.Sprite(r.game,d.x,d.y,"game","icon_hint"),a){case 0:case 1:break;case 2:r.icon.frameName="icon_key"}switch(r.icon.anchor.set(.5),r.addChild(r.icon),a){case 1:r.title=1==s?LangMng.getBmpText(r.game,LangMng.MENU_SHOP,"hint",150,r.btn_h/2):LangMng.getBmpText(r.game,LangMng.MENU_SHOP,"hints",150,r.btn_h/2);break;case 2:r.title=1==s?LangMng.getBmpText(r.game,LangMng.MENU_SHOP,"key",150,r.btn_h/2):LangMng.getBmpText(r.game,LangMng.MENU_SHOP,"keys",150,r.btn_h/2)}r.title.anchor.set(0,.5),r.title.text=String(s)+" "+r.title.text,r.addChild(r.title),r.btnBuy=new PhaserNineSlice.NineSlice(r.game,r.btn_w/2+r.btn_w/4,r.btn_h/2,"game","green_btn",280,110,{top:60,bottom:40,left:50,right:50}),r.btnBuy.anchor.set(.5),r.btnBuy.inputEnabled=!0,r.btnBuy.input.useHandCursor=!0,r.btnBuy.events.onInputDown.add(r.onBuyClick,r),r.btnBuy.events.onInputUp.add(r.onBuyUp,r),r.addChild(r.btnBuy);var c=new Phaser.Sprite(r.game,0,0,"game","icon_coin");c.anchor.set(.5),c.scale.set(.8),r.btnBuy.addChild(c);var g=String(o);return o>=5e4&&(g=String(Math.round(o/1e3))+"K"),r.btnBuyText=new Phaser.BitmapText(r.game,0,0,LangMng.FONT_GREEN,g,80),r.btnBuyText.anchor.set(.5),r.btnBuyText.x=-(r.btnBuyText.width+c.width)/2+r.btnBuyText.width/2,r.btnBuy.addChild(r.btnBuyText),c.x=r.btnBuyText.x+r.btnBuyText.width/2+c.width/2+10,r}return __extends(e,t),e.prototype.onBuyClick=function(){this.btnBuy.scale.set(.94*this.btnBuy.scale.x),this.onBuyClickSignal.dispatch(this)},e.prototype.onBuyUp=function(){this.btnBuy.scale.set(1)},e}(Phaser.Sprite);t.ShopItem=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(i,n,a){var s=e.call(this,i,n,a)||this;s.items=[],s.back0=new Phaser.Graphics(s.game),s.back0.beginFill(2636132,1),s.back0.drawRect(0,0,s.game.world.width,s.game.world.height),s.back0.endFill(),s.back0.inputEnabled=!0,s.back0.visible=!0,s.addChild(s.back0),s.dummyMain=new Phaser.Sprite(s.game,0,0),s.addChild(s.dummyMain),s.dummyItems=new Phaser.Sprite(s.game,0,0),s.dummyMain.addChild(s.dummyItems);for(var o=0;o<Setting.SHOP_ITEMS.length;o++){var h=new t.ShopItem(s.game,90,390+200*o,Setting.SHOP_ITEMS[o].type,Setting.SHOP_ITEMS[o].cnt,Setting.SHOP_ITEMS[o].price,o);if(h.onBuyClickSignal.add(s.onBuyClick,s),s.dummyItems.addChild(h),s.items.push(h),2==o){var r=new Phaser.Sprite(s.game,40,h.btn_h-40,"game","tag_bestdeal");r.anchor.set(.5),h.addChild(r)}}s.topPanel=new PhaserNineSlice.NineSlice(s.game,0,0,"game","top_bar",800,300,{top:0,bottom:15,left:0,right:0}),s.topPanel.inputEnabled=!0,s.dummyMain.addChild(s.topPanel),s.topPanel.anchor.set(.5,0);var l=new Phaser.Sprite(s.game,-s.topPanel.width/2-6,s.topPanel.height/2,"game","tag");l.anchor.set(0,.5),s.topPanel.addChild(l);var d=LangMng.getBmpText(s.game,LangMng.MENU_SHOP,"title",20,-10);return d.anchor.set(0,.5),TextUtils.sizingBitmapTextByW(d,270,!1,!0),TextUtils.sizingBitmapTextByH(d,130,!1,!0),l.addChild(d),s.dummyMoney=new Phaser.Sprite(s.game,190,s.topPanel.height/2-10),s.topPanel.addChild(s.dummyMoney),s.moneyBack=new Phaser.Sprite(s.game,0,2,"game","shit02"),s.moneyBack.anchor.set(.5),s.dummyMoney.addChild(s.moneyBack),s.tfMoney=new Phaser.BitmapText(s.game,0,0,LangMng.FONT_WHITE,String(GameData.getMoney()),70),s.tfMoney.anchor.set(.5),s.dummyMoney.addChild(s.tfMoney),s.moneyIcon=new Phaser.Sprite(s.game,s.tfMoney.x-s.tfMoney.width/2,s.tfMoney.y,"game","icon_coin"),s.moneyIcon.anchor.set(1,.5),s.dummyMoney.addChild(s.moneyIcon),s.btnMoneyPlus=new t.SimpleButton(s.game,s.tfMoney.x+s.tfMoney.width/2,s.tfMoney.y,"game",s.onMoneyPlusClick,s,"plus_btn","plus_btn"),s.btnMoneyPlus.anchor.set(0,.5),s.btnMoneyPlus.visible=SGHooksMng.isEnabledIncentiviseButton(),s.dummyMoney.addChild(s.btnMoneyPlus),s.moneyBack.width=s.btnMoneyPlus.x-s.moneyIcon.x+100,s.updateMoney(),s.botPanel=new PhaserNineSlice.NineSlice(s.game,0,0,"game","down_bar",800,180,{top:5,bottom:2,left:0,right:0}),s.botPanel.inputEnabled=!0,s.dummyMain.addChild(s.botPanel),s.botPanel.anchor.set(.5,0),s.btnBack=new t.SimpleButton(s.game,-s.botPanel.width/2+80,s.botPanel.height/2+4,"game",s.onBackClick,s,"back_btn","back_btn"),s.btnBack.anchor.set(.5),s.botPanel.addChild(s.btnBack),s.back=new Phaser.Graphics(s.game),s.back.beginFill(0,.2),s.back.drawRect(0,0,s.game.world.width,s.game.world.height),s.back.endFill(),s.back.inputEnabled=!0,s.back.visible=!1,s.addChild(s.back),s.rewWnd=new t.OutstandWindow(s.game,s.game.world.centerX,s.game.world.centerY,!1),s.rewWnd.onCloseClick.add(s.onRewWndClose,s),s.rewWnd.visible=!1,s.addChild(s.rewWnd),s.getMoneyWnd=new t.GetMoneyWindow(s.game,0,0),s.getMoneyWnd.visible=!1,s.getMoneyWnd.onAllVideosWatched.add(s.onAllVideosWatched,s),s.getMoneyWnd.onMoneyChangedSignal.add(s.onNeedMoneyChangedSignal,s),s.addChild(s.getMoneyWnd),s.watchedWnd=new t.AllWatched(s.game,0,0),s.watchedWnd.visible=!1,s.addChild(s.watchedWnd),ScaleManager.onOrientationChangeSignal.add(s.onOrientationChange,s),s.onOrientationChange(),s}return __extends(i,e),i.prototype.onOrientationChange=function(){try{this.dummyMain.position.set(this.game.world.width/2,0),ScaleManager.isPortrait?this.dummyMain.scale.set(1):this.dummyMain.scale.set(Config.GW/Config.GH),this.topPanel.position.set(0,0),this.botPanel.position.set(0,Config.GH-this.botPanel.height),this.btnMoneyPlus.position.set(this.game.world.width-30,20),this.updateMoney();for(var t=0;t<this.items.length;t++)this.items[t].x=0-this.items[t].btn_w/2,this.items[t].y=310+200*t;this.back.clear(),this.back.beginFill(0,.2),this.back.drawRect(0,0,this.game.world.width,this.game.world.height),this.back.endFill(),this.back0.clear(),this.back0.beginFill(2636132,1),this.back0.drawRect(0,0,this.game.world.width,this.game.world.height),this.back0.endFill(),this.getMoneyWnd.visible&&(this.game.tweens.removeFrom(this.getMoneyWnd),this.game.add.tween(this.getMoneyWnd).to({x:this.game.world.centerX,y:this.game.world.centerY},250,Phaser.Easing.Back.Out,!0)),this.watchedWnd.visible&&this.game.add.tween(this.watchedWnd).to({x:this.game.world.centerX,y:this.game.world.centerY},250,Phaser.Easing.Back.Out,!0),this.rewWnd.visible&&this.game.add.tween(this.rewWnd).to({x:this.game.world.centerX,y:this.game.world.centerY},250,Phaser.Easing.Back.Out,!0)}catch(t){}},i.prototype.onMoneyPlusClick=function(){this.getMoneyWnd.showBtn(),this.getMoneyWnd.updateEvents(),GuiUtils.showPopupWindow(this.game,this.getMoneyWnd,new Phaser.Point(this.game.world.centerX,-500),new Phaser.Point(this.game.world.centerX,this.game.world.centerY))},i.prototype.onAllVideosWatched=function(){GuiUtils.showPopupWindow(this.game,this.watchedWnd,new Phaser.Point(this.game.world.centerX,-500),new Phaser.Point(this.game.world.centerX,this.game.world.centerY)),this.updateMoney()},i.prototype.onNeedMoneyChangedSignal=function(){this.updateMoney()},i.prototype.giveTovar=function(t,e,i){if(!(GameData.getMoney()<i)){switch(GameData.changeMoney(-i),t){case 0:case 2:break;case 1:GameData.addQuestValue(GameData.Q_SHOPAHOLIC,e)}this.back.visible=!0,this.rewWnd.setReward(t,e),GuiUtils.showPopupWindow(this.game,this.rewWnd,new Phaser.Point(this.game.world.centerX,-500),new Phaser.Point(this.game.world.centerX,this.game.world.centerY))}},i.prototype.updateMoney=function(){this.tfMoney.text=String(GameData.getMoney()),this.moneyIcon.position.set(this.tfMoney.x-this.tfMoney.width/2,this.tfMoney.y+8),this.btnMoneyPlus.position.set(this.tfMoney.x+this.tfMoney.width/2,this.tfMoney.y+4),this.moneyBack.width=this.btnMoneyPlus.x-this.moneyIcon.x+100},i.prototype.onBuyClick=function(t){this.giveTovar(t.type,t.count,t.price),this.updateMoney()},i.prototype.onBackClick=function(){SG_Hooks.triggerMidrollAd((()=>{this.visible=!1}))},i.prototype.onRewWndClose=function(){this.rewWnd.visible=!1,this.back.visible=!1,this.updateMoney()},i.prototype.update=function(){this.back.visible=this.rewWnd.visible||this.getMoneyWnd.visible},i}(Phaser.Sprite);t.ShopWnd=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n){var a=t.call(this,e,i,n)||this;return a.stars=0,a.bigStar=new Phaser.Sprite(a.game,2,0,"game","star"),a.bigStar.scale.set(.9),a.bigStar.anchor.set(.5,0),a.addChild(a.bigStar),a.lStar=new Phaser.Sprite(a.game,-87,a.bigStar.height-50,"game","star"),a.lStar.scale.set(.7),a.lStar.anchor.set(.5,0),a.addChild(a.lStar),a.rStar=new Phaser.Sprite(a.game,92,a.bigStar.height-50,"game","star"),a.rStar.scale.set(.7),a.rStar.anchor.set(.5,0),a.addChild(a.rStar),a.text=new Phaser.BitmapText(a.game,0,a.bigStar.height,LangMng.FONT_WHITE,"0",68,"center"),a.text.anchor.set(.5,0),a.addChild(a.text),a}return __extends(e,t),e.prototype.update=function(){this.stars!=GameData.starsCount&&(this.stars=GameData.starsCount,this.text.text=this.stars.toString(),this.text.text.length,this.lStar.x=-80,this.rStar.x=80)},e}(Phaser.Sprite);t.StarsCounter=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=new Phaser.Signal,i=function(i){function n(n,a,s,o,h,r,l){var d=i.call(this,n,a,s)||this;d.stars=0,d.currPerc=0,d.onNextClick=new Phaser.Signal,d.onAdWatched=new Phaser.Signal,d.onCloseClick=new Phaser.Signal,d.back0=new Phaser.Graphics(d.game),d.back0.beginFill(0,.2),d.back0.drawRect(-d.game.world.width/2,0,d.game.world.width,d.game.world.height),d.back0.endFill(),d.back0.inputEnabled=!0,d.back0.visible=!0,d.addChild(d.back0),d.fon=new PhaserNineSlice.NineSlice(d.game,0,200,"game","popup_bg",670,700,{top:30,bottom:30,left:30,right:30}),d.fon.anchor.set(.5,0),d.addChild(d.fon);var c=new Phaser.Sprite(d.game,0,d.fon.y,"game","banner");c.anchor.set(.5),d.addChild(c);var g=new t.SimpleButton(d.game,c.x+c.width/2,c.y-50,"game",null,null,"close_btn","close_btn");g.anchor.set(.5),g.scale.set(1),g.inputEnabled=!0,g.events.onInputDown.add(d.onClose,d),d.addChild(g),d.starsPanel=new t.StarsPanel(d.game,0,360),d.starsPanel.setStarsCount(r),d.addChild(d.starsPanel);var u=new Phaser.Sprite(d.game,0,520,"preloader","progressbar_empty");u.x=-u.width/2,d.addChild(u),d.bar=new Phaser.Sprite(d.game,u.x,u.y,"preloader","progressbar"),d.addChild(d.bar);var p=GameData.getStarsCntInDif(GameData.currentDif),m=(p-l)/(3*Setting.LEVELS_IN_DIF_CNT),S=p/(3*Setting.LEVELS_IN_DIF_CNT);d.currPerc=m,d.game.add.tween(d).to({currPerc:S},1e3,null,!0,1500).onUpdateCallback(d.onBarUpdate,d),d.barMask=new Phaser.Graphics(d.game,d.bar.x,d.bar.y),d.barMask.beginFill(43520),d.barMask.drawRect(0,0,d.bar.width,d.bar.height),d.barMask.endFill(),d.barMask.scale.set(d.currPerc,1),d.addChild(d.barMask),d.bar.mask=d.barMask;var f=new Phaser.Sprite(d.game,u.x+u.width,u.y+u.height/2,"game","icon_present");f.anchor.set(.5),f.scale.set(.6),d.addChild(f),d.moneyText=new Phaser.BitmapText(d.game,0,660,LangMng.FONT_WH_BR_OUT,String(h),70),d.moneyText.anchor.set(0,.5),d.addChild(d.moneyText);var y=new Phaser.Sprite(d.game,d.moneyText.x-20,d.moneyText.y+8,"game","icon_coin");y.anchor.set(1,.5),d.addChild(y);g=new t.SimpleButton(d.game,0,800,"game",(function(){var t=SG_Hooks.mainMusic.volume;SG_Hooks.mainMusic.volume=0,SG_Hooks.playButtonPressed((function(){SG_Hooks.mainMusic.volume=t,d.onNext.apply(d,arguments)}))}),d,"green_btn","green_btn"),LangMng.getBmpText(d.game,LangMng.MENU_WIN,"title",0,250),g.anchor.set(.5),d.addChild(g),d.fon2=new PhaserNineSlice.NineSlice(d.game,0,930,"game","popup_bg",670,190,{top:30,bottom:30,left:30,right:30}),d.fon2.anchor.set(.5,0),d.fon2.visible=SGHooksMng.isEnabledIncentiviseButton(),d.addChild(d.fon2);var b=new Phaser.Sprite(d.game,-80,0,"game","icon_coin");b.position.set(-80,100),b.anchor.set(0,.5),d.fon2.addChild(b),d.watchBtn=new PhaserNineSlice.NineSlice(d.game,170,d.fon2.height/2,"game","orange_btn",280,110,{top:60,bottom:40,left:50,right:50}),d.watchBtn.anchor.set(.5),d.watchBtn.inputEnabled=!0,d.watchBtn.input.useHandCursor=!0,d.watchBtn.events.onInputDown.add(d.onWatchClick,d);var w=new Phaser.BitmapText(d.game,-d.fon2.width/2+30,70,LangMng.FONT_BROWN,LangMng.getText(LangMng.MENU_WIN,"watch_an_ad"),55);w.anchor.set(0,.5),TextUtils.sizingBitmapTextByW(w,230,!1,!0),d.fon2.addChild(w);var _=new Phaser.BitmapText(d.game,w.x,w.y+w.height/2+30,LangMng.FONT_BROWN,LangMng.getText(LangMng.MENU_WIN,"get"),w.fontSize);_.anchor.set(0,.5),d.fon2.addChild(_);var C=new Phaser.BitmapText(d.game,_.x+_.width+4,_.y,LangMng.FONT_WH_BR_OUT,"X2",w.fontSize+15);C.anchor.set(0,.5),d.fon2.addChild(C);var M=new Phaser.BitmapText(d.game,C.x+C.width+4,_.y,LangMng.FONT_BROWN,LangMng.getText(LangMng.MENU_WIN,"coins"),w.fontSize);for(M.anchor.set(0,.5),d.fon2.addChild(M);_.width+C.width+M.width+8>230;)C.x=_.x+_.width+4,M.x=C.x+C.width+4,_.fontSize--,C.fontSize--,M.fontSize--;var P=new Phaser.BitmapText(d.game,0,0,LangMng.FONT_ORANGE,LangMng.getText(LangMng.MENU_WIN,"btn_watch"),80);P.anchor.set(.5),TextUtils.sizingBitmapTextByW(P,300,!1,!0),d.watchBtn.addChild(P),d.watchBtn.anchor.set(.5),d.fon2.addChild(d.watchBtn);var v=LangMng.getBmpText(d.game,LangMng.MENU_WIN,"title",0,-10);v.anchor.set(.5),c.addChild(v),d.text=LangMng.getBmpText(d.game,LangMng.MENU_WIN,"score",0,470),d.text.text+=": "+String(o),d.text.anchor.set(.5),d.addChild(d.text),d.setScores(o),d.barText=new Phaser.BitmapText(d.game,d.bar.x+d.bar.width/2,d.bar.y+d.bar.height/2,LangMng.FONT_GREEN,String(Math.floor(100*m))+"%",64),d.barText.anchor.set(.5),d.addChild(d.barText);var T=LangMng.getBmpText(d.game,LangMng.MENU_WIN,"btn_continue",0,0);return T.anchor.set(.5),g.addChild(T),g.visible=!1,SG_Hooks.beforePlayButtonDisplay((function(){g.visible=!0})),d.watchedWnd=new t.AllWatched(d.game,0,650),d.watchedWnd.anchor.set(.5,0),d.watchedWnd.inputEnabled=!0,d.watchedWnd.visible=!1,d.addChild(d.watchedWnd),ScaleManager.onOrientationChangeSignal.add(d.onOrientationChange,d),d.onOrientationChange(),e.add(d.onIncentiviseFinished,d),d}return __extends(n,i),n.prototype.onBarUpdate=function(){this.barMask.scale.set(this.currPerc,1),this.barText.text=String(Math.round(100*this.currPerc))+"%"},n.prototype.onOrientationChange=function(){try{ScaleManager.isPortrait?(this.scale.set(1),this.y=0,this.back0.clear(),this.back0.beginFill(0,.2),this.back0.drawRect(-this.game.world.width/this.scale.x/2,-this.y,this.game.world.width/this.scale.x,this.game.world.height/this.scale.y),this.back0.endFill()):(this.scale.set(.75),this.y=-80,this.back0.clear(),this.back0.beginFill(0,.2),this.back0.drawRect((-this.game.world.width-110)/this.scale.x/2,-this.y,this.game.world.width/this.scale.x,1.5*this.game.world.height/this.scale.y),this.back0.endFill())}catch(t){}},n.prototype.onWatchClick=function(){this.watchBtn.visible=!1,SG_Hooks.mainMusic.volume=0,SG_Hooks.triggerIncentivise((function(t){e.dispatch(t)}))},n.prototype.onIncentiviseFinished=function(t){1==t?this.onAdWatched.dispatch():this.watchedWnd.visible=!0,SG_Hooks.mainMusic.volume=1},n.prototype.onNext=function(){this.onNextClick.dispatch()},n.prototype.onClose=function(){this.onCloseClick.dispatch()},n.prototype.setStarsCount=function(t){},n.prototype.setScores=function(t){this.text.text=LangMng.getText(LangMng.MENU_WIN,"score")+": "+String(t)},n.prototype.setMoney=function(t){this.moneyText.text=String(t)},n}(Phaser.Sprite);t.WinWindow=i}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){t.isTrueNumValue=function(t){return t>0||t<=0};var e=function(t,e,i,n){this.a=t,this.b=e,this.c=i,this.d=n};function i(t,e){return Math.random()*Math.abs(e-t)+t}function n(t,e,i,n,a,s,o,h){var r,l,d,c,g,u,p=!1;return(g=((c=o-t)*(l=n-e)-(r=i-t)*(h-e))/((d=a-t)*l-r*(s-e)))>=0&&g<=1&&(u=(c-g*d)/r)>=0&&g+u<=1&&(p=!0),p}t.RectABCD=e,t.randomInRange=i,t.randomIntInRange=function(t,e){return Math.round(i(t,e))},t.toRadian=function(t){return t*Math.PI/180},t.toDeg=function(t){return 180*t/Math.PI},t.IsPointInTriangle=n,t.isPointInRect=function(t,e){return n(t.a.x,t.a.y,t.b.x,t.b.y,t.c.x,t.c.y,e.x,e.y)&&n(t.c.x,t.c.y,t.d.x,t.d.y,t.a.x,t.a.y,e.x,e.y)},t.isCirclesIntersect=function(t,e,i,n,a,s){return Math.sqrt((n-t)*(n-t)+(a-e)*(a-e))<=i+s}}(MyMath||(MyMath={})),function(t){!function(t){var e=function(e){function i(){var i=e.call(this,Config.GW,Config.GH,Phaser.AUTO,"content",null,!0)||this;return i.state.add("Boot",t.Boot,!1),i.state.add("Preloader",t.Preloader,!1),i.state.add("MainMenu",t.MainMenu,!1),i.state.add("Rulet",t.Rulet,!1),i.state.add("DifSelect",t.DifSelect,!1),i.state.add("LevelSelect",t.LevelSelect,!1),i.state.add("GameProc",t.GameProc,!1),i.state.add("Quests",t.Quests,!1),i.state.start("Boot"),i}return __extends(i,e),i}(Phaser.Game);t.GameEngine=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(e,i,n,a,s){void 0===s&&(s=0);var o=t.call(this,e,i,n,"game")||this;o.fallGravity=new Phaser.Point(0,1e3),o.fallHideTime=2e3,o.fallHideTimer=2e3,o.fallRotSpd=0,o.isFalling=!1,o.id=a,o.type=Setting.CELLS[o.id].t,o.phys=Setting.CELLS[o.id].p,o.frameName=o.phys==Setting.PHYS_MOVED?"wooden_block":"iron_block",o.an_id=s;var h=new Phaser.Sprite(o.game,0,0,"game");switch(h.anchor.set(.5),o.addChild(h),o.type){case Setting.T_START:h.frameName="tube_start",h.anchor.set(.38,.5),h.angle=90*o.an_id;break;case Setting.T_END:h.frameName="tube_finish",h.anchor.set(.38,.5),h.angle=90*o.an_id;break;case Setting.T_LINE:h.frameName="tube_horizontal",1!=o.an_id&&3!=o.an_id||(h.angle=90);break;case Setting.T_ANG:h.frameName="tube_turn",h.anchor.set(.24,.24),h.angle=90*o.an_id;break;default:h.visible=!1}return o.scale.set(0),o.game.add.tween(o.scale).to({x:1,y:1},600,Phaser.Easing.Back.Out,!0),o}return __extends(e,t),e.prototype.moveTo=function(t,e){this.game.add.tween(this).to({x:t,y:e},.5,Phaser.Easing.Linear.None,!0),SndMng.playSFX(this.game,"moving")},e.prototype.getJoints=function(){var t=[];switch(this.type){case Setting.T_START:case Setting.T_END:switch(this.an_id){case Setting.ANGLE_ID_90:t.push(Setting.J_B);break;case Setting.ANGLE_ID_180:t.push(Setting.J_L);break;case Setting.ANGLE_ID_270:t.push(Setting.J_T);break;default:t.push(Setting.J_R)}break;case Setting.T_LINE:switch(this.an_id){case Setting.ANGLE_ID_90:case Setting.ANGLE_ID_270:t.push(Setting.J_B,Setting.J_T);break;default:t.push(Setting.J_R,Setting.J_L)}break;case Setting.T_ANG:switch(this.an_id){case Setting.ANGLE_ID_90:t.push(Setting.J_B,Setting.J_L);break;case Setting.ANGLE_ID_180:t.push(Setting.J_L,Setting.J_T);break;case Setting.ANGLE_ID_270:t.push(Setting.J_T,Setting.J_R);break;default:t.push(Setting.J_R,Setting.J_B)}}return t},e.prototype.addStar=function(){if(this.isWithStar=!0,this.star=new Phaser.Sprite(this.game,0,0,"game","star"),this.star.anchor.set(.5),this.id==Setting.C_A_MOVE||this.id==Setting.C_A_STAT){switch(this.an_id){case Setting.ANGLE_ID_0:this.star.anchor.set(.35,.25);break;case Setting.ANGLE_ID_90:this.star.anchor.set(.65,.25);break;case Setting.ANGLE_ID_180:this.star.anchor.set(.65,.75);break;case Setting.ANGLE_ID_270:this.star.anchor.set(.35,.75)}}return this.star},e.prototype.starCollect=function(){this.isWithStar&&this.star&&(this.isWithStar=!1,this.game.add.tween(this.star).to({alpha:0},500).start())},e.prototype.addPresent=function(){return this.isWithPresent||(this.isWithPresent=!0,this.present=new Phaser.Sprite(this.game,0,0,"game","icon_present"),this.present.anchor.set(.5),this.present.scale.set(.6)),this.present},e.prototype.presentCollect=function(){this.isWithPresent&&this.present&&(this.isWithPresent=!1,this.game.add.tween(this.present).to({alpha:0},500).start())},e.prototype.doFalling=function(){this.fallGravity=new Phaser.Point(0,1200),this.fallSpd=new Phaser.Point(MyMath.randomIntInRange(-300,300),MyMath.randomIntInRange(-800,-300)),this.fallHideTime=this.fallHideTimer=2,this.fallRotSpd=MyMath.randomIntInRange(-300,300),this.isFalling=!0},e.prototype.update=function(){var t=this.game.time.elapsed/1e3;if(this.star&&(this.star.x=this.x,this.star.y=this.y),this.present&&(this.present.x=this.x,this.present.y=this.y),this.isFalling){this.fallHideTimer-=t,this.fallSpd.add(this.fallGravity.x*t,this.fallGravity.y*t),this.x+=this.fallSpd.x*t,this.y+=this.fallSpd.y*t,this.angle+=this.fallRotSpd*t,this.fallHideTimer<0&&(this.fallHideTimer=0,this.isFalling=!1);var e=this.fallHideTimer/(this.fallHideTime/2);e>1&&(e=1),e<0&&(e=0),this.alpha=e}},e}(Phaser.Sprite);t.Cell=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=186,i=function(i){function n(e,n,a,s,o){var h=i.call(this,e,n,a)||this;return h.padX=93,h.padY=93,h.field=[],h.fieldW=0,h.fieldH=0,h.turnsCount=0,h.starsCount=0,h.tutorData=[],h.onLevelComplete=new Phaser.Signal,h.onStarGetting=new Phaser.Signal,h.onCellMove=new Phaser.Signal,h.onGiftTaked=new Phaser.Signal,h.dummyCells=new Phaser.Sprite(h.game,0,0),h.addChild(h.dummyCells),h.dummyHint=new Phaser.Sprite(h.game,0,0),h.addChild(h.dummyHint),h.dummyTutor=new Phaser.Sprite(h.game,0,0),h.addChild(h.dummyTutor),h.dummyBall=new Phaser.Sprite(h.game,0,0),h.addChild(h.dummyBall),h.dummyStars=new Phaser.Sprite(h.game,0,0),h.addChild(h.dummyStars),h.dummyEffects=new Phaser.Sprite(h.game,0,0),h.addChild(h.dummyEffects),h.padX=s+93,h.padY=o+93,h.inputEnabled=!0,h.events.onInputDown.add(h.onDown,h),h.events.onInputUp.add(h.onUp,h),h.tutorFrame=new Phaser.Sprite(h.game,100,100,"game","hint-sector"),h.tutorFrame.anchor.set(.5),h.dummyTutor.addChild(h.tutorFrame),h.tutorHand=new Phaser.Sprite(h.game,200,200,"game"),h.tutorHand.anchor.set(.5),h.dummyTutor.addChild(h.tutorHand),h.effMng=new t.EffMng(h.game,0,0),h.dummyEffects.addChild(h.effMng),h}return __extends(n,i),n.prototype.setPad=function(t,e){this.padX=t+93,this.padY=e+93},n.prototype.load=function(i,n,a){this.turnsCount=0,this.starsCount=a,this.movesHistory=[],this.isBallRoll=!1;for(var s=Setting.LEVELS[i-1].data,o=[],h=0;h<s.length;h++){this.field[h]=[];for(var r=0;r<s[h].length;r++){this.field[h][r]=null;var l=s[h][r];if(null!=l&&l.c>=0)(c=new t.Cell(this.game,this.padX+h*e,this.padY+r*e,l.c,null!=l.a?l.a:Setting.ANGLE_ID_0)).anchor.set(.5),this.dummyCells.addChild(c),this.field[h][r]=c,l.isPathCell&&l.c!=Setting.C_START&&l.c!=Setting.C_END&&o.push(c)}}if(n<=o.length)for(h=0;h<n;h++){do{c=o[MyMath.randomIntInRange(0,o.length-1)]}while(o.length>0&&c.isWithStar);o.splice(o.indexOf(c),1);var d=c.addStar();this.dummyStars.addChild(d)}else{LogMng.warn("In level "+String(i)+" cellsForStars < StarsOnField");for(h=0;h<o.length;h++){do{c=o[MyMath.randomIntInRange(0,o.length-1)]}while(o.length>0&&c.isWithStar);o.splice(o.indexOf(c),1);d=c.addStar();this.dummyStars.addChild(d)}}if(3==n)for(h=0;h<o.length;h++){var c;!(c=o[h]).isWithStar&&MyMath.randomInRange(0,100)<=7&&this.dummyStars.addChild(c.addPresent())}this.fieldW=this.field.length,this.fieldH=this.field[0].length,this.ball=new Phaser.Sprite(this.game,0,0,"game","ball"),this.ball.anchor.set(.5),this.updateBall(),this.dummyBall.addChild(this.ball),this.isHintShowed=!1,this.dummyHint.alpha=0;var g=Setting.LEVELS[i-1].path;for(h=0;h<g.length;h++){var u=new Phaser.Sprite(this.game,this.getCellPosX(g[h].x),this.getCellPosY(g[h].y),"game");switch(u.scale.set(1.36),u.anchor.set(.5,.5),g[h].t){case Setting.T_START:case Setting.T_END:switch(u.frameName="hint-end",g[h].a){case Setting.ANGLE_ID_90:u.angle=90;break;case Setting.ANGLE_ID_180:u.angle=180;break;case Setting.ANGLE_ID_270:u.angle=270}break;case Setting.T_ANG:switch(u.frameName="hint-corner",u.anchor.set(.145,.145),g[h].a){case Setting.ANGLE_ID_90:u.angle=90;break;case Setting.ANGLE_ID_180:u.angle=180;break;case Setting.ANGLE_ID_270:u.angle=270}break;case Setting.T_LINE:switch(u.frameName="hint-line",u.anchor.set(.5,.5),g[h].a){case Setting.ANGLE_ID_90:case Setting.ANGLE_ID_270:u.angle=90}break;default:continue}this.dummyHint.addChild(u)}var p=Setting.getTutorForLevel(i-1);this.tutorData=[];for(h=0;h<p.length;h++)this.tutorData.push(p[h]);this.isTutor=this.tutorData.length>0,this.isTutor&&this.updateTutorStep()},n.prototype.showHint=function(){this.isHintShowed=!0,this.dummyHint.alpha=1},n.prototype.clearField=function(){for(;this.dummyCells.children.length>0;)this.dummyCells.removeChild(this.dummyCells.children[0]);for(;this.dummyBall.children.length>0;)this.dummyBall.removeChild(this.dummyBall.children[0]);for(;this.dummyHint.children.length>0;)this.dummyHint.removeChild(this.dummyHint.children[0]);for(;this.dummyStars.children.length>0;)this.dummyStars.removeChild(this.dummyStars.children[0]);this.clearTutor()},n.prototype.getCellPosX=function(t){return this.padX+t*e},n.prototype.getCellPosY=function(t){return this.padY+t*e},n.prototype.getCXByPos=function(t){return Math.round(((t-this.x)/this.scale.x-this.padX)/e)},n.prototype.getCYByPos=function(t){return Math.round(((t-this.y)/this.scale.y-this.padY)/e)},n.prototype.onDown=function(){this.pressedCX=this.getCXByPos(this.input.globalToLocalX(this.game.input.position.x)),this.pressedCY=this.getCYByPos(this.input.globalToLocalY(this.game.input.position.y)),this.pressedCX<0||this.pressedCX>=this.fieldW||this.pressedCY<0||this.pressedCY>=this.fieldH||(this.selCell=this.field[this.pressedCX][this.pressedCY],this.isPressed=!0)},n.prototype.onUp=function(){this.isPressed=!1},n.prototype.isMergeCells=function(t,e,i,n){return!(t<0||t>=this.fieldW||e<0||e>=this.fieldH)&&(!(i<0||i>=this.fieldW||n<0||n>=this.fieldH)&&(t==i&&1==Math.abs(e-n)||e==n&&1==Math.abs(t-i)))},n.prototype.tryMoveCell=function(t,e,i,n){if((!this.isTutor||this.curTutorStep.x1==t&&this.curTutorStep.y1==e&&this.curTutorStep.x2==i&&this.curTutorStep.y2==n)&&!this.isBallRoll&&null==this.field[i][n]&&null!=this.field[t][e]&&this.field[t][e].phys!=Setting.PHYS_STATIC){var a=this.field[t][e];this.field[i][n]=this.field[t][e],this.field[t][e]=null,this.field[i][n].moveTo(this.getCellPosX(i),this.getCellPosY(n)),this.turnsCount++,this.movesHistory.push({x1:t,y1:e,x2:i,y2:n}),this.isTutor&&this.updateTutorStep();this.checkComplete();this.onCellMove.dispatch(a)}},n.prototype.undo=function(){if(!(this.turnsCount<=0||this.movesHistory.length<=0)){var t=this.movesHistory.pop();this.field[t.x1][t.y1]=this.field[t.x2][t.y2],this.field[t.x2][t.y2]=null,this.field[t.x1][t.y1].moveTo(this.getCellPosX(t.x1),this.getCellPosY(t.y1)),this.turnsCount--,this.turnsCount<0&&(this.turnsCount=0),this.updateTutorStep()}},n.prototype.getCellXY=function(t){for(var e,i=0;i<this.fieldW;i++)for(var n=0;n<this.fieldH;n++)if(this.field[i][n]==t)return e=new Phaser.Point(i,n);return e},n.prototype.getNextCell=function(t,e){var i,n=this.getCellXY(t),a=n.x,s=n.y;switch(e){case Setting.J_R:a++;break;case Setting.J_B:s++;break;case Setting.J_L:a--;break;case Setting.J_T:s--}return a>=0&&a<this.fieldW&&s>=0&&s<this.fieldH&&(i=this.field[a][s]),i},n.prototype.doWin=function(t){for(var e=[],i=[],n=0;n<t.length;n++)e.push(t[n].x),i.push(t[n].y);this.twinRoll=this.game.add.tween(this.ball).to({x:e,y:i},500*t.length/4,Phaser.Easing.Linear.None),this.twinRoll.interpolation((function(t,e){return Phaser.Math.catmullRomInterpolation(t,e)})),this.twinRoll.onUpdateCallback(this.onRollProgress,this),this.twinRoll.onComplete.addOnce(this.onFinalRollComplete,this),this.twinRoll.start(),this.isBallRoll=!0,SndMng.isSndEnabled()&&(this.sfxRoll=this.game.add.sound("ball-roll",1,!0).play())},n.prototype.onRollProgress=function(){for(var t=0;t<4;t++)for(var e=0;e<4;e++)this.field[t][e]&&this.ball.position.distance(this.field[t][e].position)<2*this.ball.width&&(this.field[t][e].isWithStar&&(this.field[t][e].starCollect(),this.starsCount++,this.onStarGetting.dispatch(),SndMng.playSFX(this.game,"star-get",.8),this.effMng.doTakeStar(this.getCellPosX(t),this.getCellPosY(e))),this.field[t][e].isWithPresent&&(this.onGiftTaked.dispatch(this.field[t][e]),SndMng.playSFX(this.game,"star-get",.8)));!SndMng.isSndEnabled()&&null!=this.sfxRoll&&this.sfxRoll.isPlaying&&this.sfxRoll.stop()},n.prototype.continueRoll=function(){this.twinRoll&&this.twinRoll.resume()},n.prototype.onFinalRollComplete=function(){this.onLevelComplete.dispatch(),null!=this.sfxRoll&&this.sfxRoll.isPlaying&&this.sfxRoll.stop();for(var t=0;t<4;t++)for(var e=0;e<4;e++)if(this.field[t][e]){for(var i=!1,n=(this.getCellXY(this.field[t][e]),0);n<this.resultPathCells.length;n++)if(this.resultPathCells[n]==this.field[t][e]){i=!0;break}if(i)continue;this.effMng.doCellDrop(this.getCellPosX(t),this.getCellPosY(e),this.field[t][e]),this.field[t][e].visible=!1}this.effMng.doFinalStars(this.ball.x,this.ball.y)},n.prototype.getCellGlobalPos=function(t){var e=new Phaser.Point,i=this.getCellXY(t);return e.x=this.getCellPosX(i.x),e.y=this.getCellPosY(i.y),e},n.prototype.getCellJGlobalPos=function(t,e){var i=this.getCellGlobalPos(t);switch(e){case Setting.J_R:i.x+=93;break;case Setting.J_B:i.y+=93;break;case Setting.J_L:i.x-=93;break;case Setting.J_T:i.y-=93}return i},n.prototype.getCellPathPoints=function(t,i){var n=[],a=this.getCellGlobalPos(t),s=a.clone();if(t.type===Setting.T_ANG)switch(t.an_id){case Setting.ANGLE_ID_0:a.x+=e/7,a.y+=e/7;break;case Setting.ANGLE_ID_90:a.x-=e/7,a.y+=e/7;break;case Setting.ANGLE_ID_180:a.x-=e/7,a.y-=e/7;break;case Setting.ANGLE_ID_270:a.x+=e/7,a.y-=e/7}switch(n.push(a),i){case Setting.J_R:s.x+=93;break;case Setting.J_B:s.y+=93;break;case Setting.J_L:s.x-=93;break;case Setting.J_T:s.y-=93}return n.push(s),n},n.prototype.checkComplete=function(){var t=!1,e=this.getStartCell(),i=0,n=e.getJoints()[0],a=[this.getCellJGlobalPos(e,n)];this.resultPathCells=[e];for(var s=this.getNextCell(e,n);null!=s;){for(var o=!1,h=s.getJoints(),r=0;r<h.length;r++)h[r]==-n&&(o=!0,i=h[r]);if(!o)break;0;for(r=0;r<h.length;r++)h[r]!=i&&(n=h[r]);if(s.type==Setting.T_END){a.push(this.getCellGlobalPos(s)),this.resultPathCells.push(s),this.doWin(a),t=!0;break}var l=this.getCellPathPoints(s,n);this.resultPathCells.push(s);for(r=0;r<l.length;r++)a.push(l[r]);e=s,s=this.getNextCell(e,n)}return t},n.prototype.getStartCell=function(){for(var t=0;t<this.fieldW;t++)for(var e=0;e<this.fieldH;e++)if(null!=this.field[t][e]&&this.field[t][e].type==Setting.T_START)return this.field[t][e]},n.prototype.clearTutor=function(){this.tutorFrame.visible=!1,this.tutorHand.visible=!1,this.curTutorStep=null,null!=this.tutorTween&&(this.tutorTween.stop(),this.tutorTween=null),this.tutorData=[],this.isTutor=this.tutorData.length>0},n.prototype.updateTutorStep=function(){if(null!=this.curTutorStep&&(this.tutorFrame.visible=!1,this.tutorHand.visible=!1),null!=this.tutorTween&&this.tutorTween.stop(),this.isTutor=this.tutorData.length>0,this.isTutor)if(this.curTutorStep=this.tutorData[this.turnsCount],null!=this.curTutorStep){this.curTutorStep.y1>this.curTutorStep.y2?this.tutorHand.frameName="hint-totop":this.curTutorStep.x1<this.curTutorStep.x2?this.tutorHand.frameName="hint-tor":this.curTutorStep.y1<this.curTutorStep.y2?this.tutorHand.frameName="hint-tobop":this.tutorHand.frameName="hint-toleft",this.tutorHand.position.set(this.getCellPosX(this.curTutorStep.x1),this.getCellPosY(this.curTutorStep.y1));var t=this.getCellPosX(this.curTutorStep.x2),e=this.getCellPosX(this.curTutorStep.y2);this.tutorTween=this.game.add.tween(this.tutorHand).to({x:t,y:e},1500,Phaser.Easing.Back.InOut,!0,0,-1),this.tutorFrame.position.set(t,e),this.tutorFrame.visible=!0,this.tutorHand.visible=!0}else this.isTutor=!1},n.prototype.updateBall=function(){if(this.isBallRoll);else{var t=this.getStartCell();this.ball.x=t.x,this.ball.y=t.y}},n.prototype.update=function(){for(var t=0;t<this.fieldW;t++)for(var e=0;e<this.fieldH;e++)null!=this.field[t][e]&&this.field[t][e].update();if(this.isPressed){var i=this.getCXByPos(this.input.globalToLocalX(this.game.input.position.x)),n=this.getCYByPos(this.input.globalToLocalY(this.game.input.position.y));(i<0||i>=this.fieldW||n<0||n>=this.fieldH)&&(this.isPressed=!1),this.isMergeCells(this.pressedCX,this.pressedCY,i,n)&&(this.tryMoveCell(this.pressedCX,this.pressedCY,i,n),this.isPressed=!1)}this.effMng.update()},n}(Phaser.Sprite);t.FieldMng=i}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.preload=function(){this.load.atlasJSONArray("preloader","./assets/atlases/v3preloader.png","./assets/atlases/v3preloader.json"),this.load.json("settings","./data/settings.json"),this.load.json("localization","./data/localization.json")},e.prototype.create=function(){this.stage.setBackgroundColor(2636132),LogMng.setMode(LogMng.MODE_RELEASE),LangMng.init(this.game,"localization"),LangMng.setLang(SG.lang),this.input.maxPointers=1,ScaleManager.gw=Config.GW,ScaleManager.gh=Config.GH,ScaleManager.gsw=Config.GWS,ScaleManager.gsh=Config.GHS,ScaleManager.init(this.game),SGHooksMng.setOrientationHandler(GameData.orientationChanged),SGHooksMng.setResizeHandler(GameData.resized),SGHooksMng.setPauseHandler(GameData.setGamePaused),SGHooksMng.setUnpauseHandler(GameData.setGameUnpaused),this.game.plugins.add(PhaserNineSlice.Plugin),this.game.state.start("Preloader",!0,!1)},e}(Phaser.State);t.Boot=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.btns=[],t.curTurnsCnt=0,t.bestTurnsCnt=0,t.starsCnt=0,t.starsTaken=0,t.currHintsCnt=0,t.moneyTexts=[],t.loadedLevelAbsId=0,t.moveCntText="",t.targetCntText="",t}return __extends(i,e),i.prototype.create=function(){this.topPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","top_bar",800,300,{top:0,bottom:15,left:0,right:0}),this.topPanel.inputEnabled=!0,this.topPanel.anchor.set(.5,0),this.add.existing(this.topPanel),this.difTitle=new t.LevelDifTitle(this.game,0,0),this.difTitle.setTitleText(LangMng.getText(LangMng.MENU_SECTIONS,"sec_title_"+String(GameData.currentDif+1))),this.add.existing(this.difTitle),this.movesFrame=new t.MoveFrame(this.game,0,0),this.movesFrame.setMovesCnt(0),this.add.existing(this.movesFrame),this.starsPanel=new t.StarsPanel(this.game,0,0),this.add.existing(this.starsPanel),this.levelFrame=new t.LevelFrame(this.game,0,0),this.levelFrame.setLevelNum(GameData.currentLevel+1),this.add.existing(this.levelFrame),this.btnPause=new t.SimpleButton(this.game,this.topPanel.width-40,50,"game",this.onPauseClick,this,"pause_btn","pause_btn"),this.btnPause.anchor.set(.5),this.add.existing(this.btnPause),this.field_bg=new PhaserNineSlice.NineSlice(this.game,0,0,"game","field_bg",770,770,{top:90,bottom:90,left:90,right:90}),this.add.existing(this.field_bg),this.botPanel=new PhaserNineSlice.NineSlice(this.game,0,0,"game","down_bar",800,180,{top:5,bottom:2,left:0,right:0}),this.botPanel.inputEnabled=!0,this.add.existing(this.botPanel),this.botPanel.anchor.set(.5,0),this.btns=[],this.btnBack=new t.BtnWithText(this.game,0,0,"game","back_btn",this.onBackClick,this),this.btnBack.setBtnText(LangMng.getBmpText(this.game,LangMng.MENU_GAME,"btn_back",0,0)),this.add.existing(this.btnBack),this.btns.push(this.btnBack),this.btnRestart=new t.BtnWithText(this.game,0,0,"game","restart_btn",this.onRestartClick,this),this.btnRestart.setBtnText(LangMng.getBmpText(this.game,LangMng.MENU_GAME,"btn_replay",0,0)),this.add.existing(this.btnRestart),this.btns.push(this.btnRestart),this.btnHint=new t.BtnWithText(this.game,0,0,"game","hint_btn",this.onHintClick,this),this.btnHint.setBtnText(LangMng.getBmpText(this.game,LangMng.MENU_GAME,"btn_hint",0,0)),this.add.existing(this.btnHint),this.btns.push(this.btnHint),this.btnUndo=new t.BtnWithText(this.game,0,0,"game","undo_btn",this.onUndoClick,this),this.btnUndo.setBtnText(LangMng.getBmpText(this.game,LangMng.MENU_GAME,"btn_undo",0,0)),this.add.existing(this.btnUndo),this.btns.push(this.btnUndo),this.starsCnt=GameData.getLevelStarsCount(GameData.currentDif,GameData.currentLevel),this.updateStarsVisual(),this.field=new t.FieldMng(this.game,this.field_bg.x+26,this.field_bg.y+26,0,0),this.field.scale.set(.94),this.field.onLevelComplete.add(this.onLevelComplete,this),this.field.onStarGetting.add(this.onStarGetting,this),this.field.onGiftTaked.add(this.onGiftTaked,this),this.add.existing(this.field),this.loadLevel(),this.blackBack=new Phaser.Graphics(this.game),this.blackBack.beginFill(0,.2),this.blackBack.drawRect(0,0,Math.max(Config.GW,Config.GH),Math.max(Config.GW,Config.GH)),this.blackBack.endFill(),this.blackBack.inputEnabled=!0,this.blackBack.visible=!1,this.add.existing(this.blackBack),this.shopWnd=new t.ShopWnd(this.game,0,0),this.shopWnd.visible=!1,this.add.existing(this.shopWnd),this.escMenu=new t.EscMenu(this.game,this.world.centerX,this.world.centerY),this.escMenu.visible=!1,this.escMenu.onHomeClickSignal.add(this.onEscMenuHomeClick,this),this.escMenu.onLevelsClickSignal.add(this.onBackClick,this),this.add.existing(this.escMenu),ScaleManager.onOrientationChangeSignal.add(this.onOrientationChange,this),this.onOrientationChange()},i.prototype.onOrientationChange=function(){ScaleManager.isPortrait?(this.topPanel.width=800,this.topPanel.height=300,this.topPanel.x=this.game.world.centerX,this.topPanel.y=0,this.botPanel.scale.set(1),this.botPanel.width=800,this.botPanel.x=this.game.world.centerX,this.botPanel.y=this.game.world.height-this.botPanel.height):(this.topPanel.width=300,this.topPanel.height=this.game.world.height,this.topPanel.x=200,this.topPanel.y=0,this.botPanel.scale.set(.65),this.botPanel.width=672,this.botPanel.x=this.game.world.width/2+108-30,this.botPanel.y=this.game.world.height-this.botPanel.height),null!=this.blackBack&&(this.blackBack.clear(),this.blackBack.beginFill(0,.2),this.blackBack.drawRect(0,0,this.game.world.width,this.game.world.height),this.blackBack.endFill()),this.starsPanel.position.set((ScaleManager.isPortrait,this.topPanel.x),ScaleManager.isPortrait?210:160),this.starsPanel.scale.set(ScaleManager.isPortrait?1:.75),this.difTitle.position.set((ScaleManager.isPortrait,this.topPanel.x),ScaleManager.isPortrait?80:50),this.difTitle.scale.set(ScaleManager.isPortrait?1:.8),this.movesFrame.position.set(ScaleManager.isPortrait?this.topPanel.x-280:this.topPanel.x,ScaleManager.isPortrait?46:230),this.levelFrame.position.set(ScaleManager.isPortrait?this.topPanel.x+280:this.topPanel.x,ScaleManager.isPortrait?141:460),this.btnPause.position.set(ScaleManager.isPortrait?this.topPanel.x+310:this.topPanel.x,ScaleManager.isPortrait?90:660),this.field_bg.position.set(ScaleManager.isPortrait?12:this.topPanel.x+this.topPanel.width/2+30,ScaleManager.isPortrait?this.topPanel.y+this.topPanel.height+8:0),this.field_bg.scale.set(ScaleManager.isPortrait?1:.88),this.field.scale.set(ScaleManager.isPortrait?.96:.969*this.field_bg.scale.x),this.field.x=this.field_bg.x+(ScaleManager.isPortrait?28:22),this.field.y=this.field_bg.y+(ScaleManager.isPortrait?30:22);for(var t=0;t<this.btns.length;t++)this.btns[t].position.set(ScaleManager.isPortrait?100+200*t:460+170*t,ScaleManager.isPortrait?1220:760),this.btns[t].scale.set(ScaleManager.isPortrait?1:.65);this.escMenu&&this.escMenu.position.set(this.world.centerX,this.world.centerY),null!=this.winWnd&&this.winWnd.position.set(ScaleManager.isPortrait?this.world.centerX:this.world.centerX+80,0),this.updateStarsVisual()},i.prototype.onCellMove=function(t){},i.prototype.onGiftTaked=function(t){if(t.isWithPresent){t.presentCollect();var e=10*MyMath.randomIntInRange(1,2);GameData.changeMoney(e);var i=new Phaser.Sprite(this.game,this.field.x+t.x*this.field.scale.x,this.field.y+t.y*this.field.scale.y),n=new Phaser.BitmapText(this.game,0,0,LangMng.FONT_WH_BR_OUT,"+"+e.toString(),60);n.anchor.set(1,.5),i.addChild(n);var a=new Phaser.Sprite(this.game,0,0,"game","icon_coin");a.scale.set(.6),a.anchor.set(0,.5),i.addChild(a),i.alpha=.02,this.game.add.tween(i).to({alpha:1},200,Phaser.Easing.Linear.None,!0),this.game.add.tween(i).to({y:i.y-50},500,Phaser.Easing.Circular.Out,!0),this.game.add.tween(i).to({alpha:0},200,Phaser.Easing.Linear.None,!0,800),this.moneyTexts.push(i),this.add.existing(i)}},i.prototype.onRewWndClose=function(){this.field.isBallRoll&&this.field.continueRoll()},i.prototype.onEscMenuHomeClick=function(){SGHooksMng.levelFinished(this.loadedLevelAbsId+1,0),SG_Hooks.mainMusic.volume=0,SG_Hooks.gameOver(this.loadedLevelAbsId+1,0,(function(){SG_Hooks.mainMusic.volume=1})),SG_Hooks.triggerMidrollAd((()=>{this.game.state.start("MainMenu",!0,!1)}))},i.prototype.loadLevel=function(){this.levelFrame.setLevelNum(GameData.currentLevel+1),this.starsCnt=GameData.getLevelStarsCount(GameData.currentDif,GameData.currentLevel),this.starsTaken=0,this.levelWasComplete=this.starsCnt>0,this.updateStarsVisual(),this.field.clearField(),this.loadedLevelAbsId=Setting.getLevelAbsId(GameData.currentDif,GameData.currentLevel),this.field.load(this.loadedLevelAbsId+1,3-this.starsCnt,this.starsCnt);var t=GameData.getBestTurnsCount(GameData.currentDif,GameData.currentLevel);if((!t||t<=0)&&(t=1e5),Setting.LEVELS[this.loadedLevelAbsId].isSimple)t<100?(this.bestTurnsCnt=t,this.movesFrame.showBest()):this.movesFrame.hideBest();else{var e=GameData.getLevelTargetTurns(GameData.currentDif,GameData.currentLevel);this.bestTurnsCnt=Math.min(t,e),this.movesFrame.showBest()}this.movesFrame.setBestCnt(this.bestTurnsCnt),this.onOrientationChange(),this.updateHintsText(),SGHooksMng.levelStarted(this.loadedLevelAbsId+1)},i.prototype.onStarGetting=function(){this.starsCnt=this.field.starsCount,this.starsTaken++,this.updateStarsVisual(),GameData.addQuestValue(GameData.Q_ROCK_STAR,1)},i.prototype.updateStarsVisual=function(){this.starsPanel.setStarsCount(this.starsCnt)},i.prototype.onLevelComplete=function(){var e=this.bestTurnsCnt;this.starsCnt=this.field.starsCount,LogMng.debug("onLevelComplete(): starsTotal = "+this.starsCnt),LogMng.debug("onLevelComplete(): starsTaken = "+this.starsTaken);var i=Math.round(getAwardScores(this.starsCnt,this.starsTaken,this.field.turnsCount,e)),n=Math.round(getAwardMoney(this.starsCnt,this.starsTaken,this.field.turnsCount,e)),a=this.game.cache.getJSON("settings").awards,s=a.maxTurnsPerc,o=a.maxAwardPerc,h=a.midTurnsPerc,r=a.midAwardPerc,l=a.minAwardPerc;this.field.turnsCount<=e*s/100?n*=o/100:this.field.turnsCount<=e*h/100?n*=r/100:n*=l/100,n<0&&(n=0),this.curWinMoney=n,this.curWinScores=i,GameData.changeMoney(n);var d=GameData.getBestTurnsCount(GameData.currentDif,GameData.currentLevel);(!d||d<=0)&&(d=1e5),this.field.turnsCount>0&&this.field.turnsCount<d&&GameData.setLevelBestTurnsCount(GameData.currentDif,GameData.currentLevel,this.field.turnsCount),this.starsCnt>GameData.getLevelStarsCount(GameData.currentDif,GameData.currentLevel)&&GameData.setLevelStarsCount(GameData.currentDif,GameData.currentLevel,this.starsCnt),this.winWnd=new t.WinWindow(this.game,ScaleManager.isPortrait?this.world.centerX:this.world.centerX+80,0,i,this.curWinMoney,this.starsCnt,this.starsTaken),this.winWnd.onCloseClick.addOnce(this.onWinWndCloseClick,this),this.winWnd.onAdWatched.addOnce(this.onWinWndAdWatched,this),this.winWnd.onNextClick.addOnce(this.onWinWndNextClick,this),this.game.time.events.add(800,this.onWinWndShowTime,this),GameData.getStarsCntInDif(GameData.currentDif)==3*Setting.LEVELS_IN_DIF_CNT&&GameData.isDifLocked(GameData.currentDif+1)&&GameData.setDifLocked(GameData.currentDif+1,!1),GameData.currentLevel==Setting.LEVELS_IN_DIF_CNT-1&&(this.levelWasComplete||GameData.addQuestValue(GameData.Q_MASTER,GameData.currentDif+1)),SndMng.playSFX(this.game,"level-complete"),this.field.turnsCount<=GameData.QUESTS[GameData.Q_CLEAR_N_IN_T].mission2&&GameData.addQuestValue(GameData.Q_CLEAR_N_IN_T,1),this.field.turnsCount<this.bestTurnsCnt&&GameData.setLevelBestTurnsCount(GameData.currentDif,GameData.currentLevel,this.field.turnsCount),SGHooksMng.levelFinished(this.loadedLevelAbsId+1,i)},i.prototype.onWinWndShowTime=function(){this.winWnd.alpha=0,this.winWnd.visible=!0,this.game.add.tween(this.winWnd).to({alpha:1},500).start(),this.add.existing(this.winWnd)},i.prototype.onWinWndCloseClick=function(){SG_Hooks.mainMusic.volume=0,SG_Hooks.gameOver(this.loadedLevelAbsId+1,0,(function(){SG_Hooks.mainMusic.volume=1})),this.game.state.start("LevelSelect",!0,!1)},i.prototype.onWinWndAdWatched=function(){GameData.changeMoney(this.curWinMoney),this.winWnd&&this.winWnd.setMoney(2*this.curWinMoney)},i.prototype.onWinWndNextClick=function(){SG_Hooks.mainMusic.volume=0,SG_Hooks.levelUp(this.loadedLevelAbsId+1,this.curWinScores,(function(){SG_Hooks.mainMusic.volume=1})),GameData.currentLevel>=Setting.LEVELS_IN_DIF_CNT-1?this.game.state.start("LevelSelect",!0,!1):(this.winWnd.visible=!1,null!=this.winWnd.parent&&this.winWnd.parent.removeChild(this.winWnd),GameData.currentLevel++,this.loadLevel())},i.prototype.hideScreen=function(t){null!=t&&t.apply(this)},i.prototype.unhide=function(){},i.prototype.onUnhideComplete=function(){},i.prototype.onBackClick=function(){this.field.isBallRoll||(SGHooksMng.levelFinished(this.loadedLevelAbsId+1,0),SG_Hooks.mainMusic.volume=0,SG_Hooks.gameOver(this.loadedLevelAbsId+1,0,(function(){SG_Hooks.mainMusic.volume=1})),SG_Hooks.triggerMidrollAd((()=>{this.game.state.start("LevelSelect",!0,!1)})))},i.prototype.onUndoClick=function(){this.field.isBallRoll||this.field.undo()},i.prototype.onRestartClick=function(){this.field.isBallRoll||(SGHooksMng.levelFinished(this.loadedLevelAbsId+1,0),SG_Hooks.mainMusic.volume=0,SG_Hooks.gameOver(this.loadedLevelAbsId+1,0,(function(){SG_Hooks.mainMusic.volume=1})),SG_Hooks.triggerMidrollAd((()=>{this.loadLevel()})))},i.prototype.onHintClick=function(){if(!this.field.isBallRoll){if(GameData.getHints()<=0)return this.shopWnd.updateMoney(),void(this.shopWnd.visible=!0);this.field.isHintShowed||(GameData.changeHintsCnt(-1),this.field.showHint(),GameData.addQuestValue(GameData.Q_FIND_ANS,1))}},i.prototype.onSoundClick=function(){SndMng.switchSoundEnabled(this.game)},i.prototype.onPauseClick=function(){this.field.isBallRoll||GuiUtils.showPopupWindow(this.game,this.escMenu,new Phaser.Point(this.escMenu.x,-500),new Phaser.Point(this.world.centerX,this.world.centerY))},i.prototype.updateHintsText=function(){this.btnHint.setText(LangMng.getText(LangMng.MENU_GAME,"btn_hint")+" ("+String(this.currHintsCnt)+")")},i.prototype.update=function(){null!=this.field&&this.curTurnsCnt!=this.field.turnsCount&&(this.curTurnsCnt=this.field.turnsCount,this.movesFrame.setMovesCnt(this.curTurnsCnt)),this.btnUndo.alpha=this.field.turnsCount>0?1:.6,this.blackBack.visible=this.escMenu.visible||this.shopWnd.visible;for(var t=this.moneyTexts.length-1;t>=0;t--)this.moneyTexts[t].alpha<=0&&(null!=this.moneyTexts[t].parent&&this.moneyTexts[t].parent.removeChild(this.moneyTexts[t]),this.moneyTexts.splice(t,1));var e=GameData.getHints();this.currHintsCnt!=e&&(this.currHintsCnt=e,this.updateHintsText()),this.shopWnd.update()},i}(Phaser.State);t.GameProc=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.guiParams=[],t.blickTimer=0,t.shopWasOpened=!1,t}return __extends(i,e),i.prototype.create=function(){this.updateBackColor(!0),this.cl1=this.add.sprite(0,570,"preloader","left_cloud"),this.cl2=this.add.sprite(this.world.width,570,"preloader","right_cloud"),this.logo=new Phaser.Sprite(this.game,this.world.centerX,280,"preloader","freetheball_logo"),this.logo.anchor.set(.5),this.add.existing(this.logo),this.btnPlay=new t.SimpleButton(this.game,this.world.centerX,550,"game",this.onPlayClick,this,"green_btn","green_btn"),this.btnPlay.anchor.set(.5),this.btnPlay.play("idle");var e=LangMng.getBmpText(this.game,LangMng.MENU_MAINMENU,"btn_play",0,0);e.anchor.set(.5),this.btnPlay.addChild(e),this.add.existing(this.btnPlay),this.blickTimer=5,this.stars=new t.StarsCounter(this.game,120,30),this.stars.scale.set(.9),this.stars.anchor.set(.5,0),this.add.existing(this.stars),this.dummyMoney=new Phaser.Sprite(this.game,0,0),this.add.existing(this.dummyMoney);var i=new Phaser.Sprite(this.game,-8,2,"game","shit01");i.anchor.set(.5),this.dummyMoney.addChild(i),this.tfMoney=new Phaser.BitmapText(this.game,0,0,LangMng.FONT_WH_BL_SW,String(GameData.getMoney()),70),this.tfMoney.anchor.set(.5),this.dummyMoney.addChild(this.tfMoney),this.iconMoney=new Phaser.Sprite(this.game,this.tfMoney.x-this.tfMoney.width/2,this.tfMoney.y,"game","icon_coin"),this.iconMoney.anchor.set(1,.5),this.dummyMoney.addChild(this.iconMoney),this.btnMoneyPlus=new t.SimpleButton(this.game,this.tfMoney.x+this.tfMoney.width/2,this.tfMoney.y,"game",this.onMoneyPlusClick,this,"plus_btn","plus_btn"),this.btnMoneyPlus.anchor.set(0,.5),this.btnMoneyPlus.visible=SGHooksMng.isEnabledIncentiviseButton(),this.dummyMoney.addChild(this.btnMoneyPlus),i.width=this.btnMoneyPlus.x-this.iconMoney.x+90,this.btnQuests=new t.SimpleButton(this.game,this.world.centerX,750,"game",this.onQuestsClick,this,"orange_btn","orange_btn"),this.btnQuests.anchor.set(.5);var n=LangMng.getBmpText(this.game,LangMng.MENU_MAINMENU,"btn_quests",0,0);n.anchor.set(.5),this.btnQuests.addChild(n);var a=new Phaser.Sprite(this.game,-this.btnQuests.width/2+2,0,"game","icon_achieve");a.anchor.set(0,.5),a.scale.set(.5),this.btnQuests.addChild(a),a.x=-(n.width+a.width+10)/2,n.x=a.x+a.width+n.width/2+10,this.add.existing(this.btnQuests),this.qAlert=new Phaser.Sprite(this.game,this.btnQuests.x+this.btnQuests.width/2,this.btnQuests.y-this.btnQuests.height/2+10,"game","icon_new"),this.qAlert.anchor.set(.5),this.qAlert.visible=GameData.getCompleteQuestsCount()>0,this.add.existing(this.qAlert),this.btnPres=new t.SimpleButton(this.game,this.world.centerX,860,"game",this.onPresClick,this,"violet_btn","violet_btn"),this.btnPres.anchor.set(.5);var s=LangMng.getBmpText(this.game,LangMng.MENU_MAINMENU,"btn_gifts",0,0);s.anchor.set(.5),this.btnPres.addChild(s);var o=new Phaser.Sprite(this.game,-s.width/2-30,-4,"game","icon_present");o.anchor.set(0,.5),o.scale.set(.46),this.btnPres.addChild(o),o.x=-(s.width+o.width+10)/2,s.x=o.x+o.width+s.width/2+10,this.add.existing(this.btnPres),this.pAlert=new Phaser.Sprite(this.game,this.btnPres.x+this.btnPres.width/2,this.btnPres.y-this.btnPres.height/2+10,"game","icon_new"),this.pAlert.anchor.set(.5),this.pAlert.visible=GameData.getPresentCnt()>0,this.add.existing(this.pAlert),this.btnSnd=new t.SimpleButton(this.game,190,170,"game",this.onSndClick,this,"circlebutton_SOUNDON","circlebutton_SOUNDON"),this.btnSnd.anchor.set(.5),this.updateSndBtn(),this.add.existing(this.btnSnd),this.btnShop=new t.SimpleButton(this.game,0,0,"game",this.onMarketClick,this,"circlebutton_SHOPPING","circlebutton_SHOPPING"),this.btnShop.anchor.set(.5),this.add.existing(this.btnShop),this.blackBack=new Phaser.Graphics(this.game),this.blackBack.beginFill(0,.2),this.blackBack.drawRect(0,0,Math.max(Config.GW,Config.GH),Math.max(Config.GW,Config.GH)),this.blackBack.endFill(),this.blackBack.inputEnabled=!0,this.blackBack.visible=!1,this.add.existing(this.blackBack),this.shopWnd=new t.ShopWnd(this.game,0,0),this.shopWnd.visible=!1,this.add.existing(this.shopWnd),this.getMoneyWnd=new t.GetMoneyWindow(this.game,0,0),this.getMoneyWnd.visible=!1,this.getMoneyWnd.onAllVideosWatched.add(this.onAllVideosWatched,this),this.getMoneyWnd.onMoneyChangedSignal.add(this.onNeedMoneyChangedSignal,this),this.add.existing(this.getMoneyWnd),this.watchedWnd=new t.AllWatched(this.game,0,0),this.watchedWnd.visible=!1,this.add.existing(this.watchedWnd),this.updateMoneyText(),ScaleManager.onOrientationChangeSignal.add(this.onOrientationChange,this),ScaleManager.onSizeChangeSignal.add(this.onSizeChange,this),this.onSizeChange(),this.onOrientationChange(),SndMng.playMainMusic(this.game,1,!0,!1)},i.prototype.onSndClick=function(){SndMng.switchSoundEnabled(this.game),this.updateSndBtn()},i.prototype.onMoreClick=function(){},i.prototype.updateSndBtn=function(){var t=SndMng.isSndEnabled()?"circlebutton_SOUNDON":"circlebutton_SOUNDOFF";this.btnSnd.setFrames(t,t)},i.prototype.updateBackColor=function(t){var e=document.getElementsByTagName("body")[0];t?(e.style.background="linear-gradient(#104B78, #348DE9)",e.style.backgroundSize=window.innerWidth+"px "+window.innerHeight+"px"):e.style.background="#283964"},i.prototype.onSizeChange=function(){this.updateBackColor(!this.shopWnd.visible)},i.prototype.onOrientationChange=function(){try{ScaleManager.isPortrait?(this.logo.position.set(this.world.centerX,320),this.btnPlay.position.set(this.world.centerX,this.logo.y+360),this.btnQuests.position.set(this.world.centerX,this.btnPlay.y+150),this.btnPres.position.set(this.world.centerX,this.btnQuests.y+150),this.btnSnd.position.set(this.world.centerX-150,this.btnPres.y+180),this.btnShop.position.set(this.world.centerX+150,this.btnPres.y+180)):(this.logo.position.set(this.world.centerX,100),this.btnPlay.position.set(this.world.centerX,this.logo.y+260),this.btnQuests.position.set(this.world.centerX,this.btnPlay.y+120),this.btnPres.position.set(this.world.centerX,this.btnQuests.y+120),this.btnSnd.position.set(this.world.centerX-150,this.btnPres.y+130),this.btnShop.position.set(this.world.centerX+150,this.btnSnd.y)),this.cl1.position.set(-50,this.world.height-this.cl1.height+90),this.cl2.position.set(this.world.width-this.cl2.width+50,this.world.height-this.cl2.height+60),this.qAlert.x=this.btnQuests.x+this.btnQuests.width/2,this.qAlert.y=this.btnQuests.y-this.btnQuests.height/2+10,this.qAlert.visible=GameData.getCompleteQuestsCount()>0,this.pAlert.x=this.btnPres.x+this.btnPres.width/2,this.pAlert.y=this.btnPres.y-this.btnPres.height/2+10,this.pAlert.visible=GameData.getPresentCnt()>0,this.dummyMoney.x=this.game.world.width-100-this.tfMoney.width/2,this.dummyMoney.y=80,this.getMoneyWnd.visible&&this.getMoneyWnd.position.set(this.world.centerX,this.world.centerY),this.watchedWnd.visible&&this.watchedWnd.position.set(this.world.centerX,this.world.centerY)}catch(t){}},i.prototype.onQuestsClick=function(){GlobalVars.questExitMenu="MainMenu",this.updateBackColor(!1),this.game.state.start("Quests",!0,!1)},i.prototype.onMarketClick=function(){this.updateBackColor(!1),this.shopWnd.updateMoney(),this.shopWnd.visible=!0,this.shopWasOpened=!0},i.prototype.onPlayClick=function(){this.updateBackColor(!1),this.game.state.start("DifSelect",!0,!1)},i.prototype.onLevelsClick=function(){this.updateBackColor(!1),this.game.state.start("DifSelect",!0,!1)},i.prototype.onPresClick=function(){this.updateBackColor(!1),this.game.state.start("Rulet",!0,!1)},i.prototype.startGame=function(){this.updateBackColor(!1),this.game.state.start("GameProc",!0,!1)},i.prototype.onAllVideosWatched=function(){GuiUtils.showPopupWindow(this.game,this.watchedWnd,new Phaser.Point(this.world.centerX,-500),new Phaser.Point(this.world.centerX,this.world.centerY))},i.prototype.onMoneyPlusClick=function(){this.getMoneyWnd.showBtn(),this.getMoneyWnd.updateEvents(),GuiUtils.showPopupWindow(this.game,this.getMoneyWnd,new Phaser.Point(this.world.centerX,-500),new Phaser.Point(this.world.centerX,this.world.centerY))},i.prototype.refreshMoney=function(){this.tfMoney.text=String(GameData.getMoney())},i.prototype.onNeedMoneyChangedSignal=function(){this.refreshMoney()},i.prototype.updateMoneyText=function(){this.tfMoney.text=String(GameData.getMoney()),this.iconMoney.position.set(this.tfMoney.x-this.tfMoney.width/2,this.tfMoney.y+8),this.btnMoneyPlus.position.set(this.tfMoney.x+this.tfMoney.width/2,this.tfMoney.y+4)},i.prototype.update=function(){var t=this.game.time.elapsed/1e3;this.blickTimer-=t,this.blickTimer<=0&&(this.btnPlay.play("idle"),this.blickTimer=5),this.getMoneyWnd.visible||this.watchedWnd.visible||this.shopWnd.visible?(this.blackBack.visible||(this.blackBack.alpha=0,this.blackBack.visible=!0),this.blackBack.alpha<1&&(this.blackBack.alpha+=4*t)):(this.blackBack.alpha>0&&(this.blackBack.alpha-=4*t),this.blackBack.visible&&this.blackBack.alpha<=0&&(this.blackBack.visible=!1)),this.shopWnd.visible?this.updateMoneyText():this.shopWasOpened&&(this.shopWasOpened=!1,this.updateBackColor(!0))},i}(Phaser.State);t.MainMenu=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){!function(t){var e=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.preload=function(){this.bg=new PhaserNineSlice.NineSlice(this.game,0,0,"preloader","mainscreen_gradient",ScaleManager.isPortrait?Config.GW:Config.GH,ScaleManager.isPortrait?Config.GH:Config.GW,{top:0,bottom:0,left:1,right:1}),this.bg.alpha=0,this.game.add.existing(this.bg),this.logo=this.add.sprite(this.world.centerX+10,250,"preloader","freetheball_logo"),this.logo.anchor.set(.5),this.sglogo=this.add.sprite(this.world.centerX,490,"preloader","SG_logo"),this.sglogo.anchor.set(.5),this.cl1=this.add.sprite(0,570,"preloader","left_cloud"),this.cl2=this.add.sprite(this.world.width,570,"preloader","right_cloud"),this.dummyBar=this.add.sprite(this.world.centerX,570),this.dummyTap=this.add.sprite(0,0),this.sglogo.visible=this.dummyBar.visible=this.logo.visible=!1;var t=new Phaser.Sprite(this.game,0,0,"preloader","progressbar_empty");t.x-=t.width/2,this.dummyBar.addChild(t);var e=new Phaser.Sprite(this.game,t.x,t.y,"preloader","progressbar");this.dummyBar.addChild(e),this.load.setPreloadSprite(e),this.load.onFileComplete.add((t=>{SG_Hooks.loadProgress(t)})),ScaleManager.onSizeChangeSignal.add(this.onSizeChange,this),this.onSizeChange(),ScaleManager.onOrientationChangeSignal.add(this.onOrientationChange,this),this.onOrientationChange(),this.load.atlasJSONArray("game","./assets/atlases/v3game.png","./assets/atlases/v3game.json"),this.load.json("levels","./data/levels.json"),this.load.json("tutors","./data/tutors.json"),this.load.json("quests","./data/quests.json");LangMng.getLang();this.load.bitmapFont(LangMng.FONT_WHITE,"./assets/fonts/common/white.png","./assets/fonts/common/white.xml"),this.load.bitmapFont(LangMng.FONT_BROWN,"./assets/fonts/common/brown.png","./assets/fonts/common/brown.xml"),this.load.bitmapFont(LangMng.FONT_GOLD_GRAD,"./assets/fonts/common/GoldGradient.png","./assets/fonts/common/GoldGradient.xml"),this.load.bitmapFont(LangMng.FONT_GREEN,"./assets/fonts/common/green.png","./assets/fonts/common/green.xml"),this.load.bitmapFont(LangMng.FONT_ORANGE,"./assets/fonts/common/Orange.png","./assets/fonts/common/Orange.xml"),this.load.bitmapFont(LangMng.FONT_PURPLE,"./assets/fonts/common/Purple.png","./assets/fonts/common/Purple.xml"),this.load.bitmapFont(LangMng.FONT_WH_BL_SW,"./assets/fonts/common/white_blackShadow.png","./assets/fonts/common/white_blackShadow.xml"),this.load.bitmapFont(LangMng.FONT_WH_BR_OUT,"./assets/fonts/common/white_BrownOutline.png","./assets/fonts/common/white_BrownOutline.xml"),this.load.bitmapFont(LangMng.FONT_WH_BR_SW,"./assets/fonts/common/white_brownShadow.png","./assets/fonts/common/white_brownShadow.xml"),this.isIOS=this.game.device.iOS||this.game.device.mobileSafari||this.game.device.iPhone||this.game.device.iPad;for(var i=["ball-roll","level-complete","melody","moving","star-get"],n=0;n<i.length;n++){var a="./assets/sounds/ogg/"+i[n]+".ogg",s="./assets/sounds/mp3/"+i[n]+".mp3",o="./assets/sounds/m4a/"+i[n]+".m4a";this.load.audio(i[n],[a,s,o])}},e.prototype.updateBackColor=function(t){var e=document.getElementsByTagName("body")[0];t?(e.style.background="linear-gradient(#104B78, #348DE9)",e.style.backgroundSize=window.innerWidth+"px "+window.innerHeight+"px"):e.style.background="#283964"},e.prototype.onSizeChange=function(){this.updateBackColor(!0)},e.prototype.onOrientationChange=function(){ScaleManager.isPortrait?(this.bg.width=Config.GW,this.bg.height=Config.GH,this.logo.position.set(this.world.centerX,350),this.sglogo.position.set(this.world.centerX,740),this.dummyBar.position.set(this.world.centerX,960),null!=this.tfTap&&this.tfTap.position.set(this.world.centerX,960)):(this.bg.width=Config.GH,this.bg.height=Config.GW,this.logo.position.set(this.world.centerX,200),this.sglogo.position.set(this.world.centerX,500),this.dummyBar.position.set(this.world.centerX,650),null!=this.tfTap&&this.tfTap.position.set(this.world.centerX,650)),this.cl1.position.set(0,this.world.height-this.cl1.height+90),this.cl2.position.set(this.world.width-this.cl2.width,this.world.height-this.cl2.height+60)},e.prototype.create=function(){this.initGame()},e.prototype.initGame=function(){SG_addListeners((()=>{this.game&&(this.game.sound.mute=!0,this.game.paused=!0)}),(()=>{this.game&&(this.game.sound.mute=!1,this.game.paused=!1)})),GameData.init(),Setting.SHOP_ITEMS=this.game.cache.getJSON("settings").shop,Setting.LEVELS=this.game.cache.getJSON("levels"),Setting.TUTORS=this.game.cache.getJSON("tutors"),GameData.Q_PARAMS=this.game.cache.getJSON("quests").params;for(var t=0;t<GameData.Q_PARAMS.length;t++)GameData.Q_PARAMS[t].name=LangMng.getQuestName(t),GameData.Q_PARAMS[t].desc=LangMng.getQuestDesc(t);for(var e=Setting.LEVELS,i=0;i<e.length;i++){var n=e[i].data;for(t=0;t<4;t++)for(var a=0;a<4;a++)n[t][a].c=Setting.getCellId(n[t][a].t,n[t][a].isFix);e[i].data=n}Setting.LEVELS=e,SndMng.init(),SndMng.playSFX(this.game,"star-get",0),SndMng.playMainMusic(this.game,null,null,!0);this.game.cache.getJSON("settings");this.game.time.events.add(500,this.startGame,this)},e.prototype.startGame=function(){SG_Hooks.loaded((()=>{SndMng.playMainMusic(this.game,1,null,!1),this.game.state.start("MainMenu",!0,!1)}))},e}(Phaser.State);t.Preloader=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={}));var Setting,GuiUtils,RollBall,SGHooksMng,SndMng,LangMng,ScaleManager=function(){function t(){}return t.init=function(e){t.game=e,e.scale.scaleMode=Phaser.ScaleManager.USER_SCALE,window.onresize=function(){t.sizeCalculation()},t.sizeCalculation()},t.doEventOriChange=function(){this.onOrientationChangeSignal.dispatch(this.isPortrait)},t.sizeCalculation=function(){this.wnd_w=window.innerWidth,this.wnd_h=window.innerHeight,this.onSizeChangeSignal.dispatch();var e={w:this.wnd_w,h:this.wnd_h},i=this.isPortrait;this.isPortrait=e.h>e.w,this.isPortrait?this.game.width!=this.gw&&this.game.scale.setGameSize(this.gw,this.gh):this.game.width!=this.gh&&this.game.scale.setGameSize(this.gh,this.gw),this.isPortrait!=i&&this.doEventOriChange();var n,a,s=this.isPortrait?t.gw:t.gh,o=this.isPortrait?t.gh:t.gw,h=this.isPortrait?t.gsw:t.gsh,r=this.isPortrait?t.gsh:t.gsw;o/s>e.h/e.w?r/s>e.h/e.w?n=(a=e.h*o/r)*s/o:a=(n=e.w)*o/s:o/h>e.h/e.w?n=(a=e.h)*s/o:a=(n=e.w*s/h)*o/s;var l=n/h,d=a/r,c=Math.min(l,d);this.game.scale.setUserScale(c,c,0,0),this.dtx=(e.w-s*c)/2,this.dty=(e.h-o*c)/2,document.getElementById("content").style.marginLeft=Math.round(this.dtx).toString()+"px",document.getElementById("content").style.marginTop=Math.round(this.dty).toString()+"px",this.game.scale.refresh()},t.handleIncorrect=function(){this.game.device.desktop||(document.getElementById("turn").style.display="block",t.game.world.isPaused=!0)},t.handleCorrect=function(){this.game.device.desktop||(document.getElementById("turn").style.display="none",t.game.world.isPaused=!1),setTimeout("window.scrollTo(0,0)",1e3)},t}();ScaleManager.dtx=0,ScaleManager.dty=0,ScaleManager.wnd_w=0,ScaleManager.wnd_h=0,ScaleManager.onSizeChangeSignal=new Phaser.Signal,ScaleManager.onOrientationChangeSignal=new Phaser.Signal,function(t){t.QUESTS_TEST=!1,t.DAILY_5MIN_TEST=!1,t.HINTS_TEST=!1,t.TOTAL_LEVELS_CNT=700,t.LEVELS_IN_DIF_CNT=50,t.T_NONE=0,t.T_BLANK=1,t.T_START=2,t.T_END=3,t.T_LINE=4,t.T_ANG=5,t.PHYS_MOVED=0,t.PHYS_STATIC=1,t.J_R=1,t.J_B=2,t.J_L=-1,t.J_T=-2,t.ANGLE_ID_0=0,t.ANGLE_ID_90=1,t.ANGLE_ID_180=2,t.ANGLE_ID_270=3,t.CELLS=[{t:t.T_BLANK,p:t.PHYS_MOVED,key:"game",an_frames:["Blank","Blank","Blank","Blank"]},{t:t.T_BLANK,p:t.PHYS_STATIC,key:"game",an_frames:["cellBlankSteel","cellBlankSteel","cellBlankSteel","cellBlankSteel"]},{t:t.T_START,p:t.PHYS_STATIC,key:"game",an_frames:["start-1","start-2","start-3","start-4"]},{t:t.T_END,p:t.PHYS_STATIC,key:"game",an_frames:["Fin-1","Fin-2","Fin-3","Fin-4"]},{t:t.T_LINE,p:t.PHYS_MOVED,key:"game",an_frames:["horizontal","Vertical","horizontal","Vertical"]},{t:t.T_LINE,p:t.PHYS_STATIC,key:"game",an_frames:["Bluehorizontal","BlueVertical","Bluehorizontal","BlueVertical"]},{t:t.T_ANG,p:t.PHYS_MOVED,key:"game",an_frames:["Corner-1","Corner-2","Corner-3","Corner-4"]},{t:t.T_ANG,p:t.PHYS_STATIC,key:"game",an_frames:["BlueCorner-1","BlueCorner-2","BlueCorner-3","BlueCorner-4"]}],t.C_BL_MOVE=0,t.C_BL_STAT=1,t.C_START=2,t.C_END=3,t.C_L_MOVE=4,t.C_L_STAT=5,t.C_A_MOVE=6,t.C_A_STAT=7,t.LEVELS=[{data:[[{c:t.C_BL_MOVE},{c:t.C_BL_MOVE},{c:t.C_BL_MOVE},{c:t.C_BL_MOVE}],[{c:t.C_BL_MOVE},{c:t.C_START,a:t.ANGLE_ID_90},{c:t.C_BL_MOVE},{c:t.C_END,a:t.ANGLE_ID_90}],[{c:t.C_A_MOVE,a:t.ANGLE_ID_270},{c:t.C_L_MOVE,a:t.ANGLE_ID_90},{c:t.C_L_MOVE,a:t.ANGLE_ID_90},null],[null,null,{c:t.C_L_STAT},{c:t.C_A_STAT,a:t.ANGLE_ID_180}]],path:[],moves:[],isSimple:!1}],t.getCellId=function(e,i){var n=0;switch(e){case t.T_BLANK:n=t.C_BL_MOVE;break;case t.T_START:n=t.C_START;break;case t.T_END:n=t.C_END;break;case t.T_LINE:n=i?t.C_L_STAT:t.C_L_MOVE;break;case t.T_ANG:n=i?t.C_A_STAT:t.C_A_MOVE;break;default:n=-1}return n},t.getLevelAbsId=function(e,i){return e*t.LEVELS_IN_DIF_CNT+i},t.TUTORS=[],t.getTutorForLevel=function(e){for(var i=[],n=(t.LEVELS[e].moves,0);n<t.TUTORS.length;n++)if(t.TUTORS[n].level_id==e){i=t.TUTORS[n].turns;break}return i},t.SHOP_ITEMS=[{type:1,cnt:1,price:1e3}]}(Setting||(Setting={})),function(t){!function(t){var e=function(e){function i(){var t=null!==e&&e.apply(this,arguments)||this;return t.particles=[],t}return __extends(i,e),i.prototype.getRandomStarPart=function(e,i){var n=new t.EffParticle(this.game,e,i,"game","star");return n.scale.set(.4),n.anchor.set(.5),n.liveTimer=3,n.hideDelay=2,n.hideSpd=1,n.v.x=MyMath.randomInRange(-180,180),n.v.y=MyMath.randomInRange(-550,-250),n.grav.y=900,n},i.prototype.doFinalStars=function(t,e){for(var i=MyMath.randomIntInRange(8,12),n=0;n<i;n++){var a=this.getRandomStarPart(t,e);this.particles.push(a),this.addChild(a)}},i.prototype.doTakeStar=function(t,e){for(var i=MyMath.randomIntInRange(5,8),n=0;n<i;n++){var a=this.getRandomStarPart(t,e);this.particles.push(a),this.addChild(a)}},i.prototype.doCellDrop=function(e,i,n){var a=new t.EffParticle(this.game,e,i,String(n.key),n.frameName);a.anchor.set(n.anchor.x,n.anchor.y),a.rotation=n.rotation,a.liveTimer=3,a.hideDelay=2,a.hideSpd=1,a.v.x=MyMath.randomInRange(-180,180),a.v.y=MyMath.randomInRange(-550,-250),a.grav.y=900,a.rotSpd=MyMath.randomInRange(-180,180),this.particles.push(a),this.addChild(a)},i.prototype.update=function(){for(var t=this.particles.length-1;t>=0;t--)this.particles[t].update(),this.particles[t].liveTimer<=0&&(this.removeChild(this.particles[t]),this.particles.splice(t,1))},i}(Phaser.Sprite);t.EffMng=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){t.showPopupWindow=function(t,e,i,n){e.position.set(i.x,i.y),e.visible=!0,t.add.tween(e).to({x:n.x,y:n.y},500,Phaser.Easing.Back.Out,!0)}}(GuiUtils||(GuiUtils={})),function(t){!function(t){var e=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.liveTimer=1,e.grav=new Phaser.Point(0,0),e.v=new Phaser.Point(0,0),e.hideSpd=0,e.hideDelay=0,e.rotSpd=0,e}return __extends(e,t),e.prototype.update=function(){var t=this.game.time.elapsed/1e3;if(!(this.liveTimer<=0)){if(this.liveTimer-=t,this.x+=this.v.x*t,this.y+=this.v.y*t,this.v.x+=this.grav.x*t,this.v.y+=this.grav.y*t,this.hideDelay>0&&(this.hideDelay-=t),this.hideDelay<=0&&this.hideSpd>0&&this.alpha>0){var e=this.alpha-this.hideSpd*t;this.alpha=Math.max(0,e)}this.angle+=this.rotSpd*t}},e}(Phaser.Sprite);t.EffParticle=e}(t.Client||(t.Client={}))}(RollBall||(RollBall={})),function(t){t.getLanguage=function(){var t="";try{t=SG_Hooks.getLanguage()}catch(t){LogMng.error("SG_Hooks.getLanguage(mas): "+t)}return t},t.isEnabledIncentiviseButton=function(){try{return SG_Hooks.isEnabledIncentiviseButton()}catch(t){LogMng.error("SG_Hooks.isEnabledIncentiviseButton(): "+t)}},t.triggerIncentivise=function(t){try{SG_Hooks.triggerIncentivise(t)}catch(t){LogMng.error("SG_Hooks.triggerIncentivise(): "+t)}},t.setOrientationHandler=function(t){try{SG_Hooks.setOrientationHandler(t)}catch(t){LogMng.error("SG_Hooks.setOrientationHandler(): "+t)}},t.setResizeHandler=function(t){try{SG_Hooks.setResizeHandler(t)}catch(t){LogMng.error("SG_Hooks.setResizeHandler(): "+t)}},t.start=function(){try{SG_Hooks.start()}catch(t){LogMng.error("SG_Hooks.start(): "+t)}},t.levelStarted=function(t){try{SG_Hooks.levelStarted(t)}catch(e){LogMng.error("SG_Hooks.levelStarted("+t+"): "+e)}},t.levelFinished=function(t,e){try{SG_Hooks.levelFinished(t,e)}catch(i){LogMng.error("SG_Hooks.levelFinished("+t+","+e+"): "+i)}},t.levelUp=function(t,e){try{SG_Hooks.levelUp(t,e)}catch(i){LogMng.error("SG_Hooks.levelUp("+t+","+e+"): "+i)}},t.gameOver=function(t,e){try{SG_Hooks.gameOver(t,e)}catch(i){LogMng.error("SG_Hooks.gameOver("+t+","+e+"): "+i)}},t.setPauseHandler=function(t){try{SG_Hooks.setPauseHandler(t)}catch(t){LogMng.error("SG_Hooks.setPauseHandler(): "+t)}},t.setUnpauseHandler=function(t){try{SG_Hooks.setUnpauseHandler(t)}catch(t){LogMng.error("SG_Hooks.setUnpauseHandler(): "+t)}},t.setStorageItem=function(t,e){try{SG_Hooks.setStorageItem(t,e)}catch(i){LogMng.error('SG_Hooks.setStorageItem("'+t+'",'+e+"): "+i)}},t.getStorageItem=function(t){try{return SG_Hooks.getStorageItem(t)}catch(e){LogMng.error('SG_Hooks.getStorageItem("'+t+'"): '+e)}}}(SGHooksMng||(SGHooksMng={})),function(t){var e;function i(){null!=SG_Hooks.mainMusic&&SG_Hooks.mainMusic.stop()}function n(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=arguments.length>3&&void 0!==arguments[3]&&arguments[3];e&&(null!=SG_Hooks.mainMusic?n&&(SG_Hooks.mainMusic.stop(),SG_Hooks.mainMusic=t.add.sound("melody",i,!0),SG_Hooks.mainMusic.play()):a?SG_Hooks.mainMusic=t.add.sound("melody",i,!0):(SG_Hooks.mainMusic=t.add.sound("melody",i,!0),SG_Hooks.mainMusic.play()))}t.init=function(){e=!0},t.isSndEnabled=function(){return e},t.switchSoundEnabled=function(t){e=!e,GameData.setSoundEnabled(e),e?n(t,1,!0):i()},t.stopMainMusic=i,t.playMainMusic=n,t.playSFX=function(t,i,n){void 0===n&&(n=1),e&&t.add.sound(i,n).play()}}(SndMng||(SndMng={})),function(t){var e,i="en";function n(t,n){var a="noText";try{a=e[i][t][n]||"noText"}catch(e){LogMng.error("getText(menu = "+t+"; element = "+n+"): "+e)}return a}function a(t,i){var n=40;try{n=e.fonts[t][i].size||40}catch(e){LogMng.error("getTextSize(menu = "+t+"; element = "+i+"): "+e)}return n}function s(t,i){var n="WHITE";try{n=e.fonts[t][i].font||"WHITE"}catch(e){LogMng.error("getTextSize(menu = "+t+"; element = "+i+"): "+e)}return n}t.FONT_WHITE="WHITE",t.FONT_BROWN="BROWN",t.FONT_GOLD_GRAD="GOLD_GRAD",t.FONT_GREEN="GREEN",t.FONT_ORANGE="ORANGE",t.FONT_PURPLE="PURPLE",t.FONT_WH_BL_SW="WH_BL_SW",t.FONT_WH_BR_OUT="WH_BR_OUT",t.FONT_WH_BR_SW="WH_BR_SW",t.MENU_PRELOADER="preloader",t.MENU_MAINMENU="main_menu",t.MENU_SECTIONS="sections",t.MENU_LEVELS="levels",t.MENU_WHEEL="wheel",t.MENU_OUTSTAND="outstand",t.MENU_GAME="game",t.MENU_OPTIONS="options",t.MENU_WIN="win",t.MENU_SHOP="shop",t.MENU_NEED_COINS="need_coins",t.MENU_QUESTS="quests",t.MENU_ALL_WATCHED="watched",t.init=function(t,i){e=t.cache.getJSON(i,!0)},t.getLangAvailable=function(){var t=["en"];return null!=e.lang_available&&(t=e.lang_available),t},t.setLang=function(t){i=t},t.getLang=function(){return i},t.getText=n,t.getTextSize=a,t.getFont=s,t.getBmpText=function(t,e,i,o,h){return void 0===o&&(o=0),void 0===h&&(h=0),new Phaser.BitmapText(t,o,h,s(e,i),n(e,i),a(e,i))},t.getBmpTextBtnSection=function(e,i,a,o){return void 0===a&&(a=0),void 0===o&&(o=0),new Phaser.BitmapText(e,a,o,s(t.MENU_SECTIONS,"sec_title"),n(t.MENU_SECTIONS,i),78)},t.getQuestName=function(n){return e[i][t.MENU_QUESTS].items[n].name||"noText"},t.getQuestNameFont=function(){return e.fonts[t.MENU_QUESTS].items.name.font},t.getQuestNameSize=function(){return e.fonts[t.MENU_QUESTS].items.name.size},t.getQuestDesc=function(n){return e[i][t.MENU_QUESTS].items[n].desc||"noText"},t.getQuestDescFont=function(){return e.fonts[t.MENU_QUESTS].items.desc.font},t.getQuestDescSize=function(){return e.fonts[t.MENU_QUESTS].items.desc.size}}(LangMng||(LangMng={})),SG_Hooks.registerObserver((function(t){t&&"runGame"===t.action&&SG_Hooks.start()}));