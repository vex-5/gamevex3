/* uglified */
function TrinMouse(){this.x=0,this.y=0,this.current=0,this.last=0,this.out=!1,this.rawX=0,this.rawY=0,this.isTouched=!1}function extend(Child,Parent){function F(){}F.prototype=Parent.prototype,Child.prototype=new F,(Child.prototype.constructor=Child).super=Parent.prototype}function TrinUtil(){}function TrinStorage(){}function TrinRectangle(x,y,width,height){this.x=x,this.y=y,this.width=width,this.height=height}var _TrinGame,_PLAY_STATE,_HERO;function Tringine(width,height,initialState,frameRate,screenWidth,screenHeight){try{TrinStorage.prototype.supportsStorage="localStorage"in window&&null!==window.localStorage}catch(e){TrinStorage.prototype.supportsStorage=!1}void 0===screenWidth&&(screenWidth=640),void 0===screenHeight&&(screenHeight=712),void 0===frameRate&&(frameRate=30);var container=document.getElementById("GameContainer"),canvas=(container.style.position="absolute",container.style.left="50%",container.style.top="50%",document.createElement("Canvas"));canvas.width=width,canvas.height=height,canvas.style.width="100%",canvas.style.height="100%",container.appendChild(canvas),this.width=width,this.height=height,this.screenWidth=screenWidth,this.screenHeight=screenHeight,this.frameRate=frameRate,this.scaleFactor=1,this.gameContainer=container,this.canvas=canvas,this.context=canvas.getContext("2d"),this.state=null,this.nextState=new initialState,this.mouse=new TrinMouse,this.isMobile=TrinUtil.prototype.detectmob(),this.isAndroid=TrinUtil.prototype.isAndroid(),this.isIDevice=TrinUtil.prototype.isIDevice(),this.visibleArea={left:0,top:0,right:this.screenWidth,bottom:this.screenHeight,width:this.screenWidth,height:this.screenHeight},this.widthToHeight=this.width/this.height,this.paused=!1,this.SPIL_API=null,this.shakeTimer=0,this.shakeDuration=0,this.shakePower=0,this.shakeType=this.SHAKE_TYPE_LINE,this.offset={x:0,y:0},this.cameraRect=new TrinRectangle(0,0,1,1),(_TrinGame=this).perfomance=1,this.framesPassed=0,this.timestamp=0,this.rotateScreenState=null,this.gameState=null,this.isMobile?(this.mouse.onTouchStart.mouse=this.mouse,this.mouse.onTouchEnd.mouse=this.mouse,this.canvas.addEventListener("touchmove",this.getMouseXY,!1),this.canvas.addEventListener("touchstart",this.mouse.onTouchStart,!1),this.canvas.addEventListener("touchend",this.mouse.onTouchEnd,!1)):(this.mouse.onMouseDown.mouse=this.mouse,this.mouse.onMouseUp.mouse=this.mouse,this.canvas.addEventListener("mousedown",this.mouse.onMouseDown,!1),this.canvas.addEventListener("mouseup",this.mouse.onMouseUp,!1),this.canvas.addEventListener("mousemove",this.getMouseXY,!1),this.canvas.addEventListener("mouseout",this.mouse.onMouseUp,!1)),this.timesResized=0,window.addEventListener("resize",function(){function f(){arguments.callee.time===_TrinGame.timesResized&&(window.scrollTo(0,1),setTimeout(function(){_TrinGame.resizeGame()},100))}_TrinGame.timesResized++,f.time=_TrinGame.timesResized,setTimeout(f,100)},!1),window.addEventListener("orientationchange",function(){_TrinGame.orientationChanged()},!1),this.lang="en",this.lang=SG_Hooks.getLanguage(["en","es","ru","ge","fr","it","pt","tk"]),SG_Hooks.setOrientationHandler(this.resizeGame),SG_Hooks.setResizeHandler(this.resizeGame),setTimeout(function(){window.scrollTo(0,1),setTimeout(function(){_TrinGame.resizeGame()},250)},250)}function TrinAnimation(img,name){void 0===name&&(name="noname"),this.image=img,this.frames=[],this.name=name,this.totalFrames=0,this.width=0,this.height=0}function TrinSound(){this.name=name,this.snd=snd}function TrinAssetLoader(onComplete,onP){void 0===onComplete&&(onComplete=null),void 0===onP&&(onP=null),this.currentAsset=0,this.assetsToLoad=[],this.onComplete=onComplete,this.onP=onP,this.caller=null,this.partSize=0,this.currentProgress=0}function TrinBasic(){this.active=!0,this.exists=!0,this.visible=!0,this.parent=null,this.alive=!0}function TrinEntity(){TrinEntity.super.constructor.apply(this),this.x=0,this.y=0,this.width=0,this.height=0,this.orign={x:0,y:0},this.bounds=new TrinRectangle(0,0,0,0),this.boundsOffset={left:0,top:0,right:0,bottom:0},this.scale={x:1,y:1}}function TrinSprite(animation){TrinSprite.super.constructor.apply(this),this.animations=[],this.currentAnimation=null,this.currentFrame=0,this.animationProgress=0,this.animationSpeed=30,this.alpha=1,this.looped=!0,this.cutArea=new TrinRectangle(0,0,0,0),this.repeat=this.REPEAT_NO,this.repeatOrign={x:0,y:0},void 0!==animation&&this.addAnimationFromCache(animation)}function TrinText(text){TrinText.super.constructor.apply(this),this.text=""+text,this.neededText=null,this.color="#000000",this.style="16px Arial",this.filled=!0,this.baseLine="top",this.align="left",this.shadow={x:0,y:0,blur:0},this.patternImage=null}function TrinButton(onClick,animationName,opensLink){TrinButton.super.constructor.apply(this),void 0===opensLink&&(opensLink=!1),this.onClick=onClick,this.addAnimationFromCache(animationName),this.animationSpeed=0,this.opensLink=opensLink,this.onCanvasClick=null,this.opensLink&&(this.onCanvasClick=function(event){var button=arguments.callee.button;void 0!==button.onClick&&null!==button.onClick&&button.active&&button.bounds.intersects(_TrinGame.mouse.x,_TrinGame.mouse.y)&&button.onClick()},this.onCanvasClick.button=this,_TrinGame.isMobile?_TrinGame.canvas.addEventListener(this.touchEventName,this.onCanvasClick,!1):_TrinGame.canvas.addEventListener(this.clickEventName,this.onCanvasClick,!1))}function TrinLayer(){TrinLayer.super.constructor.apply(this),this.autoReviveChildren=!1,this.children=null,this.numChildren=0,this.sortIndex="",this.sortOrder=this.ASCEDING}function TrinGroup(width,height){TrinGroup.super.constructor.apply(this),this.canvas=document.createElement("canvas"),this.canvas.width=width,this.canvas.height=height,this.context=this.canvas.getContext("2d"),this.group=new TrinLayer,this.width=width,this.height=height,this.updateBounds()}function TrinState(){this.group=new TrinLayer}function TrinRectObject(x,y,width,height,color){void 0===x&&(x=0),void 0===y&&(y=0),void 0===width&&(width=10),void 0===height&&(height=0),void 0===color&&(color="#ffffff"),TrinRectObject.super.constructor.apply(this),this.x=x,this.y=y,this.width=width,this.height=height,this.color=color,this.active=this.exists=this.visible=!0,this.alpha=1}function LoaderState(){window.location.host.toLowerCase();var isiPhone=window.navigator.userAgent.match(/iPhone/gi),isiPad=window.navigator.userAgent.match(/iPad/gi);Global.prototype.IS_IPHONE=isiPhone&&0<isiPhone.length,Global.prototype.IS_IPAD=isiPad&&0<isiPad.length,LoaderState.super.constructor.apply(this),this.progressBar=null,this.progressBarLine=null,this.curDot=0,this.onProcess=function(percent){var state=arguments.callee.state;state.dots[state.curDot].visible=!state.dots[state.curDot].visible,state.curDot++,state.curDot>=state.dots.length&&(state.curDot=0),SG_Hooks.loadProgress(Math.round(100*percent))},this.dots=[],this.onProcess.state=this}function PlayState(){PlayState.super.constructor.apply(this),this.sky=null,this.skyBlur=null,this.walls={left:null,right:null},this.tonnelEnd=null,this.flash=null,this.hero=null,this.scoreBar=null,this.scoreLabel=null,this.backLayer=null,this.shipsLayer=null,this.frontLayer=null,this.elementsBackLayer=null,this.elementsFrontLayer=null,this.heroLayer=null,this.wallsLayer=null,this.flashLayer=null,this.guiLayer=null,this.dangerLayer=null,this.effectLayer=null,this.pauseLayer=null,this.watchAdLayer=null,this.bPause=null,this.pausePanel=null,this.completePanel=null,this.completeYourScoreLabel=null,this.completeTopScoreLabel=null,this.completeBRestart=null,this.completeBHome=null,this.pauseBPlay=null,this.pauseBRestart=null,this.pauseBHome=null,this.bShop=null,this.bMoreGames=null,this.shopBack=null,this.shopTitle=null,this.shopButtonss=null,this.descriptionPanel=null,this.description1=null,this.description2=null,this.description3=null,this.description4=null,this.costPanel=null,this.costLabel=null,this.crystalBack=null,this.crystalLabel=null,this.buyButtonLabel=null,this.watchAdPanel=null,this.bNoThanks=null,this.bWatchAd=null,this.missionsPanel=null,this.bottomParts=[],this.tonnel={top:null,bottom:null,end:null,start:null},this.shipTimer=0,this.topDistanceShowed=!1,this.speed=0,this.score=0,this.crystals=Global.prototype.crystals,this.levelCrystals=0,this.distance=0,this.escapeDistance=1,this.prevMetersLabel=0,this.meters=0,this.patterns=TrinAssetLoader.prototype.LOADED_JSON.Patterns.patterns,this.patterns.sort(function(a,b){return a.difficulty-b.difficulty}),this.difficulty=0,this.difficultySpeed=.8,this.coldown=0,this.viewState=this.VIEW_STATE_TONNEL,this.state=this.GAME_STATE_GAME,_PLAY_STATE=this,SG_Hooks.start()}function SpaceShip(){SpaceShip.super.constructor.apply(this),this.addAnimationFromCache("Ship1"),this.speed=PlayState.prototype.maxSpeed/4,this.boomTimer=-1,this.animationSpeed=10}function Hero(){Hero.super.constructor.apply(this),this.addAnimationFromCache("HeroRunL"),this.addAnimationFromCache("HeroRunR"),this.addAnimationFromCache("HeroAtackR",!1),this.addAnimationFromCache("HeroAtackL",!1),this.addAnimationFromCache("HeroJump",!1),this.dir=this.DIR_RIGHT,this.state=this.STATE_RUN,this.vspeed=32*(1+Global.prototype.upgrades.speed/10),Hero.prototype.BASE_Y=800-this.height,this.x=565-this.width,this.y=this.BASE_Y,this.boundsOffset.left=20,this.boundsOffset.right=40,this.boundsOffset.top=20,this.boundsOffset.bottom=80,this.animationSpeed=10,this.jumpActive=!1,this.shield=0<Global.prototype.upgrades.shield,this.shieldAmount=0,this.invulnerabilityTimer=0,this.shieldEntity=new TrinSprite("Shield"),this.shieldEntity.addAnimationFromCache("ShieldBrake",!1),this.shieldEntity.visible=0<this.shield,this.shieldEntity.animationSpeed=10,this.shieldEntity.orign.y=30,this.shieldEntity.orign.x=10,_HERO=this}function Saw(){Saw.super.constructor.apply(this,["Saw"]),this.orign.x=this.width/2,this.orign.y=this.height/2,this.boundsOffset.left=30,this.boundsOffset.top=30,this.boundsOffset.right=60,this.boundsOffset.bottom=60,this.danger=null}function Pillar(){Pillar.super.constructor.apply(this,["Pillar"]),this.addAnimationFromCache("Pillar2",!1),this.label=null,this.orign.x=this.width/2}function Global(){}function TopDistanceMarker(){TopDistanceMarker.super.constructor.apply(this,["TopDistanceMarker"])}function Atom(){Atom.super.constructor.apply(this,["Atom"]),this.orign.x=this.width/2,this.orign.y=this.height/2,this.boundsOffset.left=10,this.boundsOffset.top=10,this.boundsOffset.right=20,this.boundsOffset.bottom=20,this.animationSpeed=10,this.currentFrame=this.animationProgress=Math.floor(Math.random()*this.currentAnimation.totalFrames),this.upgrade=Global.prototype.upgrades.magnet,this.maxD=320+50*(this.upgrade-1),this.upgrade*=3}function Enemy(){Enemy.super.constructor.apply(this,["EnemyL"]),this.addAnimationFromCache("EnemyR"),this.addAnimationFromCache("EnemyDieR"),this.addAnimationFromCache("EnemyDieL"),this.dir=1,this.animationSpeed=15,this.killed=!1,this.state=this.STATE_WAIT}function Effect(){Effect.super.constructor.apply(this,["KillEffect"]),this.addAnimationFromCache("AtomEffect"),this.orign.x=this.width/2,this.orign.y=this.height/2,this.looped=!1,this.animationSpeed=15}function MainMenuState(){MainMenuState.super.constructor.apply(this),this.credits=null}function ShopButton(func,animation,desc1,desc2){var part;ShopButton.super.constructor.apply(this,[160,160]),this.desc1=desc1,this.desc2=desc2,this.costs=[10,50,200,500,1e3,2500],this.button=new TrinButton(this.upgrade,animation),this.button.orign.x=this.button.width/2,this.button.active=!1,this.button.reset(this.width/2,this.button.height/2),this.parts=[];for(var i=0;i<6;i++)(part=new TrinSprite("UpgradePart")).reset(32+15*i,this.button.y+this.button.height-3),part.visible=!1,this.parts[i]=part;for(this.max=new TrinSprite("UpgradeMax"),this.max.reset(0,40),this.max.visible=!1,this.maxTimer=0,this.orign.x=this.width/2,this.level=func(),this.func=func,this.add(this.button),i=0;i<6;i++)this.level>i&&(this.parts[i].visible=!0),this.add(this.parts[i]);this.add(this.max)}function RotateState(){RotateState.super.constructor.apply(this)}function startBlackJump(){new Tringine(640,960,LoaderState,30,540,712).start()}TrinMouse.prototype={update:function(){this.x=Math.min(Math.floor(this.rawX),_TrinGame.width),this.y=Math.min(Math.floor(this.rawY),_TrinGame.height),-1===this.current?this.current=0:2===this.current&&(this.current=1),this.last=this.current},isDown:function(){return 0<this.current},isPressed:function(){return 2===this.current},isReleased:function(){return-1===this.current},onMouseDown:function(){var mouse=arguments.callee.mouse;mouse.current=0<mouse.current?1:2},onMouseUp:function(){var mouse=arguments.callee.mouse;mouse.current=0<mouse.current?-1:0},onTouchStart:function(event){var mouse=arguments.callee.mouse;return mouse.isTouched=!0,_TrinGame.isAndroid?(event.preventDefault(),mouse.rawX=mouse.x=event.changedTouches[0].pageX/_TrinGame.scaleFactor+_TrinGame.offset.x,mouse.rawY=mouse.y=event.changedTouches[0].pageY/_TrinGame.scaleFactor+_TrinGame.offset.y):(mouse.rawX=mouse.x=event.layerX/_TrinGame.scaleFactor+_TrinGame.offset.x,mouse.rawY=mouse.y=event.layerY/_TrinGame.scaleFactor+_TrinGame.offset.y),mouse.current=0<mouse.current?1:2,!1},onTouchEnd:function(){var mouse=arguments.callee.mouse;return mouse.current=0<mouse.current?-1:0,mouse.rawX=-999,mouse.rawY=-999,mouse.isTouched=!1},reset:function(){this.current=0}},TrinUtil.prototype.drawEllipse=function(ctx,x,y,w,h){var ox=w/2*.5522848,oy=h/2*.5522848,xe=x+w,ye=y+h,w=x+w/2,h=y+h/2;ctx.beginPath(),ctx.moveTo(x,h),ctx.bezierCurveTo(x,h-oy,w-ox,y,w,y),ctx.bezierCurveTo(w+ox,y,xe,h-oy,xe,h),ctx.bezierCurveTo(xe,h+oy,w+ox,ye,w,ye),ctx.bezierCurveTo(w-ox,ye,x,h+oy,x,h),ctx.closePath(),ctx.stroke()},TrinUtil.prototype.detectmob=function(){return!!(navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/webOS/i)||navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPad/i)||navigator.userAgent.match(/iPod/i)||navigator.userAgent.match(/BlackBerry/i)||navigator.userAgent.match(/Windows Phone/i))},TrinUtil.prototype.isAndroid=function(){return navigator.userAgent.match(/Android/i)},TrinUtil.prototype.isIDevice=function(){return navigator.userAgent.match(/iPhone/i)||navigator.userAgent.match(/iPod/i)},TrinUtil.prototype.digits="0123456789ABCDEF",TrinUtil.prototype.numberToDec=function(number,base){for(var dec=0,p=1,i=(number=number.toUpperCase()).length-1;0<=i;i--){var c=number[i];dec+=this.digits.indexOf(c)*p,p*=base}return dec},TrinUtil.prototype.decToNumber=function(dec,base,len){void 0===len&&(len=2);for(var number="";0<dec;)number=this.digits[dec%base]+number,dec=Math.floor(dec/base);for(;number.length<len;)number="0"+number;return number},TrinStorage.prototype.supportsStorage=!1,TrinStorage.prototype.save=function(name,value){if(this.supportsStorage)try{name=Global.prototype.saveDataNamespace+"_"+name,localStorage.setItem(name,value)}catch(e){this.supportsStorage=!1}},TrinStorage.prototype.load=function(name){if(this.supportsStorage)try{return name=Global.prototype.saveDataNamespace+"_"+name,localStorage.getItem(name)}catch(e){this.supportsStorage=!1}return null},TrinStorage.prototype.remove=function(name){if(this.supportsStorage)try{localStorage.removeItem(name)}catch(e){this.supportsStorage=!1}},TrinStorage.prototype.clear=function(){if(this.supportsStorage)try{localStorage.clear()}catch(e){this.supportsStorage=!1}},TrinStorage.prototype.length=function(){if(this.supportsStorage)try{return localStorage.length}catch(e){this.supportsStorage=!1}return 0},TrinStorage.prototype.getKey=function(index){if(this.supportsStorage&&0<=index&&index<this.length)try{return localStorage.key(key)}catch(e){this.supportsStorage=!1}return null},TrinRectangle.prototype={top:function(){return this.y},left:function(){return this.x},bottom:function(){return this.y+this.height},right:function(){return this.x+this.width},set:function(x,y,width,height){this.x=x,this.y=y,this.width=width,this.height=height},intersects:function(x,y,width,height){return void 0===width&&void 0===height?x>this.left()&&x<this.right()&&y>this.top()&&y<this.bottom():(height=(y=y)+height,(x=x)+width>this.left()&&x<this.right()&&height>this.top()&&y<this.bottom())},intersectsRect:function(rect){return this.intersects(rect.x,rect.y,rect.width,rect.height)}},Tringine.prototype={state:null,update:function(){if(this.context.clearRect(0,0,this.canvas.width,this.canvas.height),null===this.state||this.paused||(this.state.update(),this.state.draw(this.canvas.getContext("2d")),this.mouse.update()),0<this.shakeTimer){if(this.shakeTimer<=1)_TrinGame.offset.x=_TrinGame.visibleArea.left,_TrinGame.offset.y=_TrinGame.visibleArea.top;else{var shakePower=0;switch(this.shakeType){case this.SHAKE_TYPE_LINE:shakePower=this.shakePower;break;case this.SHAKE_TYPE_DOWN:shakePower=this.shakePower*(this.shakeTimer/this.shakeDuration)}_TrinGame.offset.x=_TrinGame.visibleArea.left+(-shakePower/2+Math.random()*shakePower),_TrinGame.offset.y=_TrinGame.visibleArea.top+(-shakePower/2+Math.random()*shakePower)}this.shakeTimer--}null!==this.nextState&&(null!==this.state&&this.state.destroy(),this.mouse.reset(),this.state=this.nextState,this.state.create(),this.nextState=null)},start:function(){this.timestamp=(new Date).getTime(),setInterval(function(){_TrinGame.update()},1e3/_TrinGame.frameRate)},switchState:function(newState){this.nextState=newState},getMouseXY:function(event){var mx;return event.preventDefault(),event=_TrinGame.isAndroid?(mx=(event.touches[0].pageX+event.layerX)/_TrinGame.scaleFactor,(event.touches[0].pageY+event.layerY)/_TrinGame.scaleFactor):void 0===event.offsetX?(mx=event.layerX/_TrinGame.scaleFactor,event.layerY/_TrinGame.scaleFactor):(mx=event.offsetX/_TrinGame.scaleFactor,event.offsetY/_TrinGame.scaleFactor),_TrinGame.mouse.rawX=mx+_TrinGame.offset.x,_TrinGame.mouse.rawY=event+_TrinGame.offset.y,!1},log:function(msg){TrinUtil.prototype.detectmob()&&(document.getElementById("info").innerHTML=msg)},resizeGame:function(){var innerWidth=window.innerWidth,innerHeight=window.innerHeight,maxWidthToHeight=this.width/this.screenHeight,minWidthToHeight=this.screenWidth/this.height,newWidth=innerWidth,newHeight=innerHeight,newWidthToHeight=newWidth/newHeight,maxWidthToHeight=(maxWidthToHeight<newWidthToHeight?newWidth=newHeight*maxWidthToHeight:newWidthToHeight<minWidthToHeight?newHeight=newWidth/minWidthToHeight:newWidth=newHeight*newWidthToHeight,newWidthToHeight=(newWidth=Math.min(newWidth,innerWidth))/(newHeight=Math.min(newHeight,innerHeight)),this.gameContainer.style.marginTop=-newHeight/2+1+"px",this.gameContainer.style.marginLeft=-newWidth/2+"px",this.gameContainer.style.width=newWidth+"px",this.gameContainer.style.height=newHeight+"px",this.scaleFactor=newWidth/this.width,newWidth/this.scaleFactor),minWidthToHeight=newHeight/this.scaleFactor;maxWidthToHeight>this.width?minWidthToHeight=(maxWidthToHeight=this.width)/newWidthToHeight:minWidthToHeight>this.height&&(maxWidthToHeight=(minWidthToHeight=this.height)*newWidthToHeight),this.scaleFactor=newWidth/maxWidthToHeight,this.visibleArea.width=maxWidthToHeight,this.visibleArea.height=minWidthToHeight,this.visibleArea.left=(this.width-maxWidthToHeight)/2,this.visibleArea.top=(this.height-minWidthToHeight)/2,this.visibleArea.right=this.visibleArea.left+maxWidthToHeight,this.visibleArea.bottom=this.visibleArea.top+minWidthToHeight,this.canvas.width=maxWidthToHeight,this.canvas.height=minWidthToHeight,this.offset.x=this.visibleArea.left,this.offset.y=this.visibleArea.top,this.cameraRect.set(this.offset.x,this.offset.y,maxWidthToHeight,minWidthToHeight),null!==this.state&&this.state.resized(),window.scrollTo(0,1)},orientationChanged:function(){null!==this.rotateScreenState&&(0===window.orientation||180===window.orientation?null!==this.gameState&&(this.state=this.gameState,this.gameState=null):null===this.gameState&&(this.gameState=this.state,this.state=this.rotateScreenState))},globalPause:function(){this.paused=!0},globalResume:function(){this.paused=!1},shake:function(duration,power,type){this.shakeTimer=Math.floor(duration),this.shakeDuration=this.shakeTimer,this.shakePower=power,this.shakeType=type},SHAKE_TYPE_LINE:0,SHAKE_TYPE_DOWN:1},TrinAnimation.prototype={TYPE_IMAGE:0,TYPE_ANIMATION:1,IMAGES:[],ANIMATIONS:[],addImage:function(img){void 0===this.IMAGES[img.info.name]&&(this.IMAGES[img.info.name]=img)},makeAnimation:function(imgName,name,frameWidth,frameHeight,frames){var img=this.IMAGES[imgName];if(null==img||void 0===name)_TrinGame.log('No such loaded image "'+imgName+'"');else{void 0===frameWidth&&(frameWidth=img.width),void 0===frameHeight&&(frameHeight=img.height),void 0!==frames&&0!==frames.length||(frames=[0]);for(var animation=new TrinAnimation(img,name),columns=(Math.floor(img.height/frameHeight),Math.floor(img.width/frameWidth)),i=0;i<frames.length;i++){var frameNum=frames[i],frameNum=new TrinRectangle(frameNum%columns*frameWidth,Math.floor(frameNum/columns)*frameHeight,frameWidth,frameHeight);animation.frames.push(frameNum)}animation.totalFrames=animation.frames.length,this.ANIMATIONS[name]=animation}},getAnimation:function(name){return void 0===TrinAnimation.prototype.ANIMATIONS[name]?null:TrinAnimation.prototype.ANIMATIONS[name]}},TrinAnimation.prototype.destroy=function(){this.frames=null,this.image=null},TrinSound.prototype={SOUNDS:[],ENABLE_AUDIO:!0,add:function(snd){this.SOUNDS[snd.info.name]=snd},get:function(name){return void 0===this.SOUNDS[name]?null:this.SOUNDS[name]},muteAll:function(){var key,sounds=TrinSound.prototype.SOUNDS;for(key in sounds)sounds.hasOwnProperty(key)&&(TrinSound.prototype.get(key).volume=0);Global.prototype.saveAudioStatus()},unMuteAll:function(){var key,sounds=TrinSound.prototype.SOUNDS;for(key in sounds)sounds.hasOwnProperty(key)&&(TrinSound.prototype.get(key).volume=1);Global.prototype.saveAudioStatus()},play:function(name){TrinSound.prototype.SOUNDS.hasOwnProperty(name)&&(TrinSound.prototype.get(name).play().catch(e=>{}),TrinSound.prototype.ENABLE_AUDIO)&&(TrinSound.prototype.get(name).volume=1)},stop:function(name){TrinSound.prototype.SOUNDS.hasOwnProperty(name)&&TrinSound.prototype.get(name).stop()},setLoop:function(name,loop){TrinSound.prototype.SOUNDS.hasOwnProperty(name)&&(TrinSound.prototype.get(name).loop=loop)},pause:function(name,reset=!1){TrinSound.prototype.SOUNDS.hasOwnProperty(name)&&(TrinSound.prototype.get(name).pause(),reset)&&(TrinSound.prototype.get(name).currentTime=0)},soundsLoaded:!1},TrinAssetLoader.prototype={TYPE_IMAGE:0,TYPE_SOUND:1,TYPE_JSON:2,LOADED_JSON:[],addImage:function(name,src,animated){this.assetsToLoad.push({name:name,src:src,type:this.TYPE_IMAGE,animated:animated=void 0===animated||animated})},addSound:function(name,src){this.assetsToLoad.push({name:name,src:src,type:this.TYPE_SOUND})},addJson:function(name,src){this.assetsToLoad.push({name:name,src:src,type:this.TYPE_JSON})},load:function(){var loader;if(void 0===this.loader)loader=this;else{switch(loader=this.loader,this.info.type){case loader.TYPE_IMAGE:this.onload=null,this.onprocess=null,TrinAnimation.prototype.addImage(this),this.info.animated||TrinAnimation.prototype.makeAnimation(this.info.name,this.info.name);break;case loader.TYPE_SOUND:this.removeEventListener("canplaythrough",loader.load,!0);break;case loader.TYPE_JSON:TrinAssetLoader.prototype.LOADED_JSON[this.info.name]=this}this.loader=null,this.info=null}if(loader.currentAsset===loader.assetsToLoad.length)loader.loadingEnded(),loader.process(loader,1);else{loader.currentProgress=loader.currentAsset/loader.assetsToLoad.length,loader.process(loader,loader.currentProgress);var info=loader.assetsToLoad[loader.currentAsset++];switch(info.type){case loader.TYPE_IMAGE:var image=new Image;image.loader=loader,image.onload=loader.load,image.onprogress=function(event){var loader=arguments.callee.loader;loader.process(loader.currentProgress+loader.partSize*(event.loaded/event.total))},image.onprogress.loader=loader,image.info=info,image.src=info.src;break;case loader.TYPE_SOUND:var sound=new Audio;sound.loader=loader,sound.info=info,(image=document.createElement("source")).setAttribute("src",info.src+".mp3"),image.setAttribute("type","audio/mpeg"),sound.appendChild(image),(image=document.createElement("source")).setAttribute("src",info.src+".ogg"),image.setAttribute("type","audio/ogg"),sound.appendChild(image);const onAudioLoad=()=>{sound.pause(),sound.volume=1,sound.removeEventListener("canplaythrough",onAudioLoad,!1),sound.loader=null,loader.load()};sound.addEventListener("canplaythrough",onAudioLoad,!1),TrinSound.prototype.add(sound),sound.volume=0,sound.play(info.name).catch(e=>{}),sound.load();break;case loader.TYPE_JSON:function onLoad(json){var obj=JSON.parse(json);obj.loader=arguments.callee.loader,obj.info=arguments.callee.info,obj.loader.load.apply(obj)}(onLoad.loader=loader).loadJson((onLoad.info=info).src,onLoad)}}},onAudioLoad:function(_snd,_cb){_snd.volume=1,_snd.removeEventListener("canplaythrough",TrinAssetLoader.prototype.onAudioLoad,!1),_cb()},loadingEnded:function(){this.currentImage=0,this.assetsToLoad=[],null!==this.onComplete&&this.onComplete()},process:function(loader,percent){null!==loader.onP&&loader.onP(percent)},loadJson:function(url,callback){var xobj=new XMLHttpRequest;xobj.overrideMimeType("application/json"),xobj.open("GET",url,!0),xobj.onreadystatechange=function(){4===xobj.readyState&&200===xobj.status&&(callback(xobj.responseText),xobj.onreadystatechange=null)},xobj.send(null)},getLoadedJson:function(name){return TrinAssetLoader.prototype.LOADED_JSON[name]}},TrinBasic.prototype.destroy=function(){},TrinBasic.prototype.update=function(){},TrinBasic.prototype.draw=function(context){},TrinBasic.prototype.kill=function(){this.exists=!1,this.alive=!1},TrinBasic.prototype.revive=function(){this.exists=!0,this.alive=!0},TrinBasic.prototype.hitTest=function(x,y){},extend(TrinEntity,TrinBasic),TrinEntity.prototype.destroy=function(){TrinEntity.super.destroy.apply(this),this.orign=null,this.bounds=null,this.scale=null},TrinEntity.prototype.update=function(){TrinEntity.super.update.apply(this)},TrinEntity.prototype.draw=function(context){TrinEntity.super.draw.apply(this,[context])},TrinEntity.prototype.kill=function(){TrinEntity.super.kill.apply(this)},TrinEntity.prototype.revive=function(){TrinEntity.super.revive.apply(this)},TrinEntity.prototype.hitTest=function(x,y){return TrinEntity.super.hitTest.apply(this),this.bounds.intersects(x,y)},TrinEntity.prototype.updateBounds=function(){this.bounds.set(this.x-this.orign.x+this.boundsOffset.left,this.y-this.orign.y+this.boundsOffset.top,this.width-this.boundsOffset.right-this.boundsOffset.left,this.height-this.boundsOffset.bottom-this.boundsOffset.top)},TrinEntity.prototype.move=function(x,y){this.reset(this.x+x,this.y+y)},TrinEntity.prototype.reset=function(x,y){this.x=x,this.y=y,this.updateBounds()},extend(TrinSprite,TrinEntity),TrinSprite.prototype.update=function(){var prevFrame;TrinSprite.super.update.apply(this),null!==this.currentAnimation&&(prevFrame=this.currentFrame,this.animationProgress+=1/(_TrinGame.frameRate/this.animationSpeed),this.animationProgress>=this.currentAnimation.frames.length&&(this.looped?this.animationProgress-=Math.floor(this.animationProgress):this.animationProgress=this.currentAnimation.frames.length-1),this.currentFrame=Math.floor(this.animationProgress),this.currentFrame!==prevFrame)&&this.updateSize()},TrinSprite.prototype.draw=function(context){TrinSprite.super.draw.apply(this,[context]);var animation=this.currentAnimation;if(null!==animation&&this.visible&&this.exists&&this.bounds.intersectsRect(_TrinGame.cameraRect)){var frame=animation.frames[Math.floor(this.currentFrame)],sx=frame.x+this.cutArea.x,sy=frame.y+this.cutArea.y,sw=frame.width-this.cutArea.width-this.cutArea.x,sh=frame.height-this.cutArea.height-this.cutArea.y,dx=this.x+this.cutArea.x-this.orign.x*this.scale.x-_TrinGame.offset.x,dy=this.y+this.cutArea.y-this.orign.y*this.scale.y-_TrinGame.offset.y,dw=sw*this.scale.x,dh=sh*this.scale.y;if(context.globalAlpha=this.alpha,0<sw&&0<sh&&0<dw&&0<dh)switch(this.repeat){case this.REPEAT_NO:context.drawImage(animation.image,sx,sy,sw,sh,dx,dy,dw,dh);break;case this.REPEAT_Y:this.repeatOrign.y=this.repeatOrign.y%sh;var repeatSize=this.repeatOrign.y*this.scale.y;0<repeatSize&&context.drawImage(animation.image,sx,sy+(sh-this.repeatOrign.y),sw,this.repeatOrign.y,dx,dy,dw,repeatSize),0<dh-repeatSize&&context.drawImage(animation.image,sx,sy,sw,sh-this.repeatOrign.y,dx,dy+this.repeatOrign.y,dw,dh-repeatSize);break;case this.REPEAT_X:this.repeatOrign.y=this.repeatOrign.y%sh,0<(repeatSize=this.repeatOrign.x*this.scale.x)&&context.drawImage(animation.image,sx+(sw-this.repeatOrign.x),sy,this.repeatOrign.x,sh,dx,dy,repeatSize,dh),0<dw-repeatSize&&context.drawImage(animation.image,sx,sy,sw-this.repeatOrign.x,sh,dx+this.repeatOrign.x,dy,dw-repeatSize,dh)}}},TrinSprite.prototype.drawBounds=function(context){context.beginPath(),context.rect(this.bounds.x,this.bounds.y-_TrinGame.offset.y,this.bounds.width,this.bounds.height),context.stroke()},TrinSprite.prototype.addAnimationFromCache=function(name,switchToThis){void 0===switchToThis&&(switchToThis=!0);var animation=TrinAnimation.prototype.getAnimation(name);null!==animation&&(this.animations[name]=animation,switchToThis)&&this.switchAnimation(name)},TrinSprite.prototype.switchAnimation=function(name){name=this.animations[name];null!=name&&(this.currentAnimation=name,this.currentFrame=this.animationProgress=0,this.updateSize())},TrinSprite.prototype.updateSize=function(){var frame=this.currentAnimation.frames[Math.floor(this.currentFrame)];this.width=frame.width*this.scale.x,this.height=frame.height*this.scale.y,this.updateBounds()},TrinSprite.prototype.updateBounds=function(){this.bounds.set(this.x-this.orign.x*this.scale.x+this.boundsOffset.left,this.y-this.orign.y*this.scale.y+this.boundsOffset.top,this.width-this.boundsOffset.right,this.height-this.boundsOffset.bottom)},TrinSprite.prototype.destroy=function(){TrinSprite.super.destroy.apply(this),this.animations=null,this.currentAnimation=null,this.cutArea=null},TrinSprite.prototype.hitTest=function(x,y,d){TrinSprite.super.hitTest.apply(this);var animation=this.currentAnimation;if(null!==animation){x-=this.x,y-=this.y;var frame=animation.frames[this.currentFrame];if(!(x-(d=void 0===d?0:d)>this.bounds.right||x+d<this.bounds.left||y-d>this.bounds.bottom||y+d<this.bounds.top)){var imageData,cx,cy,animation=TrinAnimation.prototype.IMAGES[animation.name],canvas=document.createElement("Canvas"),canvas=(canvas.width=frame.width,canvas.height=frame.height,canvas.getContext("2d"));canvas.drawImage(animation,frame.x,frame.y,frame.width,frame.height,0,0,frame.width,frame.height);try{imageData=canvas.getImageData(frame.x,frame.y,frame.width,frame.height)}catch(e){return!0}for(var i=-d;i<=d;i++)for(var j=-d;j<=d;j++)if(cy=y+i,0<=(cx=x+j)&&cx<this.width&&0<=cy&&cy<this.height&&0<imageData.data[4*(cy*frame.width+cx)+3])return!0}}return!1},TrinSprite.prototype.isFinished=function(){return this.currentFrame===this.currentAnimation.frames.length-1},TrinSprite.prototype.play=function(){this.currentFrame=this.animationProgress=0},TrinSprite.prototype.REPEAT_NO=0,TrinSprite.prototype.REPEAT_X=1,TrinSprite.prototype.REPEAT_Y=2,extend(TrinText,TrinEntity),TrinText.prototype.setStyle=function(font,size,bold,color,align,baseLine){void 0===font&&(font="Arial"),void 0===size&&(size=16),void 0===bold&&(bold=!1),void 0===color&&(color=this.color),void 0===align&&(align=this.align),void 0===baseLine&&(baseLine=this.baseLine),this.style="",bold&&(this.style+="Bold "),this.style+=size+"px ",this.style+=font,this.color=color,this.align=align,this.baseLine=baseLine},TrinText.prototype.update=function(){TrinText.super.update.apply(this),null!==this.neededText&&(this.text===this.neededText?this.neededText=null:(this.text.length<this.neededText.length&&(this.text=this.text+""),this.text.length!==this.neededText.length&&(this.text=this.text.substring(0,this.text.length-1))))},TrinText.prototype.draw=function(context){TrinText.super.draw.apply(this,[context]);var dx=this.x-this.orign.x-_TrinGame.offset.x,dy=this.y-this.orign.y-_TrinGame.offset.y;context.font=this.style,context.textBaseline=this.baseLine,context.textAlign=this.align,0===this.shadow.x&&0===this.shadow.y&&0===this.shadow.blur||(context.shadowOffsetX=this.shadow.x,context.shadowOffsetY=this.shadow.y,context.shadowBlur=this.shadow.blur),this.filled?null===this.patternImage?context.fillStyle=this.color:(void 0===this.patterns[this.patternImage.src]&&(this.patterns[this.patternImage.src]=context.createPattern(this.patternImage,"repeat")),context.fillStyle=this.patterns[this.patternImage.src]):context.strokeStyle=this.color,context.fillText(this.text,dx,dy)},TrinText.prototype.changeText=function(newText){this.neededText=newText},TrinText.prototype.patterns=[],extend(TrinButton,TrinSprite),TrinButton.prototype.update=function(){TrinButton.super.update.apply(this),this.active&&(this.bounds.intersects(_TrinGame.mouse.x,_TrinGame.mouse.y)?(1<this.currentAnimation.frames.length&&(this.currentFrame=1),(_TrinGame.mouse.isReleased()||_TrinGame.mouse.isTouched)&&(2<this.currentAnimation.frames.length?this.currentFrame=2:this.currentFrame=0,this.opensLink||void 0===this.onClick||null===this.onClick||this.onClick())):this.currentFrame=0,this.updateSize())},TrinButton.prototype.clickEventName="click",TrinButton.prototype.touchEventName="touched",TrinButton.prototype.destroy=function(){TrinButton.super.destroy.apply(this),this.opensLink&&(_TrinGame.isMobile?_TrinGame.canvas.removeEventListener(this.touchEventName,this.onCanvasClick,!1):_TrinGame.canvas.removeEventListener(this.clickEventName,this.onCanvasClick,!1))},TrinButton.prototype.isHovered=function(){return 0<this.currentFrame},extend(TrinLayer,TrinBasic),TrinLayer.prototype.ASCEDNING=-1,TrinLayer.prototype.DESCENDING=1,TrinLayer.prototype.DEPTH_ID=0,TrinLayer.prototype.destroy=function(){if(this.kill(),null!==this.children){for(var entity,i=0;i<this.numChildren;)null!==(entity=this.children[i++])&&entity.destroy();this.children=[],this.numChildren=0,this.sortIndex=this.ASCEDING,null!==this.parent&&this.parent.remove(this)}TrinLayer.super.destroy.apply(this)},TrinLayer.prototype.kill=function(){if(null!==this.children)for(var entity,i=0;i<this.numChildren;)null!==(entity=this.children[i++])&&entity.exists&&entity.kill();TrinLayer.super.kill.apply(this)},TrinLayer.prototype.revive=function(){if(TrinLayer.super.revive.apply(this),this.autoReviveChildren&&null!==this.children)for(var entity,i=0;i<this.numChildren;)null===(entity=this.children[i++])||entity.exists||entity.revive()},TrinLayer.prototype.update=function(){TrinLayer.super.update.apply(this),this.updateChildren()},TrinLayer.prototype.draw=function(context){this.drawChildren(context),TrinLayer.super.draw.apply(this,[context])},TrinLayer.prototype.sort=function(index,order){void 0===index&&(index="y"),void 0===order&&(order=this.ASCEDING),null!==this.children&&(this.sortIndex=index,this.sortOrder=order,this.children.sort(this.sortHandler))},TrinLayer.prototype.add=function(entity){if(null===this.children&&(this.children=[]),!(-1<this.children.indexOf(entity))){null!==entity.parent&&entity.parent.remove(entity);for(var i=0,n=(entity.parent=this).children.length;i<n;){if(null===this.children[i])return this.children[i]=entity;i++}this.children[n]=entity,this.numChildren++}return entity},TrinLayer.prototype.remove=function(entity,splice){var i;return null===this.children||(i=this.children.indexOf(entity))<0||i>=this.children.length||(this.children[i]=null,entity.parent=null,splice&&(this.children.splice(i,1),this.numChildren--)),entity},TrinLayer.prototype.contains=function(entity){return null!==this.children&&0<=this.children.indexOf(entity)},TrinLayer.prototype.recycle=function(_class){var entity=this.getAvailable(_class);return null!==entity?entity:null!=_class&&(entity=new _class)instanceof TrinBasic?this.add(entity):null},TrinLayer.prototype.replace=function(oldEntity,newEntity){var i;return null!==this.children&&0<=(i=this.children.indexOf(oldEntity))&&i<this.children.length&&(null!==newEntity.parent&&newEntity.parent!==this&&(newEntity.parent.remove(newEntity),newEntity.parent=this),this.children[i]=newEntity,oldEntity.parent=null),newEntity},TrinLayer.prototype.swap=function(entityA,entityB){var iA,iB;null!==this.children&&(iA=this.children.indexOf(entityA),iB=this.children.indexOf(entityB),0<=iA)&&iA<this.children.length&&0<=iB&&iB<this.children.length&&(this.children[iA]=entityB,this.children[iB]=entityA)},TrinLayer.prototype.removeAll=function(destroy){if(void 0===destroy&&(destroy=!0),null!==this.children){for(var entity,i=0;i<this.numChildren;)null!==(entity=this.children[i++])&&(destroy&&entity.destroy(),entity.parent=null),this.children[i]=null;this.numChildren=0}},TrinLayer.prototype.getAvailable=function(_class){if(null!==this.children)for(var entity,i=0;i<this.numChildren;)if(null!==(entity=this.children[i++])&&!entity.exists&&(void 0===_class||entity instanceof _class))return entity;return null},TrinLayer.prototype.getExtant=function(_class){if(null!==this.children)for(var entity,i=0;i<this.numChildren;)if(null!==(entity=this.children[i++])&&entity.exists&&(null===_class||entity instanceof _class))return entity;return null},TrinLayer.prototype.getAlive=function(_class){if(null!==this.children)for(var entity,i=0;i<this.numChildren;)if(null!==(entity=this.children[i++])&&entity.exists&&entity.alive&&(null===_class||entity instanceof _class))return entity;return null},TrinLayer.prototype.getDead=function(_class){if(null!==this.children)for(var entity,i=0;i<this.numChildren;)if(null!==(entity=this.children[i++])&&!entity.alive&&(null===_class||entity instanceof _class))return entity;return null},TrinLayer.prototype.setAll=function(variableName,value,recurse){for(var entity,i=0;i<this.numChildren;)null!==(entity=this.children[i++])&&(recurse&&entity instanceof TrinLayer?entity.setAll(variableName,value,recurse):entity[variableName]=value)},TrinLayer.prototype.callAll=function(functionName,args,recurse){for(var entity,i=0;i<this.numChildren;)null!==(entity=this.children[i++])&&(recurse&&entity instanceof TrinLayer?entity.callAll(functionName,args,recurse):"function"==typeof entity[functionName]&&entity[functionName](args))},TrinLayer.prototype.updateChildren=function(){if(null!==this.children)for(var entity,i=0;i<this.numChildren;)null!==(entity=this.children[i++])&&entity.exists&&entity.active&&entity.update()},TrinLayer.prototype.drawChildren=function(context){if(null!==this.children)for(var entity,i=0;i<this.numChildren;)null!==(entity=this.children[i++])&&entity.exists&&entity.visible&&entity.draw(context)},TrinLayer.prototype.sortLayer=function(entity1,entity2){return null===entity1?this.sortOrder:null===entity2?-this.sortOrder:entity1[this.sortIndex]<entity2[this.sortIndex]?this.sortOrder:entity1[this.sortIndex]>entity2[this.sortIndex]?-this.sortOrder:0},extend(TrinGroup,TrinEntity),TrinGroup.prototype.add=function(entity){this.group.add(entity)},TrinGroup.prototype.remove=function(entity){this.group.remove(entity)},TrinGroup.prototype.draw=function(context){TrinGroup.super.draw.apply(this,[context]);var tmpOX=_TrinGame.offset.x,tmpOY=_TrinGame.offset.y,tmpCY=_TrinGame.cameraRect.y,tmpOX=(_TrinGame.offset.x=0,_TrinGame.offset.y=0,_TrinGame.cameraRect.y=0,this.context.clearRect(0,0,this.width,this.height),this.group.draw(this.context),_TrinGame.offset.x=tmpOX,_TrinGame.offset.y=tmpOY,_TrinGame.cameraRect.y=tmpCY,this.width),tmpOY=this.height,tmpCY=this.x-this.orign.x*this.scale.x-_TrinGame.offset.x,dy=this.y-this.orign.y*this.scale.y-_TrinGame.offset.y,dw=this.width*this.scale.x,dh=this.height*this.scale.y;context.drawImage(this.canvas,0,0,tmpOX,tmpOY,tmpCY,dy,dw,dh)},TrinState.prototype.group=null,TrinState.prototype.create=function(){},TrinState.prototype.update=function(){this.group.update()},TrinState.prototype.draw=function(context){this.group.draw(context)},TrinState.prototype.destroy=function(){this.group.destroy()},TrinState.prototype.add=function(entity){this.group.add(entity)},TrinState.prototype.remove=function(entity){this.group.remove(entity)},TrinState.prototype.resized=function(){},extend(TrinRectObject,TrinEntity),TrinRectObject.prototype.update=function(){TrinRectObject.super.update.apply(this)},TrinRectObject.prototype.draw=function(context){TrinRectObject.super.draw.apply(this,[context]),context.beginPath(),context.fillStyle=this.color,context.globalAlpha=this.alpha,context.fillRect(this.x,this.y,this.width,this.height),context.stroke()},TrinRectObject.prototype.reset=function(x,y,color){TrinRectObject.super.reset.apply(this,[x,y]),this.color=color},TrinRectObject.prototype.intersects=function(x,y,w,h){return new TrinRectangle(this.x,this.y,this.width,this.height).intersects(x,y,w,h)},extend(LoaderState,TrinState),LoaderState.prototype.create=function(){LoaderState.super.create.apply(this);var loader=new TrinAssetLoader((this.loadAllAssets.state=this).loadAllAssets,function(){});loader.addImage("MenuBack","img/game/menu_back.png",!1),loader.addImage("LoadingDot","img/game/loading_dot.png",!1),loader.addImage("TextMask","img/menu/text_mask.png",!1),loader.addImage("TextMaskActive","img/menu/text_mask_active.png",!1),loader.addImage("SoundOn","img/game/gui/sound_on.png",!1),loader.addImage("SoundOff","img/game/gui/sound_off.png",!1),loader.addImage("bClose","img/game/gui/bClose.png",!1),loader.addImage("bWatchAd","img/game/gui/bWatchAd2.png",!1),loader.addJson("Languages","data/languages.json"),loader.addImage("Rotate","img/rotate_portrait.png",!1),loader.addSound("MainTheme","snd/mainTheme",!0,!0),loader.addSound("bttn","snd/bttn",!0,!0),loader.addSound("collision","snd/collision",!0,!0),loader.addSound("laser","snd/laser",!0,!0),loader.addSound("coin","snd/coin",!0,!0),loader.addSound("jump","snd/jump",!0,!0),loader.load()},LoaderState.prototype.loadAllAssets=function(){_TrinGame.rotateScreenState=new RotateState,_TrinGame.rotateScreenState.create();var lang=TrinAssetLoader.prototype.LOADED_JSON.Languages,state=(_TrinGame.texts=lang[_TrinGame.lang],arguments.callee.state),title=(state.add(new TrinSprite("MenuBack")),new TrinText(""));title.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive,title.setStyle("font",48,!0,"#000000","left","bottom"),title.reset(_TrinGame.offset.x+8,_TrinGame.visibleArea.bottom-8),state.add(title),state.title=title;for(var i=0;i<3;i++){var dot=new TrinSprite("LoadingDot");dot.orign.y=dot.height,dot.reset(title.x+32*title.text.length+24*i,title.y),state.dots[i]=dot}lang=new TrinAssetLoader((state.loadComplete.state=state).loadComplete,state.onProcess);lang.addImage("Sky","img/game/sky.png",!1),lang.addImage("Back1","img/game/back1.png",!1),lang.addImage("Back2","img/game/back2.png",!1),lang.addImage("SkyBlur","img/game/sky_blur.png",!1),lang.addImage("Tonnel","img/game/tonnel.png",!1),lang.addImage("TonnelStart","img/game/tonnel_start.png",!1),lang.addImage("TonnelEnd","img/game/tonnel_end.png",!1),lang.addImage("WallL","img/game/wall_l.png",!1),lang.addImage("WallR","img/game/wall_r.png",!1),lang.addImage("Ship1","img/game/ship1.png",!1),lang.addImage("HeroRunL","img/game/hero/run_l.png"),lang.addImage("HeroRunR","img/game/hero/run_r.png"),lang.addImage("HeroAtackL","img/game/hero/atack_l.png"),lang.addImage("HeroAtackR","img/game/hero/atack_r.png"),lang.addImage("HeroJump","img/game/hero/jump.png"),lang.addImage("Shield","img/game/hero/shield.png"),lang.addImage("ShieldBrake","img/game/hero/shield_brake.png"),lang.addImage("Saw","img/game/elements/saw.png"),lang.addImage("Pillar","img/game/elements/pillar.png",!1),lang.addImage("Pillar2","img/game/elements/pillar2.png",!1),lang.addImage("Done","img/game/gui/done.png",!1),lang.addImage("TopDistanceMarker","img/game/elements/best.png",!1),lang.addImage("Danger","img/game/gui/danger.png"),lang.addImage("Atom","img/game/elements/atom.png"),lang.addImage("EnemyL","img/game/elements/enemy_l.png"),lang.addImage("EnemyR","img/game/elements/enemy_r.png"),lang.addImage("EnemyDieR","img/game/elements/enemy_die_r.png"),lang.addImage("EnemyDieL","img/game/elements/enemy_die_l.png"),lang.addImage("KillEffect","img/game/kill_effect.png"),lang.addImage("AtomEffect","img/game/atom_effect.png"),lang.addImage("Logo","img/menu/logo.png",!1),lang.addImage("bPlay","img/menu/bPlay.png"),lang.addImage("bWatch","img/menu/bPlay.png"),lang.addImage("bNoThanks","img/menu/bPlay.png"),lang.addImage("bMoreGames","img/menu/bMoreGames.png"),lang.addImage("bCredits","img/menu/bCredits.png"),lang.addImage("Credits","img/menu/credits.png",!1),lang.addImage("ScoreBar","img/game/gui/score.png",!1),lang.addImage("bPause","img/game/gui/bPause.png"),lang.addImage("bRestart","img/game/gui/bRestart.png"),lang.addImage("bHome","img/game/gui/bHome.png"),lang.addImage("bResume","img/game/gui/bResume.png"),lang.addImage("PausePanel","img/game/gui/pause_panel.png",!1),lang.addImage("bShop","img/game/gui/bShop.png"),lang.addImage("bMoreGamesSmall","img/game/gui/bMoreGames.png"),lang.addImage("MissionPanel","img/game/gui/mission_back.png",!1),lang.addImage("WatchAdPanel","img/game/gui/mission_back.png",!1),lang.addImage("ShopPanel","img/game/gui/shop_back.png",!1),lang.addImage("UpgradePart","img/game/gui/upgrade_part.png",!1),lang.addImage("UpgradeMax","img/game/gui/max.png",!1),lang.addImage("ShopButtons","img/game/gui/shop_buttons.png"),lang.addImage("bBuy","img/game/gui/bBuy.png"),lang.addImage("CrystalPanel","img/game/gui/atom_panel.png",!1),lang.addJson("Patterns","data/patterns.json"),lang.load()},LoaderState.prototype.loadComplete=function(){var state=arguments.callee.state;TrinAnimation.prototype.makeAnimation("HeroRunL","HeroRunL",137,153,[0,1,2,3,4,5]),TrinAnimation.prototype.makeAnimation("HeroRunR","HeroRunR",137,153,[0,1,2,3,4,5]),TrinAnimation.prototype.makeAnimation("HeroAtackL","HeroAtackL",137,992,[0,0,1,2]),TrinAnimation.prototype.makeAnimation("HeroAtackR","HeroAtackR",137,992,[2,2,1,0]),TrinAnimation.prototype.makeAnimation("HeroJump","HeroJump",146,227,[0,1,2,3,4]),TrinAnimation.prototype.makeAnimation("Saw","Saw",154,153,[0,1,2]),TrinAnimation.prototype.makeAnimation("Danger","Danger",168,97,[0,1]),TrinAnimation.prototype.makeAnimation("Atom","Atom",84,89,[0,1]),TrinAnimation.prototype.makeAnimation("EnemyL","EnemyL",122,113,[0,1,2,3,4,5,6]),TrinAnimation.prototype.makeAnimation("EnemyR","EnemyR",122,113,[0,1,2,3,4,5,6]),TrinAnimation.prototype.makeAnimation("EnemyDieL","EnemyDieL",298,683,[6,5,4,3,2,1,0]),TrinAnimation.prototype.makeAnimation("EnemyDieR","EnemyDieR",298,683,[0,1,2,3,4,5,6]),TrinAnimation.prototype.makeAnimation("KillEffect","KillEffect",299,640,[0,1,2,3]),TrinAnimation.prototype.makeAnimation("AtomEffect","AtomEffect",108,182,[0,1,2,3,4,5]),TrinAnimation.prototype.makeAnimation("bPlay","bPlay",437,61,[0,1]),TrinAnimation.prototype.makeAnimation("bWatch","bWatch",437,61,[0,1]),TrinAnimation.prototype.makeAnimation("bNoThanks","bNoThanks",437,61,[0,1]),TrinAnimation.prototype.makeAnimation("bMoreGames","bMoreGames",529,64,[0,1]),TrinAnimation.prototype.makeAnimation("bCredits","bCredits",311,66,[0,1]),TrinAnimation.prototype.makeAnimation("bPause","bPause",45,43,[0,1,2]),TrinAnimation.prototype.makeAnimation("bHome","bHome",83,83,[0,1,0]),TrinAnimation.prototype.makeAnimation("bRestart","bRestart",83,83,[0,1,0]),TrinAnimation.prototype.makeAnimation("bResume","bResume",83,83,[0,1,0]),TrinAnimation.prototype.makeAnimation("bShop","bShop",83,83,[0,1,0]),TrinAnimation.prototype.makeAnimation("bMoreGamesSmall","bMoreGamesSmall",83,83,[0,1,0]),TrinAnimation.prototype.makeAnimation("ShopButtons","bShopDanger",108,68,[8,9]),TrinAnimation.prototype.makeAnimation("ShopButtons","bShopMagnet",108,68,[0,1]),TrinAnimation.prototype.makeAnimation("ShopButtons","bShopShield",108,68,[6,7]),TrinAnimation.prototype.makeAnimation("ShopButtons","bShopSpeed",108,68,[2,3]),TrinAnimation.prototype.makeAnimation("ShopButtons","bShopCrystals",108,68,[4,5]),TrinAnimation.prototype.makeAnimation("Shield","Shield",163,167,[0,1,2,3,4,5]),TrinAnimation.prototype.makeAnimation("ShieldBrake","ShieldBrake",164,167,[0,1,2,3]),TrinAnimation.prototype.makeAnimation("bBuy","bBuy",200,44,[0,1]),state.startGame()},LoaderState.prototype.startGame=function(){Global.prototype.load(),document.addEventListener("visibilitychange",()=>{"visible"===document.visibilityState?!SG_Hooks.isAdPlaying()&&TrinSound.prototype.ENABLE_AUDIO&&(TrinSound.prototype.unMuteAll(),_TrinGame.globalResume()):!SG_Hooks.isAdPlaying()&&TrinSound.prototype.ENABLE_AUDIO&&(TrinSound.prototype.muteAll(),_TrinGame.globalPause())}),SG_Hooks.loaded(()=>{_TrinGame.switchState(new MainMenuState)})},LoaderState.prototype.resized=function(){if(void 0!==this.title){this.title.reset(_TrinGame.offset.x+8,_TrinGame.visibleArea.bottom-8);for(var i=0;i<3;i++)this.dots[i].y=this.title.y,this.dots[i].reset(this.title.x+32*this.title.text.length+24*i,this.title.y)}},extend(PlayState,TrinState),PlayState.prototype.create=function(){function toggleSound(){var state=arguments.callee.state;state.state!==state.GAME_STATE_PAUSE&&(TrinSound.prototype.ENABLE_AUDIO?(TrinSound.prototype.ENABLE_AUDIO=!1,TrinSound.prototype.muteAll(),state.bSoundOn.addAnimationFromCache("SoundOff",!0)):(TrinSound.prototype.unMuteAll(),TrinSound.prototype.ENABLE_AUDIO=!0,state.bSoundOn.addAnimationFromCache("SoundOn",!0)))}function fPause(){var state=arguments.callee.state;state.state===state.GAME_STATE_GAME?(TrinSound.prototype.pause("MainTheme"),state.state=state.GAME_STATE_PAUSE,state.pauseLayer.active=state.pauseLayer.visible=!0,state.hero.active=state.elementsBackLayer.active=state.elementsFrontLayer.active=!1,state.bPause.visible=state.bPause.active=!1,state.bSoundOn.visible=state.bSoundOn.active=!1,state.updateMissions()):state.state===state.GAME_STATE_PAUSE&&(TrinSound.prototype.play("MainTheme"),state.state=state.GAME_STATE_GAME,state.pauseLayer.active=state.pauseLayer.visible=!1,state.hero.active=state.elementsBackLayer.active=state.elementsFrontLayer.active=!0,state.bPause.visible=state.bPause.active=!0,state.bSoundOn.visible=state.bSoundOn.active=!0)}PlayState.super.create.apply(this),this.backLayer=new TrinLayer,this.shipsLayer=new TrinLayer,this.frontLayer=new TrinLayer,this.elementsBackLayer=new TrinLayer,this.elementsFrontLayer=new TrinLayer,this.heroLayer=new TrinLayer,this.wallsLayer=new TrinLayer,this.flashLayer=new TrinLayer,this.guiLayer=new TrinLayer,this.dangerLayer=new TrinLayer,this.effectLayer=new TrinLayer,this.pauseLayer=new TrinLayer,this.pauseLayer.visible=this.pauseLayer.active=!1,this.watchAdLayer=new TrinLayer,this.watchAdLayer.visible=this.watchAdLayer.active=!1,this.guiLayer.add(this.dangerLayer),this.add(this.backLayer),this.add(this.frontLayer),this.add(this.elementsBackLayer),this.add(this.elementsFrontLayer),this.add(this.heroLayer),this.add(this.effectLayer),this.add(this.wallsLayer),this.add(this.guiLayer),this.add(this.pauseLayer),this.add(this.flashLayer),this.add(this.watchAdLayer);var sky=new TrinSprite("Sky"),skyBlur=(sky.repeat=sky.REPEAT_Y,sky.scrollK=.05,this.sky=sky,new TrinSprite("SkyBlur")),back=(skyBlur.orign.y=skyBlur.height,skyBlur.y=_TrinGame.visibleArea.bottom,this.skyBlur=skyBlur,new TrinSprite("Back2")),back=(back.orign.y=back.height,back.y=_TrinGame.visibleArea.bottom,back.scrollK=.1,this.bottomParts[0]=back,(back=new TrinSprite("Back1")).orign.y=back.height,back.y=_TrinGame.visibleArea.bottom,back.scrollK=.2,this.bottomParts[1]=back,this.backLayer.add(sky),this.backLayer.add(this.bottomParts[0]),this.backLayer.add(this.bottomParts[1]),this.backLayer.add(this.shipsLayer),this.backLayer.add(skyBlur),new TrinSprite("WallL")),sky=(back.repeat=back.REPEAT_Y,this.walls.left=back,(back=new TrinSprite("WallR")).repeat=back.REPEAT_Y,back.orign.x=back.width,back.reset(640,0),this.walls.right=back,this.wallsLayer.add(this.walls.left),this.wallsLayer.add(this.walls.right),new TrinSprite("TonnelEnd")),skyBlur=(sky.orign.y=sky.height,sky.y=0,sky.scrollK=1,this.tonnel.end=sky,new TrinSprite("Tonnel")),back=(skyBlur.repeat=skyBlur.REPEAT_Y,this.tonnel.top=skyBlur,(skyBlur=new TrinSprite("Tonnel")).repeat=skyBlur.REPEAT_Y,skyBlur.y=this.tonnel.top.height,this.tonnel.bottom=skyBlur,(skyBlur=new TrinSprite("TonnelStart")).orign.y=skyBlur.height,skyBlur.y=_TrinGame.visibleArea.bottom,this.tonnel.start=skyBlur,this.frontLayer.add(this.tonnel.end),this.frontLayer.add(this.tonnel.top),this.frontLayer.add(this.tonnel.bottom),this.frontLayer.add(this.tonnel.start),new Hero),sky=(this.heroLayer.add(back),this.heroLayer.add(back.shieldEntity),this.hero=back,this.flash=new TrinRectObject(0,0,640,960,"#FFFFFF"),this.flash.alpha=0,this.scoreBar=new TrinSprite("ScoreBar"),this.scoreBar.orign.x=this.scoreBar.width,this.scoreBar.orign.y=this.scoreBar.height,this.scoreBar.reset(640,_TrinGame.visibleArea.bottom),this.scoreLabel=new TrinText("0"),this.scoreLabel.setStyle("font",32,!0,"#90BC0D","right","middle"),this.scoreLabel.reset(632,this.scoreBar.y-this.scoreBar.height/2),this.crystalBack=new TrinSprite("CrystalPanel"),this.crystalBack.orign.y=this.crystalBack.height,this.crystalBack.reset(0,this.scoreBar.y),this.crystalLabel=new TrinText("0"),this.crystalLabel.setStyle("font",32,!0,"#90BC0D","left","middle"),this.crystalLabel.reset(60,this.crystalBack.y-this.crystalBack.height/2),this.guiLayer.add(this.scoreBar),this.guiLayer.add(this.scoreLabel),this.guiLayer.add(this.crystalBack),this.guiLayer.add(this.crystalLabel),(fPause.state=toggleSound.state=this).bPause=new TrinButton(fPause,"bPause"),this.bPause.orign.x=this.bPause.width,this.bPause.reset(632,_TrinGame.offset.y+8),this.guiLayer.add(this.bPause),this.bSoundOn=new TrinButton(toggleSound,"SoundOn"),this.bSoundOn.orign.x=this.bSoundOn.width,this.bSoundOn.reset(60,_TrinGame.offset.y+8),this.guiLayer.add(this.bSoundOn),TrinSound.prototype.ENABLE_AUDIO||this.bSoundOn.addAnimationFromCache("SoundOff",!0),new TrinSprite("PausePanel")),back=(sky.orign.x=sky.width/2,sky.orign.y=sky.height/2,sky.reset(320,_TrinGame.offset.y+sky.height/2),this.pausePanel=sky,this.pausePanel.label=new TrinText(_TrinGame.texts.pause),this.pausePanel.label.setStyle("font",32,!0,"#000000","center","top"),this.pausePanel.label.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive,this.pausePanel.label.reset(320,this.pausePanel.y-80),(skyBlur=new TrinButton(function(){TrinSound.prototype.play("bttn"),SG_Hooks.triggerMidrollAd(function(){_TrinGame.switchState(new MainMenuState)}.bind(this))},"bHome")).orign.x=skyBlur.width/2,skyBlur.orign.y=skyBlur.height/2,skyBlur.reset(this.pausePanel.x-skyBlur.width-16,this.pausePanel.y+20),this.pauseBHome=skyBlur,new TrinButton(function(){TrinSound.prototype.play("bttn"),SG_Hooks.triggerMidrollAd(function(){TrinSound.prototype.play("MainTheme",!0),Global.prototype.crystals=_TrinGame.state.crystals,_TrinGame.switchState(new PlayState)}.bind(this))},"bRestart")),skyBlur=(back.orign.x=back.width/2,back.orign.y=back.height/2,back.reset(this.pausePanel.x,this.pauseBHome.y),this.pauseBRestart=back,new TrinButton(function(){var state=arguments.callee.state;TrinSound.prototype.play("bttn"),SG_Hooks.triggerMidrollAd(function(){state.bPause.onClick()}.bind(this))},"bResume"));skyBlur.onClick.state=this,skyBlur.orign.x=skyBlur.width/2,skyBlur.orign.y=skyBlur.height/2,skyBlur.reset(this.pausePanel.x+skyBlur.width+16,this.pauseBHome.y),this.pauseBPlay=skyBlur,this.missionsPanel=new TrinGroup(468,524),this.missionsPanel.orign.x=this.missionsPanel.width/2,this.missionsPanel.add(new TrinSprite("MissionPanel")),this.missionsPanel.reset(320,Global.prototype.missionPanelOffCenterY),this.missionsPanel.scale.x=.9,this.missionsPanel.scale.y=.9,this.missionsPanel.doneLayer=new TrinLayer,this.missionsPanel.add(this.missionsPanel.doneLayer),this.missionsPanel.labels=[],this.missionsPanel.rewards=[],this.missionsPanel.missions=[];for(var i=this.missionsPanel.missionNum=0;i<3;i++){for(var mission=Global.prototype.missions[i];mission.have>=mission.need;){var d=(mission.have=0)<mission.prevStep?2*mission.prevStep:2*mission.need;mission.prevStep=d,mission.reward=Math.floor(mission.reward*(mission.need+d)/mission.need),mission.need+=d,Global.prototype.missions.splice(i,1),Global.prototype.missions[Global.prototype.missions.length]=mission,mission=Global.prototype.missions[i]}mission.rewarded=!1,mission.oneRun&&(mission.have=0);var label=new TrinText((this.missionsPanel.missions[i]=mission).part1+mission.need+"("+mission.have+")"+mission.part2),label=(label.setStyle("font",18,!0,"#90BC0D","left","top"),label.reset(32,100+70*i),this.missionsPanel.add(label),this.missionsPanel.labels[i]=label,new TrinText(mission.reward));label.setStyle("font",24,!0,"#90BC0D","center","top"),label.reset(380,100+70*i),this.missionsPanel.add(label),this.missionsPanel.rewards[i]=label}this.missionsPanel.label=new TrinText(_TrinGame.texts.missions),this.missionsPanel.label.setStyle("font",48,!0,"#000000","center","top"),this.missionsPanel.label.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive,this.missionsPanel.label.reset(234,10),this.missionsPanel.add(this.missionsPanel.label),this.pauseLayer.add(sky),this.pauseLayer.add(this.pauseBHome),this.pauseLayer.add(this.pauseBRestart),this.pauseLayer.add(this.pauseBPlay),this.pauseLayer.add(this.missionsPanel),this.pauseLayer.add(this.pausePanel.label),this.flashLayer.add(this.flash),this.resized()},PlayState.prototype.update=function(){switch(PlayState.super.update.apply(this),this.crystalLabel.text=this.crystals+this.levelCrystals+"",this.state){case this.GAME_STATE_GAME:this.distance+=this.speed,this.score+=this.speed/100;var ship,prev=this.meters,topMeters=(this.meters=Math.floor(this.distance/100),this.meters+8+Math.floor(this.bufferZone/100));if(Global.prototype.addToMission("Meter",this.meters-prev),this.difficulty+=this.difficultySpeed,this.difficultySpeed=Math.min(this.difficultySpeed+5e-4,10),this.coldown-=this.speed,this.coldown<=0){for(var maxPattern=-1,i=0;i<this.patterns.length&&!(this.patterns[i].difficulty>this.difficulty);i++)maxPattern=i;var data,element,dir,dx,pattern;if(null!==(pattern=0<=maxPattern?this.patterns[Math.floor(Math.random()*(maxPattern+1))]:null))for(this.coldown=pattern.coldown,this.difficulty-=pattern.difficulty,dir=Math.random()<.5?1:-1,i=0;i<pattern.elements.length;i++){switch((data=pattern.elements[i]).type){case"Saw":element=this.elementsFrontLayer.recycle(Saw);break;case"Pillar":element=this.elementsBackLayer.recycle(Pillar);break;case"Atom":element=this.elementsFrontLayer.recycle(Atom);break;case"Enemy":element=this.elementsFrontLayer.recycle(Enemy)}element.alive||element.revive(),dx=data.x-320,element.reset(320+dx*dir,data.y-this.bufferZone)}else this.coldown=100}switch(Math.floor(topMeters/50)>this.prevMetersLabel&&(this.prevMetersLabel=Math.floor(topMeters/50),(prev=this.elementsFrontLayer.recycle(Pillar)).alive||prev.revive(),prev.reset(320,-prev.height-60,50*Math.floor(topMeters/50)+"")),-1!==Global.prototype.topDistance&&topMeters>=Global.prototype.topDistance&&!this.topDistanceShowed&&(this.topDistanceShowed=!0,(prev=this.elementsFrontLayer.recycle(TopDistanceMarker)).alive||prev.revive(),prev.reset(640,-this.bufferZone)),this.viewState){case this.VIEW_STATE_TONNEL:this.distance>=this.escapeDistance&&(this.viewState=this.VIEW_STATE_TONNEL_ESCAPE);break;case this.VIEW_STATE_TONNEL_ESCAPE:this.tonnel.start.y=_TrinGame.visibleArea.bottom+this.distance,this.tonnel.top.y+=this.speed,this.tonnel.bottom.y=this.tonnel.top.y+this.tonnel.top.height,this.tonnel.end.y=this.tonnel.top.y+2,this.tonnel.end.y>_TrinGame.visibleArea.bottom+this.tonnel.end.height&&(this.viewState=this.VIEW_STATE_SKY_INTRO,this.tonnel.start.destroy(),this.tonnel.end.destroy(),this.tonnel.top.destroy(),this.tonnel.bottom.destroy(),this.frontLayer.remove(this.tonnel.start),this.frontLayer.remove(this.tonnel.end),this.frontLayer.remove(this.tonnel.top),this.frontLayer.remove(this.tonnel.bottom),this.tonnel=null);case this.VIEW_STATE_SKY_INTRO:if(this.flash.alpha=Math.max(0,.98*this.flash.alpha),this.escapeDistance,this.distance,null!==this.bottomParts){for(var vaBottom=_TrinGame.visibleArea.bottom,empty=!0,part=null,i=0;i<this.bottomParts.length;i++)null!==(part=this.bottomParts[i])&&(empty=!1,part.y=vaBottom+(this.distance-this.escapeDistance)*part.scrollK-180,part.y>vaBottom+part.height)&&(part.destroy(),1===i&&.95<_TrinGame.perfomance&&(this.flash.alpha=.75,_TrinGame.shake(120,8,_TrinGame.SHAKE_TYPE_DOWN)),this.backLayer.remove(part),this.bottomParts[i]=null);empty&&(this.bottomParts=null,this.viewState=this.VIEW_STATE_SKY,this.flash.alpha=0)}break;case this.VIEW_STATE_SKY:.95<_TrinGame.perfomance&&this.shipTimer--<=0&&(this.shipTimer=90+90*Math.random(),(ship=this.shipsLayer.recycle(SpaceShip)).alive||ship.revive(),ship.reset())}this.walls.left.repeatOrign.y=this.walls.right.repeatOrign.y+=this.speed,this.sky.repeat=this.sky.REPEAT_NO,this.scoreLabel.text=Math.floor(this.score),this.speed=Math.min(this.maxSpeed,this.speed+.1);break;case this.GAME_STATE_PAUSE:_TrinGame.mouse.isPressed()&&!this.pausePanel.bounds.intersects(_TrinGame.mouse.x,_TrinGame.mouse.y)&&this.bPause.onClick();break;case this.GAME_STATE_COMPLETE:this.completePanel.y=this.completePanel.y-(this.completePanel.y-Global.prototype.missionPanelCenteredY)/8,this.completeYourScoreLabel.y=this.completePanel.y+50,this.completeTopScoreLabel.y=this.completeYourScoreLabel.y+30,this.bMoreGames.y=this.bShop.y=this.completeBHome.y=this.completeBRestart.y=this.completePanel.y+120,this.completePanel.scale.x=1,this.completePanel.scale.y=1,this.completePanel.updateBounds(),this.completePanel.y-Global.prototype.missionPanelCenteredY<2&&(this.state=this.GAME_STATE_COMPLETE_MISSIONS);break;case this.GAME_STATE_COMPLETE_MISSIONS:this.state=this.GAME_STATE_COMPLETE_END;break;case this.GAME_STATE_SHOP:if(4<Math.abs(this.completePanel.y+440))this.completePanel.y=this.completePanel.y-(this.completePanel.y+440)/8,this.completeYourScoreLabel.y=this.completePanel.y+90,this.completeTopScoreLabel.y=this.completeYourScoreLabel.y+30,this.bMoreGames.y=this.bShop.y=this.completeBHome.y=this.completeBRestart.y=this.completePanel.y+120,this.completeBHome.orign.x=this.completeBHome.width/2,this.completeBHome.x=320,this.completePanel.updateBounds();else if(4<Math.abs(this.shopBack.y-210)){for(this.shopBack.y=this.shopBack.y-(this.shopBack.y-260)/4,this.shopTitle.y=this.shopBack.y+16,i=0;i<this.shopButtons.length;i++)this.shopButtons[i].y=this.shopBack.y+118*Math.floor(i/3)+80;this.descriptionPanel.y=this.shopBack.y+230,this.description1.y=this.descriptionPanel.y+4,this.description2.y=this.description1.y+10,this.description3.y=this.description2.y+10,this.description4.y=this.description3.y+10,this.bBuy.y=this.descriptionPanel.y+90,this.buyButtonLabel.y=this.bBuy.y+this.bBuy.height/2,this.costLabel.y=this.bBuy.y+12,this.completeBHome.y=this.bMoreGames.y=this.completeBRestart.y=this.shopBack.y+360,this.buyButtonLabel.visible=this.bBuy.visible=this.bBuy.active=null!==ShopButton.prototype.selectedButton&&6!==ShopButton.prototype.selectedButton.level,this.bBuy.isHovered()?this.buyButtonLabel.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive:this.buyButtonLabel.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.shopBack.updateBounds(),this.shopTitle.updateBounds(),this.descriptionPanel.updateBounds(),this.costPanel.updateBounds()}break;case this.GAME_STATE_WATCH_AD:this.watchAdPanel.y=this.watchAdPanel.y-(this.watchAdPanel.y-260)/4,this.watchSubText.y=this.watchAdPanel.y+120,this.crystalText.y=this.watchSubText.y+70,this.crystalImage.y=this.crystalText.y+15,this.noAdText.y=this.crystalImage.y+70,this.bNoThanks.y=this.crystalImage.y+165,this.bWatchAd.y=this.bNoThanks.y,this.watchAdPanel.updateBounds()}},PlayState.prototype.openShop=function(){this.state=this.GAME_STATE_SHOP,this.shopBack=new TrinSprite("ShopPanel"),this.shopBack.orign.x=this.shopBack.width/2,this.shopBack.reset(320,1e3),this.shopTitle=new TrinText(_TrinGame.texts.shop),this.shopTitle.setStyle("font",40,!0,"#000000","center","top"),this.shopTitle.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive,this.shopTitle.reset(320,1100),this.shopButtons=[];for(var animations=["bShopMagnet","bShopSpeed","bShopCrystals","bShopShield","bShopDanger"],descs1=[_TrinGame.texts.shop_magnet_1,_TrinGame.texts.shop_jump_1,_TrinGame.texts.shop_crystals_1,_TrinGame.texts.shop_shield_1,_TrinGame.texts.shop_warn_1],descs2=[_TrinGame.texts.shop_magnet_2,_TrinGame.texts.shop_jump_1,_TrinGame.texts.shop_crystals_1,_TrinGame.texts.shop_shield_2,_TrinGame.texts.shop_warn_2],functions=[function(l){if(void 0===l)return Global.prototype.upgrades.magnet;Global.prototype.upgrades.magnet=l},function(l){if(void 0===l)return Global.prototype.upgrades.speed;Global.prototype.upgrades.speed=l},function(l){if(void 0===l)return Global.prototype.upgrades.crystals;Global.prototype.upgrades.crystals=l},function(l){if(void 0===l)return Global.prototype.upgrades.shield;Global.prototype.upgrades.shield=l},function(l){if(void 0===l)return Global.prototype.upgrades.warn;Global.prototype.upgrades.warn=l}],i=0;i<animations.length;i++)this.shopButtons[i]=new ShopButton(functions[i],animations[i],descs1[i],descs2[i]),this.shopButtons[i].reset(180+i%3*144,1e3);for(this.descriptionPanel=new TrinSprite("DescriptionPanel"),this.descriptionPanel.reset(380,1e3),this.description1=new TrinText(""),this.description1.setStyle("font",12,!0,"#90BC0D","left","top"),this.description1.reset(this.descriptionPanel.x+16,1e3),this.description2=new TrinText(""),this.description2.setStyle("font",12,!0,"#90BC0D","left","top"),this.description2.reset(this.descriptionPanel.x+16,1e3),this.description3=new TrinText(""),this.description3.setStyle("font",12,!0,"#90BC0D","left","top"),this.description3.reset(this.descriptionPanel.x+16,1e3),this.description4=new TrinText(""),this.description4.setStyle("font",12,!0,"#90BC0D","left","top"),this.description4.reset(this.descriptionPanel.x+16,1e3),this.costPanel=new TrinSprite("CrystalPanel"),this.costPanel.reset(this.descriptionPanel.x,1e3),this.costLabel=new TrinText(""),this.costLabel.setStyle("font",16,!0,"#90BC0D","left","top"),this.costLabel.reset(this.costPanel.x+this.costPanel.width-106,1e3),this.guiLayer.add(this.shopBack),this.guiLayer.add(this.shopTitle),i=0;i<animations.length;i++)this.guiLayer.add(this.shopButtons[i]);this.bBuy=new TrinButton(ShopButton.prototype.upgrade,"bBuy"),this.bBuy.reset(303,1100),this.buyButtonLabel=new TrinText(_TrinGame.texts.buy),this.buyButtonLabel.setStyle("font",22,!0,"#0000000","right","middle"),this.buyButtonLabel.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.buyButtonLabel.reset(410,1100),this.buyButtonLabel.visible=!1,this.guiLayer.add(this.descriptionPanel),this.guiLayer.add(this.description1),this.guiLayer.add(this.description2),this.guiLayer.add(this.description3),this.guiLayer.add(this.description4),this.guiLayer.add(this.bBuy),this.guiLayer.add(this.buyButtonLabel),this.guiLayer.add(this.costLabel)},PlayState.prototype.showRewardedDialog=function(){this.bBuy.active=!1,this.completeBHome.active=!1,this.completeBRestart.active=!1,this.watchAdLayer.active=this.watchAdLayer.visible=!0,this.state=this.GAME_STATE_WATCH_AD;var watchAdPanel=new TrinGroup(468,524),deactivateRewardedDialog=(watchAdPanel.orign.x=watchAdPanel.width/2,watchAdPanel.add(new TrinSprite("MissionPanel")),watchAdPanel.reset(320,1e3),this.watchAdPanel=watchAdPanel,this.watchAdPanel.label=new TrinText("Get crystals"),this.watchAdPanel.label.setStyle("font",40,!0,"#000000","center","top"),this.watchAdPanel.label.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive,this.watchAdPanel.label.reset(234,15),this.watchAdPanel.add(this.watchAdPanel.label),this.watchSubText=new TrinText("Watch & Earn!"),this.watchSubText.setStyle("font",30,!0,"#FFFFFF","center","top"),this.watchSubText.reset(320,120),this.crystalText=new TrinText("+20"),this.crystalText.setStyle("font",50,!0,"#bcf300","center","top"),this.crystalText.reset(260,236),this.crystalImage=new TrinSprite("Atom"),this.crystalImage.addAnimationFromCache("Atom",!1),this.crystalImage.reset(385,255),this.crystalImage.animationSpeed=10,this.crystalImage.orign.y=this.crystalImage.height/2,this.crystalImage.orign.x=this.crystalImage.width/2,this.crystalImage.scale.y=this.crystalImage.scale.x=1.2,this.noAdText=new TrinText(_TrinGame.texts.no_ad),this.noAdText.setStyle("font",20,!0,"#a80505","center","middle"),this.noAdText.reset(320,220),this.noAdText.visible=!1,function(){this.bBuy.active=!0,this.completeBHome.active=!0,this.completeBRestart.active=!0,this.bWatchAd.active=this.bNoThanks.active=!1,this.noAdText.visible=!1,this.watchAdPanel.reset(320,1e3),this.watchAdLayer.remove(this.watchAdPanel),this.watchAdLayer.active=this.watchAdLayer.visible=!1,this.watchAdLayer.remove(this.watchAdPanel),this.watchAdLayer.remove(this.watchSubText),this.watchAdLayer.remove(this.crystalText),this.watchAdLayer.remove(this.crystalImage),this.watchAdLayer.remove(this.bNoThanks),this.watchAdLayer.remove(this.bWatchAd),this.watchAdLayer.remove(this.noAdText)}.bind(this)),_that=(this.bNoThanks=new TrinButton(()=>{this.state=this.GAME_STATE_SHOP,deactivateRewardedDialog()},"bClose"),this.bNoThanks.orign.x=this.bNoThanks.width/2,this.bNoThanks.orign.y=this.bNoThanks.height/2,this.bNoThanks.reset(220,400),this);this.bWatchAd=new TrinButton(function(){SG_Hooks.triggerIncentivise(function(){this.state=this.GAME_STATE_SHOP,deactivateRewardedDialog(),Global.prototype.crystals=_TrinGame.state.crystals+20,_that.crystals+=20,Global.prototype.save()}.bind(this),function(){_that.noAdText.visible=!0,_that.bWatchAd.active=!1,_that.bWatchAd.alpha=.7}.bind(this))},"bWatchAd"),this.bWatchAd.orign.x=this.bWatchAd.width/2,this.bWatchAd.orign.y=this.bWatchAd.height/2,this.bWatchAd.reset(400,400),this.watchAdLayer.add(this.watchAdPanel),this.watchAdLayer.add(this.watchSubText),this.watchAdLayer.add(this.crystalText),this.watchAdLayer.add(this.crystalImage),this.watchAdLayer.add(this.bNoThanks),this.watchAdLayer.add(this.bWatchAd),this.watchAdLayer.add(this.noAdText)},PlayState.prototype.gameOver=function(){this.flash.visible=!1,this.guiLayer.remove(this.bPause),this.guiLayer.remove(this.bSoundOn),this.guiLayer.remove(this.bSoundOff),TrinSound.prototype.pause("MainTheme"),Global.prototype.topScore=Math.max(Global.prototype.topScore,Math.floor(this.score));var d=Math.floor(this.levelCrystals*(1+Global.prototype.upgrades.crystals/10)),d=(this.crystals=this.crystals+d,Global.prototype.addToMission("Crystal",d),this.levelCrystals=0,Global.prototype.crystals=this.crystals,this.state=this.GAME_STATE_COMPLETE,this.missionsPanel),scoreLabel=(d.orign.x=d.width/2,d.orign.y=d.height/2,d.reset(320,11200),this.completePanel=d,this.updateMissions(),new TrinText(_TrinGame.texts.your_score+": "+Math.floor(this.score))),topScoreLabel=(scoreLabel.setStyle("font",32,!0,"#FFFFFF","center","middle"),scoreLabel.reset(320,1600),this.completeYourScoreLabel=scoreLabel,new TrinText(_TrinGame.texts.top_score+": "+Global.prototype.topScore));topScoreLabel.setStyle("font",32,!0,"#FFFFFF","center","middle"),topScoreLabel.reset(320,scoreLabel.y),this.completeTopScoreLabel=topScoreLabel,this.completeBRestart=new TrinButton(function(){TrinSound.prototype.play("bttn"),SG_Hooks.triggerMidrollAd(function(){TrinSound.prototype.play("MainTheme",!0),Global.prototype.crystals=_TrinGame.state.crystals,_TrinGame.switchState(new PlayState),Global.prototype.save()}.bind(this))},"bResume"),this.completeBRestart.orign.x=this.completeBRestart.width,this.completeBRestart.reset(520,1100),this.completeBHome=new TrinButton(function(){TrinSound.prototype.play("bttn"),SG_Hooks.triggerMidrollAd(function(){_TrinGame.switchState(new MainMenuState),Global.prototype.save()}.bind(this))},"bHome"),this.completeBHome.orign.x=this.completeBHome.width/2,this.completeBHome.reset(270,1100),this.bShop=new TrinButton(function(){TrinSound.prototype.play("bttn"),_TrinGame.state.openShop()},"bShop"),this.bShop.orign.x=this.bShop.width/2,this.bShop.reset(370,1100),this.bMoreGames=new TrinButton(function(){SG.redirectToPortal()},"bMoreGamesSmall",!0),this.bMoreGames.reset(120,1100),this.guiLayer.add(d),this.guiLayer.add(this.completeYourScoreLabel),this.guiLayer.add(this.completeTopScoreLabel),this.guiLayer.add(this.completeBRestart),this.guiLayer.add(this.completeBHome),this.guiLayer.add(this.bShop),this.guiLayer.remove(this.scoreBar),this.guiLayer.remove(this.scoreLabel),Global.prototype.save(),this.speed=0,SG_Hooks.gameOver(1,Math.floor(this.score))},PlayState.prototype.resized=function(){this.skyBlur.y=this.scoreBar.y=this.crystalBack.y=_TrinGame.visibleArea.bottom,this.crystalLabel.y=this.scoreLabel.y=this.scoreBar.y-this.scoreBar.height/2+6,this.crystalBack.x=_TrinGame.offset.x+8,this.crystalLabel.x=this.crystalBack.x+56,this.bPause.y=_TrinGame.offset.y+8,this.scoreLabel.x=this.bPause.x=_TrinGame.width-_TrinGame.offset.x-8,this.pausePanel.y=_TrinGame.offset.y+this.pausePanel.height/2,this.pauseBHome.y=this.pausePanel.y+20,this.pauseBRestart.y=this.pauseBHome.y,this.pauseBPlay.y=this.pauseBHome.y,this.pausePanel.label.y=this.pausePanel.y-80,this.scoreBar.updateBounds(),this.crystalBack.updateBounds(),this.dangerLayer.callAll(function(){this.y=_TrinGame.offset.y})},PlayState.prototype.updateMissions=function(){for(var i=0;i<3;i++){var mission=Global.prototype.missions[i];this.missionsPanel.labels[i].text=mission.part1+mission.need+"("+Math.min(mission.have,mission.need)+")"+mission.part2,mission.have>=mission.need&&!mission.rewarded&&(this.missionsPanel.labels[i].color="#45F0FF",this.missionsPanel.rewards[i].visible=!1,mission.rewarded=!0,this.crystals+=mission.reward,(mission=new TrinSprite("Done")).orign.y=mission.height/2,mission.reset(366,this.missionsPanel.labels[i].y+10),this.missionsPanel.add(mission))}},PlayState.prototype.VIEW_STATE_TONNEL=0,PlayState.prototype.VIEW_STATE_TONNEL_ESCAPE=1,PlayState.prototype.VIEW_STATE_SKY_INTRO=2,PlayState.prototype.VIEW_STATE_SKY=3,PlayState.prototype.GAME_STATE_GAME=0,PlayState.prototype.GAME_STATE_PAUSE=1,PlayState.prototype.GAME_STATE_COMPLETE=2,PlayState.prototype.GAME_STATE_COMPLETE_MISSIONS=4,PlayState.prototype.GAME_STATE_COMPLETE_END=5,PlayState.prototype.GAME_STATE_SHOP=3,PlayState.prototype.GAME_STATE_WATCH_AD=6,PlayState.prototype.maxSpeed=20,PlayState.prototype.bufferZone=300,extend(SpaceShip,TrinSprite),SpaceShip.prototype.update=function(){SpaceShip.super.update.apply(this),this.looped&&(this.y-=this.speed*this.scale.x),0==this.boomTimer--&&(this.boomTimer=-1,this.switchAnimation("Ship1Boom"),this.orign.x=this.width/2,this.orign.y=32,this.looped=!1),(this.y<-this.height||this.isFinished()&&!this.looped)&&this.kill(),this.updateBounds()},SpaceShip.prototype.reset=function(){this.switchAnimation("Ship1"),this.orign.x=this.width/2,this.orign.y=0,SpaceShip.super.reset.apply(this,[80+Math.random()*(600-this.width),_TrinGame.visibleArea.bottom]),this.scale.x=this.scale.y=.25+.75*Math.random(),Math.random()<0&&(this.boomTimer=Math.floor((100+400*Math.random())*this.scale.x)),this.looped=!0},extend(Hero,TrinSprite),Hero.prototype.update=function(){switch(Hero.super.update.apply(this),0<this.invulnerabilityTimer?(this.invulnerabilityTimer--,this.invulnerabilityTimer%3==0&&(0===this.alpha?this.alpha=1:this.alpha=0)):this.alpha=1,this.shieldAmount<6e3&&(this.shieldAmount=Math.min(this.shieldAmount+Global.prototype.upgrades.shield,6e3)),6e3!==this.shieldAmount||this.shield?this.shieldEntity.looped||(this.shieldEntity.visible=!this.shieldEntity.isFinished()):(this.shield=!0,this.shieldEntity.visible=!0,this.shieldEntity.switchAnimation("Shield"),this.shieldEntity.looped=!0),_TrinGame.mouse.isPressed()?this.jumpActive=!0:_TrinGame.mouse.isReleased()&&(this.jumpActive=!1),this.state){case this.STATE_RUN:this.jumpActive&&_TrinGame.mouse.isDown()&&_TrinGame.mouse.y>_TrinGame.offset.y+150&&(this.dir*=-1,this.state=this.STATE_JUMP,TrinSound.prototype.play("jump"),this.switchAnimation("HeroJump"),Global.prototype.addToMission("Jump",1),this.orign.y=0,this.boundsOffset.top=0);break;case this.STATE_JUMP:this.x+=this.vspeed*this.dir,this.y=this.BASE_Y-(203-Math.abs(this.x+this.width/2-320))/2,this.dir===this.DIR_LEFT?this.x<=75&&(this.x=75,this.state=this.STATE_RUN,this.looped&&this.switchAnimation("HeroRunL"),this.y=this.BASE_Y):this.dir===this.DIR_RIGHT&&575<=this.x+this.width&&(this.x=575-this.width,this.state=this.STATE_RUN,this.looped&&this.switchAnimation("HeroRunR"),this.y=this.BASE_Y)}if(this.isFinished()&&!this.looped)switch(this.looped=!0,this.orign.y=0,this.boundsOffset.top=0,this.state){case this.STATE_JUMP:this.switchAnimation("HeroJump");break;case this.STATE_RUN:this.dir===this.DIR_LEFT?this.switchAnimation("HeroRunL"):this.switchAnimation("HeroRunR")}this.shieldEntity.reset(this.x,this.y),this.updateBounds()},Hero.prototype.atack=function(){this.dir===this.DIR_LEFT?this.switchAnimation("HeroAtackL"):this.switchAnimation("HeroAtackR"),this.boundsOffset.top=800,this.orign.y=800,this.currentFrame=this.animationProgress=0,this.looped=!1,_PLAY_STATE.speed*=.7,TrinSound.prototype.play("laser")},Hero.prototype.hurt=function(){var effect;!this.alive||0<this.invulnerabilityTimer||(this.shield?(this.shield=!1,this.shieldEntity.switchAnimation("ShieldBrake"),this.shieldEntity.looped=!1,this.shieldAmount=0,Global.prototype.addToMission("ShieldBreak",1),this.invulnerabilityTimer=60):(Global.prototype.topDistance=Math.max(_PLAY_STATE.meters+10,Global.prototype.topDistance),_PLAY_STATE.gameOver(),this.kill(),TrinSound.prototype.play("collision"),(effect=_PLAY_STATE.effectLayer.recycle(Effect)).alive||effect.revive(),effect.reset(this.x+this.width/2,this.y+this.height/2),effect.orign.y=100))},Hero.prototype.DIR_LEFT=-1,Hero.prototype.DIR_RIGHT=1,Hero.prototype.STATE_RUN=0,Hero.prototype.STATE_JUMP=1,Hero.prototype.BASE_Y=0,extend(Saw,TrinSprite),Saw.prototype.update=function(){this.y+=_PLAY_STATE.speed,this.bounds.intersectsRect(_HERO.bounds)&&_HERO.hurt(),null!==this.danger&&(this.y>_TrinGame.visibleArea.top?(this.danger.kill(),this.danger=null):.95<_TrinGame.perfomance?this.danger.scale.x=this.danger.scale.y=Math.max((Global.prototype.upgrades.warn-1)/10,Math.min(1,2*(1- -this.y/_PLAY_STATE.bufferZone))):this.danger.scale.x=this.danger.scale.y=1),1100<this.y&&this.kill(),Saw.super.update.apply(this)},Saw.prototype.reset=function(x,y){Saw.super.reset.apply(this,[x,y]),0<Global.prototype.upgrades.warn&&(this.danger=_PLAY_STATE.dangerLayer.recycle(TrinSprite),this.danger.alive?(this.danger.addAnimationFromCache("Danger"),this.danger.orign.x=this.danger.width/2,this.danger.animationSpeed=10):this.danger.revive(),this.danger.scale.x=this.danger.scale.y=0,(x=this.x)<160&&(x+=50),480<x&&(x-=50),this.danger.reset(x,_TrinGame.visibleArea.top+8))},extend(Pillar,TrinSprite),Pillar.prototype.update=function(){Pillar.super.update.apply(this),this.y+=_PLAY_STATE.speed,null!==this.label&&(this.label.y=this.y+4),1100<this.y&&this.kill(),this.updateBounds()},Pillar.prototype.reset=function(x,y,text){Pillar.super.reset.apply(this,[x,y]),this.visible=!0,void 0===text?(this.switchAnimation("Pillar2"),null!==this.label&&(this.label.text=""),_TrinGame.perfomance<=.95&&(this.visible=!1)):(this.switchAnimation("Pillar"),null!==this.label?this.label.text=text:null!==this.parent&&(this.label=this.parent.recycle(TrinText),this.label.alive||this.label.revive(),this.label.setStyle("font",24,!0,"#FFFFFF","center","top"),this.label.reset(320,this.y+4),this.label.text=text))},Global.prototype.topDistance=-1,Global.prototype.topScore=0,Global.prototype.crystals=0,Global.prototype.saveDataNamespace="sg_blackJump",Global.prototype.missionPanelCenteredY=500,Global.prototype.missionPanelOffCenterY=360,Global.prototype.upgrades={magnet:0,crystals:0,shield:0,warn:0,speed:0},Global.prototype.missions=[{part1:"Run ",part2:" meters in total",type:"Meter",oneRun:!1,need:150,prevStep:0,reward:10,have:0,rewarded:!1},{part1:"Get ",part2:" crystals in total",type:"Crystal",oneRun:!1,need:30,prevStep:0,reward:10,have:0,rewarded:!1},{part1:"Beat ",part2:" robots in total",type:"Robot",oneRun:!1,need:3,prevStep:0,reward:10,have:0,rewarded:!1},{part1:"Jump ",part2:" times in total",type:"Jump",oneRun:!1,need:50,prevStep:0,reward:50,have:0,rewarded:!1},{part1:"Break ",part2:" shields in total",type:"ShieldBreak",oneRun:!1,need:2,prevStep:0,reward:50,have:0,rewarded:!1},{part1:"Get ",part2:" crystals in one run",type:"Crystal",oneRun:!0,need:10,prevStep:0,reward:50,have:0,rewarded:!1},{part1:"Run ",part2:" meters in one run",type:"Meter",oneRun:!0,need:100,prevStep:0,reward:100,have:0,rewarded:!1},{part1:"Beat ",part2:" robots in one run",type:"Robot",oneRun:!0,need:2,prevStep:0,reward:100,have:0,rewarded:!1},{part1:"Jump ",part2:" times in one run",type:"Jump",oneRun:!0,need:150,prevStep:0,reward:150,have:0,rewarded:!1},{part1:"Break ",part2:" shields in one run",type:"ShieldBreak",oneRun:!0,need:2,prevStep:0,reward:200,have:0,rewarded:!1}],Global.prototype.addToMission=function(type,amount){for(var mission,i=0;i<3;i++)(mission=Global.prototype.missions[i]).type===type&&(mission.have+=amount)},Global.prototype.save=function(){var storage=new TrinStorage,json=JSON.stringify(Global.prototype.upgrades);storage.save("upgrades",json),json=JSON.stringify(Global.prototype.missions),storage.save("missions",json),storage.save("topDistance",Global.prototype.topDistance),storage.save("topScore",Global.prototype.topScore),storage.save("crystals",Global.prototype.crystals)},Global.prototype.load=function(){try{var storage=new TrinStorage,json=storage.load("upgrades"),obj=JSON.parse(json),m=(null!==obj&&(Global.prototype.upgrades=obj),json=storage.load("missions"),JSON.parse(json),Global.prototype.missions),val=(m[0].part1=_TrinGame.texts.total_run_1,m[0].part2=_TrinGame.texts.total_run_2,m[1].part1=_TrinGame.texts.total_crystals_1,m[1].part2=_TrinGame.texts.total_crystals_2,m[2].part1=_TrinGame.texts.total_beat_1,m[2].part2=_TrinGame.texts.total_beat_2,m[3].part1=_TrinGame.texts.total_jump_1,m[3].part2=_TrinGame.texts.total_jump_2,m[4].part1=_TrinGame.texts.total_shield_1,m[4].part2=_TrinGame.texts.total_shield_2,m[5].part1=_TrinGame.texts.run_crystals_1,m[5].part2=_TrinGame.texts.run_crystals_2,m[6].part1=_TrinGame.texts.run_run_1,m[6].part2=_TrinGame.texts.run_run_2,m[7].part1=_TrinGame.texts.run_beat_1,m[7].part2=_TrinGame.texts.run_beat_2,m[8].part1=_TrinGame.texts.run_jump_1,m[8].part2=_TrinGame.texts.run_jump_2,m[9].part1=_TrinGame.texts.run_shield_1,m[9].part2=_TrinGame.texts.run_shield_2,parseInt(storage.load("topDistance")));null===val||isNaN(val)||(Global.prototype.topDistance=parseInt(val)),null===(val=parseInt(storage.load("topScore")))||isNaN(val)||(Global.prototype.topScore=val),null===(val=parseInt(storage.load("crystals")))||isNaN(val)||(Global.prototype.crystals=val),Global.prototype.loadAudioStatus()}catch(e){}},Global.prototype.saveAudioStatus=function(){(new TrinStorage).save("audio",TrinSound.prototype.ENABLE_AUDIO?"1":"0")},Global.prototype.loadAudioStatus=function(){try{var storage=new TrinStorage,val=parseInt(storage.load("audio"));null===val||isNaN(val)||(TrinSound.prototype.ENABLE_AUDIO=0!==parseInt(val))}catch(e){TrinSound.prototype.ENABLE_AUDIO=!0}},Global.prototype.IS_IPHONE=!1,Global.prototype.IS_IPAD=!1,extend(TopDistanceMarker,TrinSprite),TopDistanceMarker.prototype.update=function(){TopDistanceMarker.super.update.apply(this),this.y+=_PLAY_STATE.speed,1100<this.y&&this.kill(),this.updateBounds()},extend(Atom,TrinSprite),Atom.prototype.update=function(){this.y+=_PLAY_STATE.speed,this.updateBounds();var d=Math.sqrt((this.y-_HERO.y)*(this.y-_HERO.y)+(this.x-_HERO.x-50)*(this.x-_HERO.x-50));d<this.maxD&&_HERO.alive&&(_HERO.x+50>this.x+this.upgrade?this.x+=this.upgrade*(1-d/this.maxD):_HERO.x+50<this.x-this.upgrade&&(this.x-=this.upgrade*(1-d/this.maxD)),_HERO.y>this.y+this.upgrade?this.y+=this.upgrade*(1-d/this.maxD):_HERO.y<this.y-this.upgrade&&(this.y-=this.upgrade*(1-d/this.maxD))),this.bounds.intersectsRect(_HERO.bounds)&&(this.kill(),TrinSound.prototype.play("coin"),_TrinGame.state.levelCrystals++,Global.prototype.addToMission("Crystal",1),(d=_PLAY_STATE.effectLayer.recycle(Effect)).alive||d.revive(),d.reset(this.x,this.y-30,"AtomEffect")),1100<this.y&&this.kill(),Atom.super.update.apply(this)},extend(Enemy,TrinSprite),Enemy.prototype.update=function(){switch(this.y+=_PLAY_STATE.speed,this.state){case this.STATE_WAIT:var h;this.bounds.intersectsRect(_HERO.bounds)&&(h=this.height,-1===this.dir?(this.switchAnimation("EnemyDieL"),this.orign.x=80):(this.switchAnimation("EnemyDieR"),this.orign.x=100),this.orign.y=this.height-h,this.state=this.STATE_DIE,Global.prototype.addToMission("Robot",1),_HERO.atack());break;case this.STATE_DIE:this.y+=32}1100<this.y&&this.kill(),Enemy.super.update.apply(this)},Enemy.prototype.reset=function(x,y){x<320?(x=70,this.dir=-1,this.switchAnimation("EnemyL")):(x=446,this.dir=1,this.switchAnimation("EnemyR")),this.orign.y=0,this.orign.x=0,this.alpha=1,this.state=this.STATE_WAIT,this.looped=!0,Enemy.super.reset.apply(this,[x,y])},Enemy.prototype.STATE_WAIT=0,Enemy.prototype.STATE_DIE=1,extend(Effect,TrinSprite),Effect.prototype.update=function(){this.y+=_PLAY_STATE.speed,(1100<this.y||this.isFinished())&&this.kill(),Effect.super.update.apply(this)},Effect.prototype.reset=function(x,y,name){Effect.super.reset.apply(this,[x,y]),this.switchAnimation(name=void 0===name?"KillEffect":name),this.orign.x=this.width/2,this.orign.y=this.height/2,this.play()},extend(MainMenuState,TrinState),MainMenuState.prototype.create=function(){MainMenuState.super.create.apply(this);var back=new TrinSprite("MenuBack"),back=(this.add(back),new TrinSprite("Logo")),back=(back.y=100,this.add(back),this.logo=back,1<window.navigator.maxTouchPoints&&(Global.prototype.IS_IPHONE||Global.prototype.IS_IPAD)&&window.addEventListener("touchstart",()=>{var btn=TrinSound.prototype.get("bttn"),btn=(btn.play(),btn.volume=0,TrinSound.prototype.get("MainTheme"));btn.play(),btn.volume=0}),new TrinButton(function(){TrinSound.prototype.setLoop("MainTheme",!0),TrinSound.prototype.play("MainTheme"),TrinSound.prototype.play("bttn"),TrinSound.prototype.ENABLE_AUDIO||TrinSound.prototype.muteAll(),_TrinGame.switchState(new PlayState)},"bPlay")),back=(back.orign.x=back.width/2,back.reset(320,460),this.add(back),this.bPlay=back,this.bPlay.visible=!1,this.lPlay=new TrinText(_TrinGame.texts.play),this.lPlay.setStyle("font",72,!0,"#000000","center","top"),this.lPlay.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.lPlay.reset(320,460),this.add(this.lPlay),new TrinButton(function(){SG_Hooks.triggerMoreGames()},"bMoreGames",!0)),back=(back.orign.x=back.width/2,back.reset(320,530),this.bMoreGames=back,this.bMoreGames.visible=!1,this.lMoreGames=new TrinText(_TrinGame.texts.more_games),this.lMoreGames.setStyle("font",72,!0,"#000000","center","top"),this.lMoreGames.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.lMoreGames.reset(320,530),new TrinButton(function(){var state=_TrinGame.state;state.credits.showed=!0,state.bCredits.active=state.bPlay.active=state.bMoreGames.active=!0},"bCredits"));back.orign.x=back.width/2,back.reset(320,680),this.add(back),this.bCredits=back,this.bCredits.visible=!1,this.lCredits=new TrinText(_TrinGame.texts.credits),this.lCredits.setStyle("font",72,!0,"#000000","center","top"),this.lCredits.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.lCredits.reset(320,680),this.credits=new TrinSprite("Credits"),this.credits.orign.x=this.credits.width/2,this.credits.orign.y=this.credits.height/2,this.credits.reset(320,1100),this.credits.showed=!1,this.credits.update=function(){TrinSprite.super.update.apply(this),this.showed?this.y=Math.max(480,this.y-(this.y-480)/8):this.y=Math.min(1100,this.y+(1100-this.y)/8),this.updateBounds()}},MainMenuState.prototype.update=function(){var canHide=this.credits.showed;MainMenuState.super.update.apply(this),canHide&&_TrinGame.mouse.isReleased()&&(this.credits.showed=!1,this.bCredits.active=this.bPlay.active=this.bMoreGames.active=!0),this.bPlay.isHovered()?this.lPlay.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive:this.lPlay.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.bMoreGames.isHovered()?this.lMoreGames.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive:this.lMoreGames.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.bCredits.isHovered()?this.lCredits.patternImage=TrinAnimation.prototype.IMAGES.TextMaskActive:this.lCredits.patternImage=TrinAnimation.prototype.IMAGES.TextMask,this.logo.y=Math.max(100,_TrinGame.visibleArea.top),this.logo.updateBounds()},extend(ShopButton,TrinGroup),ShopButton.prototype.update=function(){ShopButton.super.update.apply(this),0<this.maxTimer?(this.maxTimer--,this.maxTimer%5==0&&(this.max.visible=!this.max.visible)):6===this.level&&(this.max.visible=!0),this.button.bounds.intersects(_TrinGame.mouse.x-this.x+this.orign.x,_TrinGame.mouse.y-this.y+this.orign.y)?(1<this.button.currentAnimation.frames.length&&(this.button.currentFrame=1),_TrinGame.mouse.isReleased()&&(ShopButton.prototype.selectedButton!==this&&(ShopButton.prototype.selectedButton=this).outDescription(),2<this.button.currentAnimation.frames.length?this.button.currentFrame=2:this.button.currentFrame=0)):this.button.currentFrame=0,this.button.updateSize()},ShopButton.prototype.outDescription=function(){for(var desc,parts=["","","",""],spaceIndex=(0===this.level?(desc=this.desc1,_TrinGame.state.costLabel.text=this.costs[this.level]):this.level<6?(desc=this.desc2,_TrinGame.state.costLabel.text=this.costs[this.level]):(desc="Maxed out",_TrinGame.state.costLabel.text=""),15),n=0;14<desc.length;){for(var i=14;0<=i;i--)if(" "===desc[i]){spaceIndex=i;break}parts[n]=desc.substr(0,spaceIndex),desc=desc.substr(spaceIndex+1,desc.length-spaceIndex-1),n++}parts[n]=desc,_TrinGame.state.description1.text=parts[0],_TrinGame.state.description2.text=parts[1],_TrinGame.state.description3.text=parts[2],_TrinGame.state.description4.text=parts[3]},ShopButton.prototype.upgrade=function(){TrinSound.prototype.play("bttn");var b=ShopButton.prototype.selectedButton;6<=b.level?b.maxTimer=30:b.costs[b.level]>_TrinGame.state.crystals?_TrinGame.state.showRewardedDialog():(_TrinGame.state.crystals-=b.costs[b.level],b.parts[b.level].visible=!0,b.level++,b.func(b.level),6===b.level&&(b.max.visible=!0),b.outDescription())},ShopButton.prototype.selectedButton=null,extend(RotateState,TrinState),RotateState.prototype.create=function(){RotateState.super.create.apply(this),this.add(new TrinRectObject(0,0,640,960,"#000"));var s=new TrinSprite("Rotate");s.orign.x=s.width/2,s.orign.y=s.height/2,s.reset(320,480),this.add(s)};